Dynamic Deformation Using Adaptable, Linked Asynchronous FEM Regions

Umut Koc¸ak∗

Karljohan Lundin Palmerius†

Matthew Cooper‡

Norrk¨oping Visualization and Interaction Studio, Department of Science and Technology,

Linkoping University, SWEDEN

Abstract

In order to simulate both physically and visually realistic soft tis-
sue deformations, the Finite Element Method (FEM) is the most
popular choice in the literature. However it is non-trivial to model
complex behaviour of soft tissue with sufﬁcient refresh rates, es-
pecially for haptic force feedback which requires an update rate of
the order of 1 kHz. In this study the use of asynchronous regions is
proposed to speed up the solution of FEM equations in real-time. In
this way it is possible to solve the local neighborhood of the contact
with high refresh rates, while evaluating the more distant regions at
lower frequencies, saving computational power to model complex
behaviour within the contact area. Solution of the different regions
using different methods is also possible. To attain maximum efﬁ-
ciency the size of the regions can be changed, in real-time, in re-
sponse to the size of the deformation.

Keywords: Finite Element Method, surgery simulation, haptics

1 Introduction

The simulation of deformable soft tissues with physically realis-
tic force feedback in real time is still one of the big challenges in
the haptics area. The major challenge is the computational burden
to simulate realistic deformations which cannot be easily handled
using even today’s fastest computers. Therefore a compromise be-
tween realism and speed has to be achieved in the simulation of
soft tissue deformation. There are two general methods applied
in the simulations: mass-spring and ﬁnite element models. Suf-
ﬁcient refresh rates can be reached by using mass-spring models;
however the physical properties of materials cannot be taken into
account in these methods. Although studies reveal that it is pos-
sible to simulate physically realistic deformations by using Finite
Element Methods(FEM), the real-time requirement is not easy to
satisfy because of the complexity of this approach. Soft tissues
may also have various complex behaviours like visco-elasticity and
anisotropicity, in addition to non-linearity. If tissue cutting is also
to be simulated, the model should be updated both physically and
visually, which makes the real-time simulations even harder.

To reach a compromise between the necessity of high haptic re-
fresh rates and the computational burden, several optimization tech-
niques such as condensation, pre-computation, level of detail, and
exploitation of the sparse matrix structure have been introduced.

∗e-mail: umut.kocak@itn.liu.se
†e-mail:karljohan.palmerius@itn.liu.se
‡e-mail:matthew.cooper@itn.liu.se

Copyright © 2009 by the Association for Computing Machinery, Inc. 
Permission  to  make  digital  or  hard  copies  of  part  or  all  of  this  work  for  personal  or 
classroom  use  is  granted  without  fee  provided  that  copies  are  not  made  or  distributed 
for  commercial  advantage  and  that  copies  bear  this  notice  and  the  full  citation  on  the 
first page. Copyrights for components of this work owned by others than ACM must be 
honored. Abstracting with credit is permitted. To copy otherwise, to republish, to post on 
servers,  or  to  redistribute  to  lists,  requires  prior  specific  permission  and/or  a  fee. 
Request permissions from Permissions Dept, ACM Inc., fax +1 (212) 869-0481 or e-mail 
permissions@acm.org. 
SCCG 2009 Budmerice, Slovakia, April 23 – 25, 2009. 
© 2009 ACM 978-1-4503-0769-7/09/0004 $10.00 

197

Current simulators, however, still have to either sacriﬁce one prop-
erty of real tissues such as non-linearity, anisotropicity or visco-
elasticity, or apply force interpolation or extrapolation techniques
to reach a sufﬁcient haptic refresh rate (1 kHz). Therefore solution
of large FEM systems in real-time to be used in soft-tissue deforma-
tions is still a challenge for which new solutions are being sought.

In this study, a technique analogous to the application of level of
detail is proposed but using the time domain instead of the spatial
domain. This approach has been named asynchronous regions. The
nodes of the FEM model are separated into different regions, each
of which can be solved with different frequencies and by differ-
ent solution techniques and the size of which are adaptable in real-
time. The idea aims to compute in the local neigbourhood around
the contact node with a high frequency while calculating the more
remote nodes with lower frequencies. Since the local neigbourhood
around the contact is both visually and physically more signiﬁcant
than the more distant regions, more computation power can thus
be dedicated to either implementing non-linearity, visco-elasticity,
anisotropicity or increasing the resolution in the local neigbour-
hood. In order to study the effect of the use of the asynchronous re-
gions, our experiments are designed to solve the whole model with a
frequency of 1 kHz and compare the characteristics of the response
with those of the solution using asynchronous regions. Therefore a
one dimensional model is used so that it is possible to analytically
solve the model at 1 kHz with a sufﬁcient number of nodes in one
dimension to test various sizes of regions. The output force and the
modiﬁcation of the model are recorded by applying different input
signals to the model to illustrate the effects of asyncronous regions.

The outline of the paper is as follows: the second section summa-
rizes the previous work using FEM in soft tissue deformation. The
model and different solution methods are described in the third and
fourth sections respectively. The ﬁfth section introduces the asyn-
chronous and adaptable asynchronous regions. The results are pre-
sented in the sixth section and ﬁnally conclusions and future work
are discussed.

2 Related Work

There are several research groups working on the simulation of de-
formable objects. FEM is not the only method used for simulations
but it is considered to achieve the most physically realistic defor-
mations. In this section a range of studies are summarized, most of
which address the problem of haptic force feedback using FEM for
real-time applications.

Linear FEM is used in the studies [Frank et al. 2001; Mor and
Kanade 2000; Nienhuys and van der Stappen 2000; Lindblad and
Turkiyyah 2007; Sela et al. 2007; Wu and Heng 2005]. In [Sela
et al. 2007], FEM calculations are done ofﬂine during the prepro-
cessing step to evaluate constraints to simulate tissue cutting, then
the constraints for the nodes along the cutting path are moved and
the model is updated by using discontinuous discrete free form de-
formations during the simulation. In [Wu and Heng 2005] modiﬁ-
cation of the tissue cutting was permitted but to achieve this the pos-
sible operation area is restricted to a local region in the prepocessing
step. The others [Lindblad and Turkiyyah 2007; Mor and Kanade

2000; Nienhuys and van der Stappen 2000] also implemented tissue
cutting, however all of these studies use linear equations which are
not appropriate for soft tissues.

To achieve higher realism, non-linear and anisotropic tissues are
modeled in [Picinbono et al. 2003]. Since the calculations for non-
linear models take longer, the linear displacement equations are
solved for the whole model, and non-linear components are added
only for a local neighbourhood of the contact area. To simulate
larger deformations realistically, instead of just squeezing or poking
the model, non-linear equations for the strain are used in [Zhuang
and Canny 2000].

Pre-processing, which restricts the functionality of the simulation in
most cases, or an optimization method is needed for solving non-
linear systems. The idea of recording the response of the system for
all nodes to a unit input in pre-processing is implemeted in [Cotin
et al. 1999; Sedef et al. 2006]. [Sedef et al. 2006] exploited the idea
to model linear visco-elasticity. The same principle is used together
with local dynamic regions in a hybrid model to allow cutting the
soft tissue in [Delingette et al. 1999], which restricts the cutting re-
gion depending on speciﬁc surgery types in the pre-calculation step.
The hybrid model with a restricted operation region and adaptive
meshes are implemented in [Heng et al. 2004] and [Wu et al. 2001].
The common problem in these studies is the limitation of the pre-
processing making real-time updates either impossible or restricted
to a pre-speciﬁed local region. Extended FEM (XFEM), which al-
lows discontinuities in the model, is exploited to update the model
faster in case of tissue cutting in [Vigneron et al. 2004]. Other
optimizations like condensation[Bro-Nielsen and Cotin 1996], use
of graded meshes[Yan et al. 2007], force extrapolation[Picinbono
et al. 2000] and computation on the GPU[Wu and Heng 2005] are
proposed for solution of FEM equations.

Most of the studies above are lacking either one or more of non-
linearity, visco-elasticity, or real-time modiﬁcation features. Fur-
thermore none of them has achieved a sufﬁcient haptic refresh rate
(1 kHz). Therefore a different technique has to be applied in the
ﬁeld to meet the requirements. The idea of updating different re-
gions of a model with different frequencies is mentioned in [Cavu-
soglu and Tendick 2000] for spring models and in [Astley and Hay-
ward 1998; Debunne et al. 2001] for FEM. However none of these
FEM studies compare the response of local regions with the whole
solution or discuss the implementation details. The aim of this
study is to make a comprehensive discussion and prove the con-
cept of asynchronous regions, allowing the evaluation of a realistic
force at 1 kHz, as an alternative optimization technique in FEM
based applications. Therefore visco-elasticity and non-linearity has
not been considered yet. However, application of the asynchronous
regions depends on the same principles presented throughout this
paper, for the case of non-linear and visco-elastic models.

3 Model

A linear FEM model is created by using the basic principles of ﬁnite
elements[Zienkiewicz et al. 2005]. Material properties like elastic-
ity of modulus, damping and mass can be set as well as geometric
properties for each element individually. The element stiffness ma-
trix is computed by evaulating integral (1) over the volumetric re-
gion Ω. B describes the element geometry and D is a material ma-
trix which depends on the elasticity of modulus and poisson ratio.
After the computation of the element stiffness matrices, the global
stiffness matrix for the whole model is formed( See [Zienkiewicz
et al. 2005] for further details ). To keep the model stationary in
the scene, boundary conditions are deﬁned at least for one node.
Before the simulation starts, the stiffness matrix is condensed such

that it does not contain any entries for the boundary condition nodes
while preserving their effect.

K =

BTDB dΩ

(1)

(cid:90)

Ω

In the case of dynamic equations, the distributed mass is approxi-
mated with concentrated masses by diagonalizing the mass matrix
which results in better performance. By using a diagonal mass and
damping matrix it is possible to solve the system as independent
linear equations in the case of explicit dynamic solution systems.

After the calculation of the material properties, the boundary condi-
tioned nodes are constrained to stay constant. A collision algorithm
is used to choose the closest node of the model to the haptic probe’s
position as a contact node when the probe is within a reasonable
neighborhood of the model speciﬁed by a threshold value. A force
input is applied to the contact node by using a spring model between
the haptic probe and the current position of the contact node. The
stiffness constant of this spring model should be chosen to reach a
compromise between steady state and transient response errors as
discussed in [Barbagli et al. 2003]. A much greater constant than
the stiffness of the deformable model results in oscillations in force,
while a much lower one causes high steady state errors resulting in
a large position difference between the haptic probe and the con-
tact node. The output force of this spring model is then applied as
input to the FEM model to calculate the new displacements of the
nodes including the contact node. At the end of the haptic frame
the force sent back to the haptic device is calculated by the spring
model using the updated position of the contact node.

4 FEM Solver

Different solvers including explicit dynamic, semi-implicit dy-
namic and static solvers have been implemented to solve the FEM
equations. However to achieve realistic deformation behaviour,
only dynamic solvers are used in the simulation. The general for-
mula for dynamic solutions is;

M ¨u + C ˙u + Ku = f

(2)

in which the stiffness matrix, displacements, forces, mass and
damping are represented by K, u, f, M and C respectively while
˙u and ¨u refer to velocity and acceleration.

The simulation time is discretized into time-steps to evaluate nu-
merical integration of the solution and the unknowns are solved
at each time step. There are two general ways of solving the dis-
cretized system: Implicit and Explicit methods.

In implicit methods the unknown values at time (t+1) are used to
evaluate the values at time (t+1). To solve the equations either a
linear system of equations has to be solved or a sparse matrix inver-
sion has to be used. Therefore, if the stiffness matrix changes (for
example in non-linear systems or in tissue cutting) it is not possible
to achieve realistic interactive rates with implicit methods. How-
ever these methods are unconditionally stable such that the conver-
gence is guaranteed even for large timesteps(∆t). A semi-implicit
method is implemented in this study by using the formula,

ˆKu(t + ∆t) = ˆf(t)

(3)

where,

198

ˆK =

ˆf(t) =

+ K

M
C
∆t2 +
2∆t
2M
∆t2 u(t) + (

C
2∆t

−

M
∆t2 )u(t − ∆t) + f(t)

The ˆK and ˆf need to be updated in each frame since ∆t is not con-
stant between two frames, then (3) is solved by either Gaussian
Elimination or Conjugate Gradient method.

In explicit solutions the known values at time t are used to calculate
the values at time t + 1. Unlike the implicit methods the differ-
ential equations can be written independently if lumped mass and
damping is used. Therefore explicit methods are not only faster but
also make it easier to make changes in the stiffness matrix in real
time. Nevertheless explicit methods are only conditionally stable
such that the time step (∆t) used in the calculations must be less
than a critical time(∆tcritical). ∆tcritical is often formulized as:

Figure 1: The asynchronous regions in 3D updated in real-time.

∆tcritical ≈ l

(cid:114) ρ
E

5 Asynchronous Regions

(4)

E, l and ρ represent elasticity, minimum ﬁnite element length in
the model, and mass density respectively in (4). Experiments show,
however, that the damping coefﬁcient also has an effect on ∆tcritical
as discussed in [Delingette et al. 1999]. Because of the restriction
on the time step, explicit methods can only be used for soft tissues.
The need to have smaller time-steps also results in larger relaxation
and convergence times. In this study two different explicit meth-
ods are used. The ﬁrst is a ﬁnite difference Euler method with the
equation (5) where m and c refer to mass and damping respectively.

u(t + ∆t) = u(t) +

(u(t) − u(t − ∆t))

2 − c∆t
2 + c∆t
2∆t2

−

m(2 + c∆t)

(Ku(t) − f(t))

(5)

The second method (6) is a combination of an implicit and explicit
Euler method which is;

u(t + ∆t) = u(t) + ∆t ˙u(t + ∆t)
˙u(t + ∆t) = ˙u(t) + ∆t ¨u(t)

¨u(t) =

f(t) − cm ˙u(t) − Ku(t)

m

(6)

The use of asynchronous regions allows choosing different solvers
described above for different regions. While solving the equations
for the current active region, the values of the nodes in other regions
are used without knowing the solver type of those regions. The
solvers for different regions are chosen before the simulation starts.
The only restriction is the instability condition, explained above, for
explicit solvers. To be able to use sufﬁcient resolution and meet the
stability requirement (4), the refresh rates for the explicit solvers
have to be kept high. Therefore for the regions with low refresh
rates, the semi-implicit solver (3) should be chosen while the ex-
plicit solvers can be chosen for the regions with higher frequencies.
A detailed disscussion on the comparison of the implicit and ex-
plicit methods is presented in [Bro-Nielsen and Cotin 1996].

The biggest challenge of using FEM in tissue deformation is the
computational burden since sufﬁcient resolution to model the tissue
results in large numbers of equations that must be solved in real-
time. In the case of surgery simulations, in which cutting the soft
tissue is simulated, fulﬁlling both realism and refresh rate require-
ments becomes particularly problematic for these complex models.
Therefore aynchronous regions are proposed in this study to opti-
mize the solution of the FEM equations in real time while preserv-
ing the physical response of the modelled system.

5.1 Regions

The asynchronous regions are the separate parts of the model where
the corresponding FEM equations are solved with different refresh
rates. To create the regions, the FEM solution is divided into differ-
ent groups each of which is then solved with different frequencies.
This feature is exploited by solving the displacements of the nodes
in the local neighbourhood of the contact node (called the primary
region) with a high frequency and the other regions (the secondary
regions) with lower frequency. It is also possible to choose differ-
ent solution methods for each region from the ones described in the
previous section, which allows the use of explicit dynamic methods,
which are suitable only for soft tissues because of their instability,
for soft tissue while other methods are used for hard tissues.

The boundaries for an asynchronous region are kept in a vec-
tor of a border structure which keeps the beginning and end-
ing node indices of a subset of the region. This is illustrated
in ﬁgure 2 in 1D and 2D. The red nodes represent the primary
region which is solved with 1 kHz, while the green and blue
nodes refer to secondary regions which are solved with 100 Hz
and 10 Hz respectively for this instance.
The node indices
for the members of borders vector for the green region are il-
lustrated in ﬁgure 2(b). The green region is represented by a
vector of borders;{(42,48),(54,55),(59,60),(67,68),(72,73),(80,81),
(85,86),(93,99)}. The same approach is used for 3 dimensional
case to create the regions’ border vectors. The connection nodes
between two different regions cause the regions to be affected by
each other enabling the deformation behaviour to traverse through-
out the model even though the regions are updated with different
frequencies.

At the beginning of the simulation the number of asynchronous re-

199

(a) 1 dimension

(b) 2 dimensions

Figure 2: The allocation of asynchronous regions on the model.

gions and the size and refresh rate of each are set to default values.
In the event of a contact the boundaries for the asynchronous re-
gions are set depending on the contact node and the sizes of the
regions, and they are updated only when the contact node changes
or the region sizes are adapted in response to the changing contact,
as explained in subsection 5.5. Figure 1 shows a screen dump from
the simulation when the asynchronous regions are rendered with
different colors.

5.2 Solving Equations

At the beginning of each haptic loop the current region is chosen
depending on the refresh rate parameters. After the current region
is chosen, the input in that frame is applied to the model and only
the displacements of the nodes in the current region are solved.

In the case of static or semi-implicit methods, in which writing the
FEM equations independently is not possible, the FEM equations
need to be reorganized before solving the system for the current
region. For all rows corresponding to the nodes in the active re-
gion, the displacements of the nodes in the other regions are multi-
plied with corresponding matrix coefﬁcients, and the sum of these
multiplications are subtracted from the force value for that row as
formulized below;

fimodi f ied = fi − ∑
j(cid:54)∈Ra

Ki ju j, ∀i ∈ Ra

(7)

where Ra refers to the active region which is being solved in the
current frame.

The allocation of the asynchronous regions in the stiffness matrix
is illustrated in ﬁgure 3 by using the same colors in ﬁgure 2. The
non-zero values are shown by dashed lines and the jth indices in
(7) refer to the white spaces for each row. Since the stiffness ma-
trix has a banded structure, which is exploited in the evaluation of
(7), the nodes in a region are affected only by the displacement of
the connection nodes (shown in ﬁgure 2(a) for 1D) of the neigbour-
ing regions. It can be observed that the active regions have some

Figure 3: The asynchronous regions in the solution matrix.

Figure 4: The use of interpolated values for the low frequency re-
gions

non-zero values in the columns corresponding to the connection
nodes of their neighbour regions in the rows corresponding to their
own connection nodes. After the application of (7) to preserve a
relationship between connection nodes, a copy of the stiffness ma-
trix containing only the entries of the active region is created to be
solved in the regular way.

For explicit dynamic simulations the independent equations are
solved only for the nodes in the current region without the need
to embed the effect of the connection nodes to the other side. After
the system is solved the displacements are updated locally and the
output force on the contact node is evaluated.

5.3

Interpolation

Should the refresh rates for the secondary regions be too low, these
regions behave like a moving wall such that when the nodes in the
primary region are evaluated the nodes of the secondary regions
stay constant. Then when the nodes in the secondary regions are
solved the nodes will have a sudden jump in displacement values
since the displacements of the primary region nodes have been eval-
uated many times and may have very large displacement changes
between the time step of the secondary regions in case of contin-
uous input. This ‘moving wall’ effect will cause discontinuity in
both haptic and graphic rendering and will also become more obvi-
ous when the difference between the frequency of the primary and
secondary regions increases. To avoid this problem, interpolated
values of the displacements for the nodes of secondary regions are
used in both independent explicit equations and (7) which is for the
semi-implicit and static cases. Figure 4 demonstrates the effect of
interpolation in an extreme case in which there is a large difference
between the frequencies of the two regions.

The dark red nodes represent the primary region with a frequency
of 1 kHz and the light green ones represent the secondary region

200

with 100 Hz frequency. After an input is applied, the nodes of the
secondary region will not move until the end of the secondary re-
gion’s time step. When the displacements of the secondary region
are updated at t2, there will be a force jump because of the sud-
den change in the displacements of the secondary region nodes. To
achieve continuity, instead of the evaluated displacements of the
secondary region being updated with 100 Hz, interpolated values
between the time steps are used in the solution of the equations. A
sudden force jump occurs at time t2 if the displacements evaluated
at time t1 are used instead of the interpolated displacements(dashed
lines in ﬁgure 4) for the secondary region’s nodes. Since two val-
ues have to be known for interpolation but the displacements for the
next time step are not known, interpolation is applied by using the
values from the previous time step. For instance, between t1 and t2
the interpolation algorithm uses the displacements of the secondary
region evaluated at t0 and at t1. However this issue results in a delay
effect which grows according to the frequency difference between
the secondary and primary regions. This issue, however, does not
prevent the use of asynchronous regions but does constrain the fre-
quency of the secondary regions to be above a certain value.

5.4 Analysis

When an input is applied, the effect of the input on the displace-
ments propagates through the model from the contact node. The
model behaves like a low pass ﬁlter on the applied input signal
such that if the frequency of the input is high and the frequency
of the secondary regions is low, the propogation effect of the dis-
placements diminishes before the nodes of the secondary regions
are evaluated. Therefore the changes in the displacements of the
nodes in the lower frequency regions become insigniﬁcant and the
artiﬁcial extra force feedback grows larger for high frequency in-
puts. This defect depends mainly on how much lower the fre-
quency of the secondary regions is compared with the frequency
of the applied input, together with the size of the primary region.
Fortunately real applications like surgery simulation provide an up-
per frequency limit which a human being can apply to a soft tissue
[Fischer et al. 1990]. This limit can be used to determine acceptable
frequency rates for the secondary regions.

5.5 Adaptable Regions

While the effect of the input propagates through the whole model,
the number of nodes affected and the magnitude of the effect de-
pend on the size of deformation. To achieve the best performance
the size of the primary aynchronous region, the equations of which
are evaluated with the highest frequency, should not be larger than
absolutely necessary. The optimum size of the region is the mini-
mum which will not make a signiﬁcant difference to the feedback
force, and depends on the size of the deformation, the stiffness of
the tissue and the frequency of the secondary region.

To increase the efﬁciency, the asyncronous regions are implemented
such that their sizes can be varied using a function during the sim-
ulation. The function evaluates the size of the primary region by
using the size of the current deformation. Different functions can
be used depending on the properties of the tissue. The use of a
linear function, the slope of which can be adjusted depending on
the stiffness properties of the tissue is illustrated in ﬁgure 5 for 1D.
During the simulation, the deformation size(ld) is scaled with the
gradient(S) of the function. The adapted number of nodes of the pri-
mary region is calculated as the corresponding value to this scaled
length(in meters) in the undeformed state. This adapted primary
region size, which changes dynamically in real-time, is bounded

Figure 5: The use of linear function for the evaluation of adapted
region size. The deformation size(ld) is scaled with the gradient(S)
of the function to be used in undeformed state.

below and above by minimum and maximum node numbers speci-
ﬁed depending on the properties of the tissue and the total number
of nodes.

In the simulation only a linear function is used, however other al-
ternatives are possible. A non-linear function could also be con-
sidered for soft tissues which tend to have a saturated deformation
when the size of the deformation grows larger. Another possible
way to change the size of the primary region is to use a thresh-
old for the displacement of the nodes such that the nodes with a
displacement larger than the threshold are included in the primary
region. The function is therefore used to relate between deforma-
tion size and the size of the region can be adjusted experimentally
for tissues with different properties. The following section includes
the experiments showing the effect of the adaptable regions with
linear functions, while the effect of the various functions are to be
examined in future studies.

6 Results

Experiments have been carried out to explore the different be-
haviours of the asynchronous regions for changing force input app-
plied to different types of tissues. A one dimensional model is used
to permit a number of nodes which can be solved analytically at
1 kHz and allow a wide range of different region sizes. To be able to
observe the output response objectively, a force signal is applied to
the model by using a simulated haptic device, the position of which
is not affected by the reaction force. The position of the haptic
probe and output force are recorded and illustrated by thick red and
thin blue lines, respectively, in the ﬁgures presented throughout this
section. Since there is almost no response difference when the fre-
quency of the secondary regions is not extremely low, the results of
the experiments using implicit dynamic solvers are presented to em-
phasize the output difference for extremely low frequencies which
are out of the range of explicit dynamic solvers. Direct Gaussian
Elimination is used in the implicit solvers to obtain the exact result.

The parameters of the model are set to values within the range of
soft tissue properties. The studies [Egorov et al. 2008; Li et al.
2006; Yu et al. 2006; Sinkus et al. 2000] on the elastic properties
of soft tissue reveal that soft tissue shows complex visco-elastic and
non-linear characteristics. The elasticity values measured in the dif-
ferent studies are: between 5 and 35 kPa in [Egorov et al. 2008], 6
and 11 kPa in [Li et al. 2006], 0 and 3.5 kPa in [Sinkus et al. 2000]
and 9.3 kPa in [Yu et al. 2006]. The difference in the mentioned
studies is related to tissue type, the magnitude of deformation, the
non-linear behaviour of the elasticity and the level of precompres-
sion as discussed in [Samani et al. 2003]. The experiments pre-
sented in the results section of this paper have been carried out for
different elasticity values between 5 kPa and 25 kPa. The area and

201

Average Solution Time(ms)

Speed Gain(%)

Peak Force(N)

Force Error(%)

Whole Sol.

Asynch.
Regions

N
40
30
30
5
5

f
-

500
50
500
50

0.175
0.123
0.094
0.059
0.017

-

29.7
46.3
66.3
90.3

1.65
1.66
1.76
1.70
2.86

-
0.5
6.6
2.7
73

Table 1: The performance and force error comparison of the asyn-
chronous regions with the whole analytical solution. N is the num-
ber of nodes solved at 1 kHz, f is the frequency of the secondary
regions.

7(d)) are compared to the whole model solutions(ﬁgures 7(a) and
7(b)), one can state that the softer the tissue is, the larger the differ-
ence between the output forces of the asynchronous regions and the
whole model. Therefore no optimized values have yet been found
for the size of the primary region and the frequency of the sec-
ondary regions since the force output and speed depend on tissue
properties and the computation power respectively. However the
adaptibility feature is added to the asynchronous regions allowing
changing primary region size depending on the size of the defor-
mation in real-time. The ultimate aim in the future studies is to
integrate a real-time adaptation scheme for the primary region size
independent of material properties like elasticity.

Peak Force(N)

Force Error(%)

Whole Sol.
Adaptible a.r

Non-Adaptible a.r

24.96
25.93
31.07

-
3.9
24.5

Table 2: The performance and force error comparison of the
adaptible and non-adaptible asynchronous regions with the whole
analytical solution.The Peak Force is the value of the force at ap-
proximately 30th second of the graphs in ﬁgure 8.

In the second set of experiments, the behaviour of the adaptable
primary region size is examined by changing the size depending on
the deformation length in real-time. A force input with constant
frequency and increasing magnitude(max 5 cm.) is applied to the
model. Figure 8(a) illustrates the difference between the solution
of the whole model with 1 kHz and solution of non-adaptable and
adaptable asynchronous regions with a primary region size of 10
and secondary region frequency of 50 Hz. A linear function with a
gradient of 4 is used for the adaptable region in ﬁgure 8(b) which
means the ratio of the length of the primary region to the deforma-
tion length is 4. However in order not to solve the whole model
with the highest frequency, there should be a limit for the maxi-
mum size of the primary region which is 30 nodes in this case. The
parameters are chosen empirically to show only the beneﬁt of using
adaptible regions over non-adaptible regions and have not been op-
timized yet. The force error difference between adaptible and non-
adaptible regions can be examined from table 2, while from ﬁgure 8
it can also be observed that the force error increases with increasing
deformation size proving the necessity to consider the deformation
size while adapting the size of the primary region. The maximum
size of the primary region is, of course, ultimately constrained by
the available computational power.

7 Conclusions and Future Work

In this study, in order to attain sufﬁcient refresh rates for the so-
lution of FEM equations in real-time surgery simulations, asyn-
chronous regions are proposed. The FEM equations are separated
into different groups, the equations of each are solved with differ-
ent frequencies. In the event of deformation it is then possible to
update the displacements of the nodes in the local neighbourhood
of the contact point at sufﬁcient frequency to provide a realistic

(a) N=30, f = 50

(b) N=30, f = 500

(c) N=5, f = 50

(d) N=5, f = 500

Figure 6: The asyncronous solutions of the model with elasticity
value of 5 kPa. N is the number of nodes in the primary region and
f is the frequency of the secondary region in sub-ﬁgures.

length of the model are set to 40 cm2 and 10 cm respectively to
keep the stiffness of the one dimensional linear model in the realis-
tic stiffness range[Li et al. 2006] for soft tissues. The mass density
is set to 1 gr/cm3 for soft tissue as described in [Johns and Yaffe
1987]. To achieve stability in the system, a damping value of 6.5
has been found to be optimal with these tissue properties. The total
number of values is set to 40 for the model.

In the ﬁrst type of experiment a chirp function, which is a sinusoid
with constant magnitude and varying frequency, is applied to the
model by increasing the frequency linearly. The magnitude of the
deformation is kept as 1 cm and the frequency is increased from
0.1 to 1 Hz. The responses of the model are compared by changing
the size of the primary region and the frequency of the secondary
region.

When ﬁgure 6(c) is compared to 6(a) and 6(d), it is possible to
state that the output force increases slightly with the increasing in-
put frequency in 6(c) when both the primary region’s(N) size and
the secondary regions’ frequency(f) have lower values while there
is no signiﬁcant force increase in 6(a) and 6(d) when either one of
N or f has higher values.

To compare the results of asynchronous regions(ﬁgure 6) with the
whole solution with 1 kHz(ﬁgure 7(a)) on the model with elasticity
value of 5 kPa , the peak values of the forces at approximately 20th
second in the graphs are presented together with the solution times
in table 1. The force error and speed gain increase with the decreas-
ing primary region size and secondary regions’ frequency seper-
ately. However when the (N=30,f=50) and (N=5,f=500) entries are
compared, it is observed that the primary region’s size has a more
signiﬁcant effect than the secondary regions’ frequency. To exploit
the speed gain of asynchronous regions the force error should be
within acceptable limits throughout the simulation.

To achieve a compromise between the accuracy of the force output
and speed, the size and the frequency of the regions should be ad-
justed properly keeping the force error within acceptable limits. If
the results of the asynchronous regions with smallest primary re-
gion size and lowest secondary region frequency (ﬁgures 7(c)and

202

(a) E = 5 kPa

(b) E = 25k Pa

(a) Whole solution

(c) E = 5 kPa

(d) E = 25 kPa

Figure 7: The solution of the whole model with 1 kHz(7(a),7(b))
and the solution by asynchronous regions with a primary region
size of 5 nodes and 5 Hz frequency of secondary regions(7(c),7(d).

simulation, while updating the more remote regions with a lower
frequency. The computational power saved by solving the more
distant regions at lower frequencies can then be dedicated to mod-
elling the complex behaviours of soft tissue in the local region, like
visco-elasticity, anisotropicity and non-linearity.

Static, implicit dynamic and explicit dynamic solution methods
have been implemented to solve the FEM equations. Although
the explicit dynamic solvers provide better performance and per-
mit easier updating of the model, for example in the case of tissue
cutting, these solvers are only conditionally stable such that a high
refresh rate is needed for the solutions to converge. By using asyn-
chronous regions it is possible to solve different regions not only at
different frequencies but also to apply different solution methods.
To simulate the tissue cutting it is possible to exploit this feature
of the asynchronous regions by solving the local neighborhood of
the contact by explicit dynamic solvers with high refresh rates and
the other regions using unconditionally stable solvers with lower
frequencies.

The behaviour of the asynchronous regions has been tested through
comparison with an analytically solved simulation in a one dimen-
sional linear model by applying different input signals to different
tissue types. From the results of the experiments, one can state that
when the size of the primary region decreases and the refresh rate
of the secondary regions is reduced, the difference between the out-
put forces of asynchronous regions and the whole model increases,
while increasing the primary region size and secondary regions’ fre-
quency results in a smaller force difference as expected. However
to preserve a 1 kHz haptic refresh rate, with an acceptable output
force error, the primary region size and secondary regions’ frequen-
cies should not be more than necessary. Therefore to exploit the
method of asynchronous regions without having a signiﬁcant er-
ror in the force, the size of the primary region and the frequency of
the secondary region should be optimized which will be explored in
the future studies. The performance measurements have also shown
that it is possible to achieve signiﬁcant improvement in the calcula-
tion speed while keeping the force error in acceptable ranges.

To obtain maximum efﬁciency adaptable asynchronous regions are

(b) Adaptable region

(c) Non-adaptable region

Figure 8: Solution of the whole method with 1 kHz, non-adaptable
asynchronous regions, and adaptable regions.

described, the size of which can be varied in real-time depending
on the deformation applied. The size of the primary region is re-
lated to the deformation by using a linear function and it is limited
to a maximum value. To achieve best performance the gradient of
the linear function and the maximum limit can be adjusted depend-
ing on the complexity of the model and the available computation
power. It is observed that adaptable regions provide better results
than non-adaptable regions especially for high magnitude inputs.

As a future study, the relationship between the function used to
adapt the size of the regions and tissue properties can be exam-
ined to obtain material property independent function. Evaluation
of asynchronous regions, integration of level of detail in the spatial
domain, and non-linearity are also points to be explored.

Acknowledgements

This work has been funded by the Swedish Science Council through
grant number 621-2005-3609 and by the Foundation for Strategic
Research (SSF) under the Strategic Research Center MOVIII.

References

ASTLEY, O., AND HAYWARD, V. 1998. Multirate haptic simula-
tion achieved by coupling ﬁnite element meshes through norton
In Robotics and Automation, 1998. Proceedings.
equivalents.
1998 IEEE International Conference, 989–994 vol.2.

BARBAGLI, F., SALISBURY, K., AND PRATTICHIZZO, D. 2003.
Dynamic local models for stable multi-contact haptic interaction
with deformable objects. In Haptic Interfaces for Virtual Envi-
ronment and Teleoperator Systems, 2003. HAPTICS 2003. Pro-
ceedings. 11th Symposium, 109–116.

203

BATHE, K.-J. 1982. Finite Element Procedures in Engineering

Analysis. Prentice Hall.

BRO-NIELSEN, M., AND COTIN, S. 1996. Real-time volumetric
deformable models for surgery simulation using ﬁnite elemets
and condensation. In Computer Graphics Forum, 57–66.

CAVUSOGLU, M., AND TENDICK, F. 2000. Multirate simula-
tion for high ﬁdelity haptic interaction with deformable objects
in virtual environments. In Robotics and Automation, 2000. Pro-
ceedings. 2000 IEEE International Conference, 2458–2465.

COTIN, S., DELINGETTE, H., AND AYACHE, N. 1999. Real-time
elastic deformations of soft tissues for surgery simulation. IEEE
Transactions on Visualization and Computer Graphics, 62–73.

DEBUNNE, G., DESBRUN, M., CANI, M., AND BARR, A. 2001.
Dynamic real-time deformations using space & time adaptive
sampling. In SIGGRAPH ’01: Proceedings of the 28th annual
conference on Computer graphics and interactive techniques,
31–36.

DELINGETTE, H., COTIN, S., AND AYACHE, N. 1999. A hy-
brid elastic model allowing real-time cutting, deformations and
force-feedback for surgery training and simulation. In CA ’99:
Proceedings of the Computer Animation.

EGOROV, V., TSYURYUPA, S., KANILO, S., KOGIT, M., AND
A SARVAZYAN. 2008. Soft tissue elastometer. Medical Engi-
neering and Physics, 206–212.

FISCHER, P., DANIEL, R., AND SIVA, K. 1990. Speciﬁcation and
design of input devices for teleoperation. Robotics and Automa-
tion, 1990. Proceedings., 1990 IEEE International Conference
on, 540–545 vol.1.

FRANK, A. O., TWOMBLY, I. A., BARTH, T. J., AND SMITH,
J. D. 2001. Finite element methods for real-time haptic feedback
In VR ’01:
of soft-tissue models in virtual reality simulators.
Proceedings of the Virtual Reality 2001 Conference (VR’01),
257–263.

GOSLINE, A. H., SALCUDEAN, S. E., AND YAN, J. 2004. Haptic
simulation of linear elastic media with ﬂuid inclusions, haptics-
e: Electronic. Journal of Haptics Research 3.

MAUREL, W., WU, Y., THALMANN, N. M., AND THALMANN,
D. 1998. Biomechanical Models for Soft Tissue Simulation.
Springer-Verlag.

MOR, A. B., AND KANADE, T. 2000. Modifying soft tissue mod-
els: Progressive cutting with minimal new element creation. In
In MICCAI, 598–608.

NIENHUYS, H.-W., AND VAN DER STAPPEN, A. F. 2000. A
Surgery Simulation Supporting Cuts and Finite Element Defor-
mation. Springer Berlin / Heidelberg, 145–152.

PICINBONO, G., LOMBARDO, J. C., DELINGETTE, H., AND AY-
ACHE, N. 2000. Anisotropic elasticity and force extrapolation to
improve realism of surgery simulation. In n IEEE International
Conference on Robotics and Automotion: ICRA 2000, 596–602.

PICINBONO, G., DELINGETTE, H., AND AYACHE, N.

2003.
Non-linear anisotropic elasticity for real-time surgery simula-
tion. Graph. Models, 305–321.

SAMANI, A., BISHOP, J., LUGINBUHL, C., AND PLEWES, D. B.
2003. Measuring the elastic modulus of ex vivo small tissue
samples. Physics in Medicine Biology, 2183–2198.

SEDEF, M., SAMUR, E., AND BASDOGAN, C. 2006. Real-time
ﬁnite-element simulation of linear viscoelastic tissue behavior
based on experimental data. IEEE Computer Graphics and Ap-
plications, 58–68.

SELA, G., SUBAG, J., LINDBLAD, A., ALBOCHER, D., SCHEIN,
S., AND ELBER, G. 2007. Real-time haptic incision simulation
using fem-based discontinuous free-form deformation. Comput.
Aided Des., 685–693.

SINKUS, R., LORENZEN, J., SCHRADER, D., LORENZEN, M.,
DARGATZ, M., AND HOLZ, D. 2000. High-resolution tensor mr
elastography for breast tumour detection. Physics in Medicine
Biology, 1649–1664.

VIGNERON, L. M., VERLY, J. G., AND WARFIELD, S. K. 2004.
Modelling Surgical Cuts, Retractions, and Resections Via Ex-
tended Finite Element Method. Springer Berlin / Heidelberg,
311–318.

WU, W., AND HENG, P. A. 2005. An improved scheme of inter-
active ﬁnite element model for 3d soft tissue cutting and defor-
mation. The Visual Computer, 707–716.

HENG, P.-A., CHENG, C.-Y., WONG, T.-T., XU, Y., CHUI, Y.-
P., CHAN, K.-M., AND TSO, S.-K. 2004. A virtual-reality
IEEE Transac-
training system for knee arthroscopic surgery.
tions on Information Technology in Biomedicine, 217–227.

WU, X., DOWNES, M. S., GOKTEKIN, T., AND TENDICK, F.
2001. Adaptive nonlinear ﬁnite elements for deformable body
In Computer
simulation using dynamic progressive meshes.
Graphics Forum, 349–358.

JE ˇR ´ABKOV ´A, L., KUHLEN, T., WOLTER, T. P., AND PALLUA, N.
2004. A voxel based multiresolution technique for soft tissue
deformation. In VRST ’04: Proceedings of the ACM symposium
on Virtual reality software and technology, 158–161.

JOHNS, P. C., AND YAFFE, M. J. 1987. X-ray characterisation
of normal and neoplastic breast tissues. Physics in Medicine
Biology, 675–695.

LI, X., WANG, G., HUANG, L., AND ZHANG, G. 2006. Young’s
modulus extraction methods for soft tissue from ultrasound mea-
surement system. Instrumentation Science and Technology, 393–
404.

LINDBLAD, A., AND TURKIYYAH, G. 2007. A physically-based
framework for real-time haptic cutting and interaction with 3d
continuum models. In SPM ’07: Proceedings of the 2007 ACM
symposium on Solid and physical modeling, 421–429.

YAN, Z., GU, L., HUANG, P., LV, S., YU, X., AND KONG, X.
2007. Soft tissue deformation simulation in virtual surgery us-
ing nonlinear ﬁnite element method. In Engineering in Medicine
and Biology Society,2007 EMBS.29th Annual International Con-
ference of the IEEE, 3642–3645.

YU, W., LI, Y., ZHENG, Y. P., LIM, N. Y., LU, M. H., AND FAN,
J. 2006. Softness measurements for open-cell foam materials
and human soft tissue. Measurement Science and Technology,
1785–1791.

ZHUANG, Y., AND CANNY, J. 2000. Haptic interaction with global
deformations. In Robotics and Automation, 2000. Proceedings.
ICRA ’00. IEEE International Conference, 2428–2433.

ZIENKIEWICZ, O. C., TAYLOR, R. L., AND ZHU, J. Z. 2005. The
Finite Element Method: Its Basis and Fundamentals. Elsevier
Butterworth Heinemann, Oxford.

204

