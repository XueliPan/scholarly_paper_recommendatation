Fabricating Spatially-Varying Subsurface Scattering

Yue Dong∗ †

Jiaping Wang†

Fabio Pellacini‡

Xin Tong†

Baining Guo∗ †

∗ Tsinghua University

† Microsoft Research Asia

‡ Dartmouth College

Figure 1: Our system automatically generates a layered material volume for approximating a custom BSSRDF. (a)The appearance of a real
material sample under diffuse lighting and a beam light. (b)A collection of layers generated by our system for assembling the output volume.
(c) The appearance of the fabricated material volume under the same diffuse lighting and beam light.

Abstract

Many real world surfaces exhibit translucent appearance due to
subsurface scattering. Although various methods exists to mea-
sure, edit and render subsurface scattering effects, no solution exists
for manufacturing physical objects with desired translucent appear-
ance. In this paper, we present a complete solution for fabricating
a material volume with a desired surface BSSRDF. We stack layers
from a ﬁxed set of manufacturing materials whose thickness is var-
ied spatially to reproduce the heterogeneity of the input BSSRDF.
Given an input BSSRDF and the optical properties of the manu-
facturing materials, our system efﬁciently determines the optimal
order and thickness of the layers. We demonstrate our approach
by printing a variety of homogenous and heterogenous BSSRDFs
using two hardware setups: a milling machine and a 3D printer.

1 Introduction

Traditional printing technology can reproduce the colors of natural
images, but it ignores the directionally dependent aspects of real-
world surface appearance. Recently, Matusik et al. [2009] demon-
strated that by combining several inks with different reﬂectance
properties, printers can reproduce the directionally dependent be-
havior of spatially-varying opaque materials. Another important
aspect of surface appearance is subsurface scattering, which is im-
portant for translucent materials such as wax, marble, food, and
skin. Although many methods have been proposed for capturing,
rendering and editing subsurface scattering effects, no system ex-
ists for fabricating physical objects with such appearance.

Fabricating a material volume with desired subsurface scattering
effects is useful in many applications. In the food industry, great

ACM Reference Format
Dong, Y., Wang, J., Pellacini, F., Tong, X., Guo, B. 2010. Fabricating Spatially-Varying Subsurface Scatter-
ing. ACM Trans. Graph. 29, 4, Article 62 (July 2010), 10 pages. DOI = 10.1145/1778765.1778799 
http://doi.acm.org/10.1145/1778765.1778799.

Copyright Notice
Permission to make digital or hard copies of part or all of this work for personal or classroom use is granted 
without fee provided that copies are not made or distributed for proﬁ t or direct commercial advantage 
and that copies show this notice on the ﬁ rst page or initial screen of a display along with the full citation. 
Copyrights for components of this work owned by others than ACM must be honored. Abstracting with 
credit is permitted. To copy otherwise, to republish, to post on servers, to redistribute to lists, or to use any 
component of this work in other works requires prior speciﬁ c permission and/or a fee. Permissions may be 
requested from Publications Dept., ACM, Inc., 2 Penn Plaza, Suite 701, New York, NY 10121-0701, fax +1 
(212) 869-0481, or permissions@acm.org.
© 2010 ACM 0730-0301/2010/07-ART62 $10.00 DOI 10.1145/1778765.1778799 
http://doi.acm.org/10.1145/1778765.1778799

effort is made to manufacture realistic-looking fake food for exhibi-
tion and advertisements. Artists need powerful techniques for mim-
icking realistic human skin in wax sculptures. Interior designers
use faux painting to reproduce the appearance of marble for surface
decoration. Although dedicated techniques have been developed
for many of these applications, there is no general and automatic
solution for fabricating a material volume with desired translucent
effects. Lots of manual work and experience are needed for crafting
materials with desired translucent appearance.

In this paper, we present a method for automatically fabricating
a material volume with a desired BSSRDF (bidirectional subsur-
face scattering reﬂectance distribution function) [Nicodemus et al.
1977]. The BSSRDF is a general model for describing the surface
appearance of translucent materials in terms of the light transport
between every pair of surface points. We focus on optically thick
materials, whose subsurface scattering behavior is well captured by
the diffusion approximation [Ishimaru 1978]. For such materials,
our key observation is that it is possible to reproduce the visual ap-
pearance of a given material by carefully combining other materials
with different optical properties. Thus with a ﬁxed set of basis man-
ufacturing materials, we can reproduce a wide variety of heteroge-
neous BSSRDFs by stacking material layers whose thickness and
composition vary spatially. The type of basis manufacturing mate-
rials and number of layers are constrained by the hardware setup.
Given these constraints, our method computes the distribution of
basis materials and spatially variant layer thicknesses so that the
BSSRDF of the output volume is as close to the target BSSRDF as
possible. A surface texture layer may be used to enrich the color of
the BSSRDF of the output volume when needed. Figure 1 show an
example volume manufactured with our system.

We compute the optimal layer layout of the output volume, i.e.,
the distribution of basis materials and thickness of each layer, by
searching for the BSSRDF that is the closest to the input BSS-
RDF among the space of BSSRDFs of all possible layer layouts.
For a homogeneous material, the material and thickness is constant
within each layer but may vary across layers. In this case, the com-
putation is relatively easy and to further facilitate this computation
we have developed an efﬁcient method for quickly constructing the
BSSRDFs of all layer layouts. The case of heterogeneous materials
is much harder. The complex interactions between the optical prop-
erties and spatial distributions of the materials lead to non-linear
relationship between the BSSRDF over the surface and the under-
lying volumetric material properties. Deriving the optimal layer

Color TextureLayer 1Layer 2Layer 3(a) Input BSSRDF(b) Layered material volume(c) Fabricated Material Volume ACM Transactions on Graphics, Vol. 29, No. 4, Article 62, Publication date: July 2010.layout from the input BSSRDF is difﬁcult as it amounts to solving
a large non-linear optimization problem. Furthermore, manufac-
turing constraints impose limits on valid material distributions and
thickness of layers and make this non-linear optimization even more
challenging. We solve this problem in two steps. In the ﬁrst step,
we decouple the non-local BSSRDF into local scattering proﬁles
and determine the material composition (i.e. the basis material in
each layer) under each surface point with the scattering proﬁle de-
ﬁned on each point separately. After that, we model the light trans-
port between surface points using a diffusion process and optimize
the thickness of the layers at each location using an adapted in-
verse diffusion optimization. For any given BSSRDF, our approach
automatically computes the optimal material volume in dozens of
minutes.

We have experimented with two hardware setups having different
tradeoffs: a milling machine and a 3D printer. The milling machine
allows us to choose manufacturing materials with a variety of scat-
tering properties, but has limitations in the number and precision
of the layers it can effectively produce. The 3D printer allows us
to print quickly a larger number of layers with high precision, but
has very limited selection of manufacturing materials. With these
hardware setups, our method can generate material volumes with a
wide range of homogeneous and heterogeneous BSSRDFs.

2 Related Work

Subsurface Scattering Modeling: Subsurface scattering can be
described by the bidirectional surface scattering reﬂectance dis-
tribution function (BSSRDF) that expresses the light transport be-
tween pairs of surface points [Nicodemus et al. 1977]. Many meth-
ods have been developed for capturing BSSRDFs from real materi-
als[Debevec et al. 2000; Goesele et al. 2004; Tong et al. 2005; Peers
et al. 2006], editing the measured BSSRDFs[Xu et al. 2007; Wang
et al. 2008b; Song et al. 2009], and rendering BSSRDFs under dif-
ferent lighting conditions [Lensch et al. 2003; Hao and Varshney
2004; Wang et al. 2005; d’Eon et al. 2007]. Although these methods
provide good solutions for modeling and rendering surface appear-
ance caused by subsurface scattering, they all ignore the material
properties inside the object volume. On the contrary, our system
takes the BSSRDF as input and approximates its behavior with a
man-made material volume.

Jensen et al.

The subsurface scattering of a translucent material can also be mod-
eled by radiative light transfer in the material volume with known
optical properties [Hanrahan and Krueger 1993; Dorsey et al. 1999;
Pharr and Hanrahan 2000].
[2001] presented an
analytic dipole model for subsurface scattering in homogeneous
translucent materials, which is then extended for modeling light dif-
fusion in multi-layered translucent materials [Donner and Jensen
2005]. Stam [1995] modeled the light transport in heterogeneous
participating media with the diffusion approximation.
In [Chen
et al. 2004], heterogeneous subsurface scattering is modeled with
a shell texture layer and a homogeneous core, where the material
properties in the volume are speciﬁed by the user. Recently, [Don-
ner et al. 2009] presented an empirical BSSRDF model for ﬁtting
the directional BSSRDF of homogeneous materials. Different from
these methods that focus on computing the subsurface scattering
from known volumetric material properties, our method computes
a layered volume of basis materials based on surface appearance.

Material Property Acquisition:
Jensen et al. [2001] ﬁtted the
scattering properties of a homogeneous material from the BSSRDF
captured from its surface. For heterogeneous translucent materials,
several methods compute the spatially varying scattering properties
by ﬁtting the dipole model to BSSRDFs at each point [Tariq et al.

2006; Donner et al. 2008] or per region [Weyrich et al. 2006; Ghosh
et al. 2008]. However, these methods can only represent materials
with slowly varying properties such as skin, where the input BSS-
RDF can be well approximated by a homogeneous BSSRDF com-
puted from scattering properties at each point. It cannot be used
for modeling many other heterogeneous translucent materials with
sharp variations, such as marble and jade.

In medical imaging, optical tomography [Arridge and Schotland
2009] has been developed for estimating material properties in body
tissues from measured surface appearance by solving an inverse dif-
fusion problem. [Wang et al. 2008a] presented a GPU-based inverse
diffusion algorithm for computing volumetric material properties
from a measured BSSRDF. Although these inverse diffusion meth-
ods can reconstruct the material properties in the object volume
well, they cannot be directly applied to design the new volumet-
ric distribution of basis materials for approximating the measured
surface appearance, where the number of basis materials is limited
and the scattering properties of basis materials are always different
from the volumetric material properties under the measured surface.
In this paper, we extend the approach in [Wang et al. 2008a] sub-
stantially, to compute a material volume suitable for manufacturing.

Appearance Printing: A traditional color printing system can
faithfully print the color of surfaces, but cannot reproduce the di-
rectional dependence aspect of appearance. Weyrich et al. [2009]
used a milling machine to fabricate a designed microfacet pattern on
a physical surface for generating custom surface reﬂectance. Most
recently, Matusik et al. [2009] developed a system for printing spa-
tially varying BRDFs via a set of inks with known BRDFs. Al-
though these systems can well reproduce the surface reﬂectance,
they cannot model the subsurface scattering effects caused by light
transport inside the object volume.

Concurrent to our work, Haˇsan et al. [2010] propose a 3D printer
based solution for reproducing material volume with a speciﬁed
BSSRDF. Although both approaches are based on the diffusion ap-
proximation and approximate the input BSSRDF with layers of ba-
sis materials, they are different in several ways. To ﬁnd the layer
layout for approximating homogeneous BSSRDFs, [Haˇsan et al.
2010] develops efﬁcient search heuristics by pruning the layer lay-
outs that yield poor solutions, while our paper presents a cluster
based approach for computing the BSSRDFs of all valid layer lay-
outs. This allows us to precompute the gamut of basis materials
and then ﬁnd the layer layout for a speciﬁed BSSRDF via nearest
neighbor search. For heterogeneous BSSRDFs, [Haˇsan et al. 2010]
determines the layer layout for each surface point separately from
the local scattering proﬁles that are factorized from the input BSS-
RDF as in [Song et al. 2009]. In our method, the local scattering
proﬁles are only used to initialize the layer layout in the volume. A
volume optimization algorithm is proposed to further optimize the
volume layer layout for approximating the input BSSRDF. Com-
bined with surface texture layer and two hardware solutions (3D
printer and milling machine), our method can effectively reproduce
a wide variety of heterogeneous BSSRDFs with a ﬁxed set of basis
manufacturing materials.

Object Manufacturing: Most traditional computer aided design
and manufacturing systems represent 3D shape with B-rep geome-
try [Baumgart 1972] and fabricate each separate part of a 3D shape
with one homogeneous substrate. The material variation inside the
object volume is ignored. 3D printers construct the complex 3D
objects by aggregating materials layer by layer. Despite their hard-
ware capability to support voxel-based object and material varia-
tions in the object volume, most commercial systems available now
can only print B-rep geometry with one or two proprietary materi-
als inside [Vilbrandt et al. 2008]. Some printers such as the Z Corp
Spectrum Z510 have the capability to print colors at any voxel in an

62:2       •       Y. Dong et al.ACM Transactions on Graphics, Vol. 29, No. 4, Article 62, Publication date: July 2010.Figure 2: The output volume V . Different colors indicate layers
with different basis materials.
(a) The layered volume for a ho-
mogeneous BSSRDF. (b) The layered volume for a heterogenous
BSSRDF.

object volume. However, the basis materials available for printing
are very limited and almost opaque.

Our system models the output volume as a set of layers of basis
materials, each of which can be well converted to a B-rep geome-
try and fabricated by traditional manufacturing hardware (such as
milling machines or 3D printers). It also can be easily extended for
future 3D printing systems that support more materials and ﬂexible
material variations in the object volume.

3 System Pipeline

Input BSSRDF: The goal of our work is to approximate the
appearance of a desired subsurface scattering material that is de-
scribed by the BSSRDF S(xi, ωi; xo, ωo) [Nicodemus et al. 1977],
which relates the outgoing radiance L(xo, ωo) at a point xo in direc-
tion ωo to the incoming radiance L(xi, ωi) as

(cid:90)

(cid:90)

A

Ω

L(xo, ωo) =

S(xi, ωi; xo, ωo)L(xi, ωi)(n(xi) · ωi)dωidxi, (1)

where Ω is the hemisphere around xi; A is the area around the point
xo, and n(xi) is the surface normal at xi. As in [Goesele et al. 2004;
Peers et al. 2006; Song et al. 2009], we decompose the light trans-
port into two components as L(xo, ωo) = Ls(xo, ωo) + Ld(xo, ωo),
where Ls(xo, ωo) accounts for light immediately reﬂected from the
surface and Ld accounts for light scattered in the material volume.
In this work, we focus on the latter component Ld that is captured
by the diffuse BSSRDF Sd, which we further decompose as

1
π

Sd(xi, ωi; xo, ωo) =

Fr(η(xi), ωi)Rd(xi, xo)Fr(η(xo), ωo),

(2)

where Fr is the angular dependent Fresnel function that is deter-
mined by the refraction index η of the material, while Rd is a four
dimensional function of two surface locations that encodes the spa-
tial subsurface scattering of heterogeneous materials. Again fol-
lowing [Goesele et al. 2004; Peers et al. 2006; Song et al. 2009], we
focus exclusively on a representation for the 4D spatial component
of the diffuse BSSRDF Rd and ignore the angular dependencies.

Output Volume: We simulate the appearance of the input BSS-
RDF by printing an object volume V . Different manufacturing
hardware can construct objects using a ﬁxed set of basis materi-
als (with given translucent properties) speciﬁc to that hardware. To
approximate the BSSRDF on the surface, we construct the volume
with layers of these basis materials, as shown in Figure 2. The
thickness of layers under each surface point is identical for homoge-
neous BSSRDFs, and varied appropriately for simulating heteroge-
nous BSSRDFs. To model a BSSRDF with sharp variations, the
basis materials in the layer may also be varied under each surface
point. In our experiments, we found that to ensure that the output
volume is not too fragile, the minimal thickness of material layers
needs to be limited. Furthermore, to save manufacturing time and
cost, we also limit the total number of layers in the output volume.

Said another way, 3D manufacturing methods impose layout con-
straints that we have to respect during printing.

Material Mapping: As in standard printing methods, the output
volume is just an approximation of the input BSSRDF. Given the
basis materials and layout constraints, our goal is to produce an
output volume that is as close to the original input as possible. We
call material mapping the process by which we determine the vol-
ume to print. More formally, while respecting layout constraints,
we seek to minimize the L2 difference E between the input BSS-
RDF Rd and output BSSRDF R(cid:48)
d of the printed volume V , written
as

E =

(cid:90)

(cid:90)

xi

x j

(cid:13)
(cid:13)Rd(xi, x j) − R(cid:48)

d(xi, x j)(cid:13)
2dxidx j.
(cid:13)

(3)

To print the volume, we need to determine the basis material and
thickness of each layer, which we call the layer layout, under each
surface point in the volume V . Since the surface BSSRDF depends
on the volume distribution in a non-linear manner, determining the
layer layouts for the volume V amounts to a non-linear optimiza-
tion. This makes BSSRDF printing very different from color and
reﬂectance printing, since in those cases determining what to print
amounts to simpler operations.

To print homogenous materials, we map the BSSRDF to a volume
made by layering slabs of homogenous basis materials that have
the same thickness for points on the surface. Conceptually, to deter-
mine the basis material and the thickness of each layer, we compute
the BSSRDF for all possible layer layouts, generated by the basis
materials, and pick the closest one. Since computing the BSSRDF
for each layer layout by brute force is expensive, we develop an ef-
ﬁcient method for quickly constructing the BSSRDFs of all layer
layouts.

To print a BSSRDF generated from heterogeneous translucent ma-
terials, we vary the column layer layouts under different surface
points in the output volume. The resulting light transport becomes
more complex due to the heterogeneity, making material mapping
more challenging. We make this process manageable by introduc-
ing a two step process. First, in the volume initialization step, we
factor the BSSRDF into local scattering proﬁles. We then approxi-
mate each scattering proﬁle with a homogeneous BSSRDF and ini-
tialize the layer layout (i.e. the basis material and thickness of each
layer) in each column separately with the homogenous mapping
method. At each surface point, this initialization determines the
basis material for each layer and a starting layer thickness. We use
this as starting conﬁguration for a second step, the volume optimiza-
tion step, where we model the light transport in the volume using a
diffusion process and optimize the thickness of the layers at each lo-
cation using an adapted inverse diffusion optimization [Wang et al.
2008a]. We will describe the details of our material mapping pro-
cedure in the following sections.

Surface Texture: Since we use only a small number of basis ma-
terials with limited color hues and saturations, it is possible that
some of the rich chromatic variations in input BSSRDFs falls out-
side the color gamut of our basis. To further enrich the color of
the BSSRDF generated by the output volume, a very thin color tex-
ture layer is placed on the top surface for modulating both incoming
and outgoing radiance. We ignore the thickness of this color texture
layer and represent it as a Nx × Ny 2D surface color texture T that
represents the transmission for RGB channels, in which 1 indicates
fully transparent and 0 is opaque. Given input BSSRDF Rd, we
solve the optimal color texture and the output volume iteratively.
Given the initial color texture T0, we modulate the input BSSRDF
Rd(xi, xo) as RT
d (xi, xo) = Rd(xi, xo)/(T (xi)T (xo)) and use the re-

NyNzNxNyNzNx(a)(b)Fabricating Spatially-Varying Subsurface Scattering       •       62:3ACM Transactions on Graphics, Vol. 29, No. 4, Article 62, Publication date: July 2010.Figure 3: Photographs and optical properties of basis materials
used in our two manufacturing solutions. (a)(b)(c) The basis mate-
rials used for the milling machine solution. (d)(e) The basis mate-
rials used for the 3D printer solution.

sult RT
we update the color texture by

d as the input for material mapping. After material mapping,

T (x) =

∑xo∈A Rd(x, xo)2R

(cid:48)

d(x, xo)

,

∑xo∈A Rd(x, xo)

(4)

(cid:48)

where R
d is the BSSRDF computed from the output volume ob-
tained by material mapping. We repeat this process until the update
of the color texture is small enough.

Manufacturing Hardware: We tested our system with two man-
ufacturing conﬁgurations. The ﬁrst solution is based on a milling
machine, where the basis material for each layer can be chosen from
a set of substrates with different translucency and colors. We mill
each material layer separately from a substrate block and assemble
all layers together to generate the output volume. We use three basis
materials and limit the number of layers to three for this hardware.

The second solution is based on a 3D printer, which can print com-
plex geometric shapes with high precision. Our 3D printer provides
one basis material used to print 3D shapes and one support material
that is used during the printing process, but normally removed after
printing. In our system, we retain the support material after print-
ing and use it as a second basis material. We use six layers for this
hardware. Figure 3 illustrates all basis materials and their scattering
properties in these two solutions.

Printing Gamut:
It is surprising that given this small number of
basis materials, the resulting output volumes we generate approxi-
mate well a wide range of BSSRDFs. We borrow the term “gamut”
from traditional printing to indicate the space of homogenous BSS-
RDFs reproduced by our setup. Figure 4 shows the gamut of our
two manufacturing setups, where σs and σa are the scattering co-
efﬁcient and absorption coefﬁcient of the homogeneous material,
respectively. We compute this gamut by mapping each homoge-
nous BSSRDF to a layered volume of basis materials and include
in the gamut all BSSRDFs with relative mapping errors smaller than
10−4. We compute the relative error as

(cid:82)
xi

(cid:82)
x j

(cid:13)
(cid:13)Rd(xi, x j) − R(cid:48)
(cid:82)
xi

d(xi, x j)(cid:13)
2dxidx j
(cid:13)
(cid:13)Rd(xi, x j)(cid:13)
(cid:13)
2dxidx j
(cid:13)

(cid:82)
x j

.

(5)

Different from material and reﬂectance printing, the gamut of ho-
mogenous materials we can simulate is larger than the convex hull
of the basis materials. This is the result of the non-linear relation-
ship between the BSSRDF and the volumetric material properties.
From a intuitive standpoint, since an observer can only see the ob-
ject surfaces, we are free to vary the volume as needed to reproduce
that appearance.

Computing all the possible heterogeneous BSSRDFs that can be re-
produced by our setup is prohibitively expensive. To gain an intu-
ition of which heterogenous variations we can reproduce, we make
the observation that heterogenous BSSRDFs can be factored into
products of 1D scattering proﬁles independently deﬁned at each
surface location [Song et al. 2009]. These scattering proﬁles rep-

Figure 4: The gamuts of our two manufacturing setups. The ba-
sis materials are indicated by red points. The blue gamut regions
indicate the homogeneous materials whose BSSRDFs can be re-
produced by our setup. The grey regions mark the homogeneous
materials with little scattering (with BSSRDF radius smaller than
1.0mm), which are not the main targets of our method.
(a) The
gamut of three basis materials used for the milling machine solu-
tion. (b) The gamut of two basis materials used for the 3D printer
solution.

resent well the local scattering effects at each surface location, ef-
fectively decoupling the pairwise correlations in the heterogeneous
BSSRDF. Intuitively, at each surface location we can think of the
scattering proﬁle as approximately deﬁning a homogenous BSS-
RDF that describes scattering from a small homogeneous region
around the point. If all these homogenous BSSRDFs ﬁt within our
gamut, our material volume should approximate well the original
heterogeneous BSSRDF.

4 Material Mapping

Volume Representation:
In this section we discuss the details
of how we compute the output volume that best matches the input
BSSDF. In our algorithms, the volume V is represented as Nx ×
Ny × Nz voxels on a regular 3D grid, where Nx × Ny determines the
surface resolution and Nz determines the thickness of the layered
material volume (Figure 2). The voxel size is set to the precision
of the manufacturing hardware along three axes. The volume is
composed by Nl layers, each made of one of the basis materials. We
discretize each layer thickness by the voxel size and limit it to be
larger than a minimal thickness determined by the manufacturing
hardware. We indicate with Mx the layer layout under a surface
point x, deﬁned as the set of basis materials and thickness for each
layer in the column under x.

4.1 Homogeneous BSSRDFs

Output Volume: Let us ﬁrst consider the BSSRDF generated
from a semi-inﬁnite homogeneous material slab, which is isotropic
and can be represented as a function of distance r = (cid:107)xi − xo(cid:107) be-
tween two surface points as R(r) = Rd(xi, xo). To reproduce this
BSSRDF, we layer Nl slabs of base materials that have equal thick-
ness for all points on the surface. The resulting multi-layered vol-
ume is homogeneous along the X and Y directions but heteroge-
neous along Z.

Homogenous Mapping: To determine the basis material and
thickness of each layer (i.e. the number of voxels it occupies along
Z), we solve Equation 3 by computing the BSSRDFs for all possi-
ble layer layouts of the basis materials, and pick the closest one to
the input BSSRDF.

For each conﬁguration, we compute the BSSRDF RNl (r) gener-
ated by the volume with Kubelka-Munk theory [Donner and Jensen

s62:4       •       Y. Dong et al.ACM Transactions on Graphics, Vol. 29, No. 4, Article 62, Publication date: July 2010.2005]:

ˆRNl = ˆR1 +

ˆT1 ˆR1 ˆT1

1 − ˆR1 ˆRNl −1

(6)

where ˆR and ˆT refer to the Fourier transformed function R(r) and
T (r). R1(r) and T1(r) are the BSSRDF and transmission function
of the top layer computed using the multipole model [Donner and
Jensen 2005]. RNl −1(r) is the BSSRDF of the remaining Nl − 1
layers beneath the top layer, which can be recursively computed
using Equation 6. After computation, we transfer the result back to
the spatial domain via inverse FFT.

Performing this computation for each layer layout separately would
be impractical given the very large number of possible conﬁgura-
tions. We reduce the number of needed BSSRDF evaluations by ob-
serving that many layer layouts of basis materials generate similar
BSSRDFs. This is because small variations of layer thickness gen-
erally have little effect on a BSSRDF. Therefore, for layer layouts
that have the same top layer and similar RNl −1(r), we can compute
their BSSRDF once.

Based on this observation, our algorithm starts by constructing the
set M1 = {m1} of all layouts m1 that include a single basis ma-
terial whose thickness is varied from the minimal layer thickness
to the output volume thickness in voxel sized steps along Z. We
compute the BSSRDFs and transmission functions of each slab us-
ing the multipole model [Donner and Jensen 2005]. We then clus-
ter these layouts using k-means clustering such that the distance of
BSSRDFs in each cluster is less than a small threshold. For each
cluster, we compute the representative BSSRDF and transmission
function as the average of BSSRDFs and transmission functions of
layer layouts in the cluster.

l from Mi. Formally, Mi+1 = {m1
l

After that, we iteratively construct all layer layouts from bottom to
top in Nl steps. In each step, we generate the set Mi+1 of candi-
date layouts constructed by adding a basis material layer m1
l from
(cid:83) mi
M1 to a layer layout mi
l|m1
l ∈
l ∈ Mi}, where the (cid:83) operator adds a layer on top of a layout.
M1, mi
We discard all layouts with thickness larger than the output volume.
The BSSRDF of each layout in Mi+1 is computed with the repre-
sentative of M1
l using Equation 6. Thus the total number
of BSSRDF computations is NM1 × NMi (cid:28) |M1| × |Mi|, where NM1
and NMi are the number of clusters in M1 and Mi and | · | is the size
of a set. We then cluster Mi+1 based on the layout BSSRDFs and
pick representatives.

l and Mi

After Nl steps, we remove all layer layouts whose thickness is not
equal to volume thickness and compute the BSSRDF for layouts in
the ﬁnal set. Given an input BSSRDF, we ﬁrst search for the best
matched representative BSSRDF. We then compute the BSSRDF of
each layer layout in this cluster and search for the best match. The
approximate nearest neighbor acceleration scheme is used to speed
up this search process[Mount and Arya 1997].

4.2 Heterogeneous BSSRDFs

Overview: To print a BSSRDF generated from heterogeneous
translucent materials, we vary the column layer layouts (i.e.
the
basis material and thickness in each layer) under different surface
points, resulting in a heterogenous output volume. Computing the
layer layouts for each column amounts to solving the non-linear
optimization problem deﬁned in Equation 3. This optimization is
much more challenging than homogeneous mapping since the BSS-
RDF of a heterogenous output volume is determined by the cou-
plings of different layer layouts in all columns. We do so with a two
step process. First, in the volume initialization step, we decouple
the BSSRDF into local scattering proﬁles and use the homogenous

Figure 5: Rendering results of BSSRDFs after volume initializa-
tion and volume optimization under diffuse lighting shown in the
top row. The errors of BSSRDFs after the initialization and opti-
mization processes are presented in the bottom row.

algorithm in Section 4.1 to assign basis materials and initial layer
thickness to each column separately. Second, in the volume opti-
mization step, we then optimize all layer thickness for all columns
concurrently by using an inverse diffusion optimization. Figure 5
shows the best ﬁt volume after each step compared to the original
BSSRDF. After initialization, the layered material volume roughly
approximates the input BSSRDF. Further improvements to the ap-
proximation are achieved with volume optimization.

Scattering Proﬁles: To determine the material layout in each col-
umn, we ﬁrst decouple the input diffuse BSSRDF Rd into a prod-
uct of 1D scattering proﬁles Px(r) deﬁned at each surface location
x, and parameterized over the local distance r = ||xo − xi|| as in
[Song et al. 2009]: Rd(xi, xo) ≈ (cid:112)Pxi(r) Pxo(r). For a heteroge-
neous BSSRDF, this factorization effectively decouples the non-
local light transport between pairs of surface points into a set of
local scattering proﬁles, each of which is deﬁned at a single point
and mainly determined by the scattering properties of the material
volume under such a surface point.

Volume Initialization: Based on this observation, we consider
the homogenous BSSRDF determined by the scattering proﬁle at
(cid:82) ∞
0 [Px(r) − R(r)]2rdr,
each location x, deﬁned as Rx(r) = argminR
and use the homogenous algorithm presented above to assign a
layer layout for the material column at x. More speciﬁcally, we ﬁrst
precompute the BSSRDFs of all valid homogenous layer layouts.
For each surface location, we then search for the best matching rep-
resentative BSSRDF in the precomputed dataset. We then choose
the layer layout in this cluster that is most similar to the ones as-
signed to the neighboring points, proceeding in scanline order. To
assign a layer layout to the point, the similarity of layer layouts is
measured by ∑z δ (bx(z), by(z)) where bx(z) and by(z) are the basis
materials at depth z for the layer layouts at x and y. This assignment
scheme favors smoothly varying layer layouts for regions with sim-
ilar local scattering proﬁles.

The initialized volume only provides a rough approximation for the
input BSSRDF because the light transport between columns is not
considered in the last step. To obtain a better match, we ﬁx the ba-
sis materials used in all layers and further optimize all layer thick-
nesses concurrently to better approximate the input BSSRDF by
minimizing the objective function in Equation 3. Here the BSS-
RDF of the output volume R(cid:48)
d is computed by simulating the light
transport in the volume with a diffusion process, which is described
by the following equations for points v in the volume V and points
x on the surface A [Ishimaru 1978; Arbree 2009]:

∇ · (κ(v)∇φ (v)) − σa(v)φ (v) = 0,

v ∈ V

(7)

BSSRDFDistance0.020TargetBSSRDFAfterVolumeInitializationAfterVolumeOptimizationFabricating Spatially-Varying Subsurface Scattering       •       62:5ACM Transactions on Graphics, Vol. 29, No. 4, Article 62, Publication date: July 2010.Set basis materials for each layer using the volume initialization step
Set initial thicknesses h0 using the volume initialization step
Set initial search direction: d0 = −∇E h(h0) and p0 = d0
Repeat following steps until Eh < ε

Compute gradient: ∇E h(ht =
Set pt = −∇E h(ht )

(cid:17)

(cid:16) dEh
dh(x,l)

Update search direction: dt = pt + β · dt−1, β = max

Compute λ : Golden section search by min
Update solution ht+1 = ht + λ (cid:48)dt

λ

[Eh (ht + λ dt )]

(cid:18) pT

(cid:19)

t (pt −pt−1)
pT
t−1 pt−1

, 0

Table 1: Conjugate gradient based algorithm for minimizing Eh.

φ (x) + 2cκ(x)

∂ φ (x)
∂ n(x)

=

4

1 − Fdr

Li(x)

x ∈ A

(8)

where σa(v) and κ(v) = 1/[3(σa(v) + σs(v)] denote the absorption
and diffusion coefﬁcients at v, φ (v) is the radiant ﬂux, Fdr is the
diffuse Fresnel reﬂectance (determined by the refraction index η of
the material [Jensen et al. 2001]) and c = (1 + Fdr)/(1 − Fdr). Here
we assume the phase function of the material is isotropic. The dif-
fuse incoming lighting Li(x) at a surface point x is given by Li(x)
= (cid:82)
Ω L(x, ωi)(n · ωi)Fr(η(x), ωi)dωi. Once the radiant ﬂux is de-
termined for a given incoming lighting by the diffusion process,
the multiple scattering component of the outgoing radiance at x is
computed as

Ld(x, ωo) =

[(1 +

)φ (x) −

Li(x)].

(9)

Fr(η(x), ωo)

4π

1
c

4

1 + Fdr

We can then compute the diffuse BSSRDF between two surface
points, by considering a unit incoming lighting Li(x) = 1 at x and
ignoring the angular Fresnel terms for both incoming and outgoing
lighting, as

R(cid:48)
d(xi, xo) =

(cid:40) 1
4π [(1 + 1
4π [(1 + 1
1

c )φ (xo)]
c )φ (xo) − 4
1+Fdr

]

xi (cid:54)= xo
xi = xo.

(10)

We determine the thickness of each layer by minimizing the objec-
tive function in Equation 3 where the volume BSSRDF is computed
using the diffusion process above. This can be solved by inverse
diffusion optimization, as in [Wang et al. 2008a]. Since the basis
materials in all layers are determined during initialization, the ob-
jective function Eh is a function of only the set of spatially varying
layer thicknesses h = {h(x, l)}, where h(x, l) is the starting depth
of layer l at x.

To minimize Eh, we apply the conjugate gradient algorithm, sum-
marized in Table 1. We begin by initializing basis materials and
layer thickness using the homogenous method. At each step, we
determine the gradient ∇Eh of Eh with respect to h. To guarantee
that the thickness is larger than the minimal layer thickness deﬁned
by the material conﬁguration, we set the gradient to 0 when the
thickness reaches the minimal thickness constraint. The search di-
rection is then updated with the Polak-Ribiere method [Press et al.
1992]. The optimal step size λ along the search direction is found
by a golden section search. We then update h using the computed
gradient ∇Eh and λ . We continue iterating until the layer thickness
converges.

Gradient Computation: The most expensive step of this algo-
rithm is the computation of the Eh gradient relative to the thick-
nesses h(x, l). A straightforward method is to perturb each layer
boundary at each location, update the material properties in the vol-
ume, and compute the resulting change in objective function value.
This would require Nx × Ny × Nl diffusion simulations, becoming
prohibitively expensive. We speed up this procedure by using an
adjoint method similar to [Wang et al. 2008a].

We represent the error Eh({κ}, {σa}) as a function of the material
properties κ and σa of all voxels in the volume. Since these are

in turn deﬁned by the layer thickness (and the basis materials ﬁxed
during optimization), we can use the chain rule to derive the gradi-
ent of the objective function relative to layer thickness as:

dEh

=

dEh

dκ(x, zl − 1)

dEh

dσa(x, zl − 1)

+

dh(x, l)

dκ(x, zl − 1)

dh(x, l)

dσa(x, zl − 1)

dh(x, l)

(11)
where (x, zl) refers to the ﬁrst voxel in the l-th layer at x, and
(x, zl − 1) is the last voxel of upper l − 1 layers. Note that this
computation only involves voxels at the layer boundaries because
the change of the layer boundary only modiﬁes the material prop-
erties in the boundary voxels. We compute dEh/dκ(x, zl − 1)
and dEh/dσa(x, zl − 1) using the adjoint method (see Appendix
for details) [Wang et al. 2008a], while dκ(x, zl − 1)/dh(x, l) and
dσa(x, zl − 1)/dh(x, l) are directly computed by

dκ(x, zl − 1)

dh(x, l)

dσa(x, zl − 1)

dh(x, l)

= κ(x, zl) − κ(x, zl − 1)

= σa(x, zl) − σa(x, zl − 1).

(12)

Using this scheme, we only need two diffusion simulations for com-
puting the gradient, which is much more efﬁcient than the straight-
forward method.

Diffusion Computation:
In inverse diffusion optimization, the
diffusion simulation is used in both gradient computation and
golden search. To solve the diffusion equation on a 3D regular grid
of a layered material volume, we discretize the diffusion equation
as a set of linear equations over the voxels using the ﬁnite differ-
ence method (FDM) scheme in [Stam 1995]. We implemented a
multigrid method [Press et al. 1992] for solving this sparse linear
system on the GPU using CUDA. The adjoint diffusion equation is
discretized and computed in the same way.

5 Hardware Manufacturing Setup

We fabricate the output volume determined during material map-
ping using two different hardware solutions: a milling machine and
a 3D printer.

Milling Machine: The ﬁrst solution is based on an Atrump M218
CNC machining center. The maximum operating range is 660mm,
460mm, and 610mm in the X, Y and Z directions respectively. The
stepper motor resolution is 0.005mm. The machining center has
an automation tool changer with 16 drill bits. The size of dill bits
ranges from 6mm to 0.5mm. Based on these hardware properties,
we set the output volume size to be 130mm along each dimension,
and the voxel size is 1.0mm × 1.0mm × 0.1mm, so one pixel of the
measured BSSRDF corresponds to one voxel of the output volume.
The number of layers in the volume is three and the minimal layer
thickness is 1.0mm.

Given the output volume, we convert each layer into a B-rep and
fabricate it with the milling machine. If both sides of a layer are
not ﬂat, our system splits it into two or more pieces, each of which
has one ﬂat side. For all results shown in this paper, we only need
to split the middle layer into two pieces for manufacturing. Given
the B-rep of each layer piece, the milling machining center mills
a basis material block into our desired layer shape. A typical out-
put of the milling machine is shown in Figure 1. After the milling
process, we use UV sensitive glass glue to assemble those layers
into the ﬁnal volume and ignore the light refraction between the
layer boundaries. The milling time varies with the complexity of
the layer surface. For the homogeneous cases, the average total
milling time for all three layers is about 30 minutes. For the hetero-
geneous cases, the total milling time ranges from one hour to six
hours.

62:6       •       Y. Dong et al.ACM Transactions on Graphics, Vol. 29, No. 4, Article 62, Publication date: July 2010.Figure 6: The comparisons of the red channel scattering proﬁles
measured from the real homogeneous material samples (in blue)
and the ones measured from the fabricated volumes (in red).

6 Experimental Results

Table 2: Computation times for all heterogeneous BSSRDF results
shown in the paper.

In our implementation, we use the Mastercam software to exe-
cute GCode to control the milling process. We do not optimize
the smoothness of the layer thickness of neighbor columns as in
[Weyrich et al. 2009] because the voxel size along the X and Y
directions in our setup is larger than the mill bit diameters. More-
over, our solution is not sensitive to the layer surface orientation. In
practice, we found that the milling machine can reproduce well our
desired layer shapes without visual artifacts in the ﬁnal results.

3D Printer: The second solution is based on an Object Eden250
3D printing system. The net build size is 250mm × 250mm ×
200mm, and the precision of the resulting volume is 0.1mm along
each dimension. Thus we set the output volume size to be 100mm ×
100mm × 30mm and 0.1mm as the voxel size. The minimal layer
thickness is 0.1mm in this setup. Since the printer can control the
material distribution in more ﬂexible way, we set the number of lay-
ers to six in the output volume. For this solution, one pixel of the
measured BSSRDF corresponds to 10 × 10 voxels of the fabricated
volume. We obtain the BSSRDF for each voxel by upsampling the
original BSSRDF.

The printer manufactures objects with a single resin. It prints the
3D shapes with the resin material, while the support substrate auto-
matically ﬁlls the vertical gaps between the resins and the vertical
gaps between the resin and the build tray. Therefore, we convert the
layers consisting of resin materials as B-rep shapes and send them
together to the 3D printer. To print the volume with the support
material in the top layer, we add an extra thin resin layer on top of
the volume for printing and then remove it after printing. Both ma-
terials in the output volume are kept. Depending on the complexity
of material distribution and output volume size, the printing time
varies from 1.5 hours to 3 hours.

Basis Material Properties Measurement: For each basis mate-
rial, we measure the optical properties from a thick homogeneous
block of size of 100mm x 100mm x 64mm, where the light trans-
port in the volume is well modeled by the dipole approximation.
We then shoot red (635nm), green (532nm) and blue laser beams
(473nm) at a point on the top surface and capture the HDR images
of the scattering proﬁles around the lighting point for each color
channel. We then follow the method in [Jensen et al. 2001] to ﬁt
the material properties from the captured scattering proﬁles. Since
the basis material blocks are not perfectly homogeneous, we ran-
domly sampled scattering proﬁles at ten points on the top surface
and average them to get the ﬁnal scattering proﬁle for ﬁtting. Figure
3 lists the material properties of all basis materials used in our two
hardware solutions. All the basis materials we used have a similar
refractive index of 1.5. Thus in our implementation we ignore the
mismatch of refractive index between layers.

Color Texture: We printed our color texture with a Canon PIXMA
iP8500 ink jet printer on a transparent ﬁlm. To calibrate the color,
we print out a color pattern and captured a photo under uniform
back lighting with a calibrated camera. Then we compute the trans-
mission rate of the inks.

Material Mapping: We have implemented our system on a In-
tel Xeon E5400 machine with an NVidia GeForce 9800GT graph-
ics card. The material mapping algorithm is implemented in C++
on the CPU, while the diffusion simulation is implemented using
CUDA on the GPU. The computation time for solving the volume
layout of a homogeneous input BSSRDF is about 10 minutes. For
all heterogeneous BSSRDF results shown in the paper, our system
takes about 10 minutes for computing the printing gamut and do-
ing volume initialization. Depending on the volume size and the
number of layers in the output volume, it then takes 15 to 45 min-
utes for volume optimization (Table 2), in which 80% of the time is
spent for golden search, 16% for gradient computation, and 4% for
other computations. The number of conjugate gradient steps in the
volume optimization depends on the spatial complexity of the input
BSSRDF and varies across samples, ranging from 5 to 50.

Method Validation: We evaluated our method with three homo-
geneous BSSRDFs measured from real material samples. For this
purpose, we chose three materials (cheese, milk and wax) with vari-
ous degrees of translucency and simulated their homogeneous BSS-
RDFs with layered volumes fabricated by the milling machine. One
pixel of the measured BSSRDF corresponds to 1mm of the actual
size, thus the fabricated sample is 1 : 1 scale to the real sample.
No surface textures are applied to the resulting volumes. Figure 7
illustrates the scattering effects of real homogeneous material sam-
ples and fabricated material volumes under circular lighting. We
measure the BSSRDF from the fabricated volume and compute its
relative error by Equation 5. Figure 6 compares the scattering pro-
ﬁles measured from real samples to the ones measured from the
fabricated results. With three basis material slabs, the fabricated
volumes faithfully reproduce the homogeneous BSSRDFs with dif-
ferent scattering ranges.

We also tested our method with three measured BSSRDFs with dif-
ferent kinds of heterogeneity. Figure 8 shows the rendering results
of input heterogeneous BSSRDFs with images of our output vol-
umes under the different lightings. The two marble data sets are
from [Peers et al. 2006], and the jade data set is from [Song et al.
2009]. We used the milling machine to fabricate the layered vol-
umes for approximating the two marble data sets and used the 3D
printer for generating the volume for simulating the jade BSSRDF.
The surface textures are used for modulating the BSSRDFs of all
three volumes. We ignored the physical size of the original sam-
ple and followed the pixel to voxel correspondence to determine
the output scale (e.g. for the milling machine solution, one pixel
of the measured BSSRDF corresponds to one voxel, and for the 3D
printer solution, one pixel of the measured BSSRDF corresponds to
10×10 voxels of the fabricated volume) We calibrated the projector
and camera used in our capturing setup and used the same lighting
for rendering. As shown in Figure 8, our method effectively sim-
ulates the heterogeneous scattering effects of different materials.
Please see the accompanying video for more comparison results.
We scanned the volume with a line light and computed the relative
errors by Er = ∑i (Ii − I(cid:48)
i is the image captured
from the fabricated volume, while I is the rendering result of the
input BSSRDF.

i )2/ ∑i (Ii)2, where I(cid:48)

CheeseMilkWax00.20.40.60.81051015InputFabricateddistance(mm)00.20.40.60.81051015InputFabricateddistance(mm)00.20.40.60.81051015InputFabricateddistance(mm)15min23min45min42min35minTimeMaterialSamplesFabricating Spatially-Varying Subsurface Scattering       •       62:7ACM Transactions on Graphics, Vol. 29, No. 4, Article 62, Publication date: July 2010.More Results: Figure 9 shows a fabricated material volume for
simulating the heterogeneous BSSRDF of a real salmon slice. We
followed the method in [Peers et al. 2006] to capture the BSSRDF
from a portion of real salmon slice (i.e. the blue box in Figure 9(a))
and then used the measured BSSRDF as input to our system. We
printed the output volume using the 3D printer and applied a color
texture on its top surface. The size of the output volume is scaled to
100mm × 100mm × 12mm, while the size of the actual salmon slice
is 60mm × 60mm. As shown in Figure 9(c), the sharp variations of
scattering effects caused by different tissues are well captured by
our fabricated volume. Combined with surface texture, the result-
ing volume generates convincing scattering effects under different
lighting. Please see the accompanying video for more results.

Using our method, the user can also fabricate arbitrary objects with
convincing translucent appearance. To this end, our system ﬁrst
generates the layered material volume from the input BSSRDF and
then maps the layered material volume to a 3D object volume via
shell mapping [Porumbescu et al. 2005]. After that, we print the
3D object volume out via the 3D printer. Figure 10 displays a fab-
ricated jello piece with translucent appearance captured from a real
piece of jello. Figure 11 shows a fabricated round plate with a jade
BSSRDF designed by an artist. Under different lightings, the fabri-
cated object exhibits compelling subsurface scattering effects.

Limitations Since our method only focuses on diffuse BSSRDFs,
it cannot well model subsurface scattering of very translucent ma-
terials. Surface reﬂectance as well as single scattering are also ig-
nored in our approach. Moreover, due to the small number of basis
materials used in our method, our method will fail to reproduce
BSSRDFs with rich chromatic variations that are out of the color
gamut. The surface texture used in our method alleviates this lim-
itation but cannot totally solve it. Limited by the thickness of the
output volume, our method cannot be applied for 3D objects with
sharp geometry features.

7 Conclusions

We have presented a complete and efﬁcient solution for modeling
and fabricating desired spatially varying subsurface scattering ef-
fects with a limited number of basis materials. In our system, the
input BSSRDF is represented by a layered volume of basis mate-
rials, which can be separated into homogeneous components and
easily manufactured by existing hardware. A material mapping
algorithm has been proposed for efﬁciently computing an optimal
layered volume for an input BSSRDF. A surface texture is used to
further enhance the color of the BSSRDF of the output volume. Ex-
perimental results show that our system can well reproduce a wide
range of heterogenous subsurface scattering effects.

There are several interesting directions for future work. First, we
would like to investigate perceptual based distance metric for eval-
uating the visual similarity between the input BSSRDFs and BSS-
RDFs of the fabricated volumes. Second, we would like to extend
our method for modeling directional BSSRDF effects such as single
scattering. Finally, it would be interesting to integrate our method
with other surface reﬂectance printing methods for manufacturing
3D objects with more realistic surface appearance.

Acknowledgements

The authors would like to thank Steve Lin for paper proofreading
and Matt Callcut for video dubbing. The authors also thank Matt
Bell and William B. Kerr for operating the 3D printer. The authors
are grateful to the anonymous reviewers for their helpful sugges-
tions and comments. Fabio Pellacini was supported by the NSF
(CNS-070820, CCF-0746117), Intel and the Sloan Foundation.

References

ARBREE, A. 2009. Scalable And Heterogeneous Rendering Of
Subsurface Scattering Materials. PhD thesis, Cornell University,
Ithaca, New York. http://hdl.handle.net/1813/13986.

ARRIDGE, S. R., AND SCHOTLAND, J. 2009. Optical tomogra-
phy: Forward and inverse problems. Inverse Problems 25, 12,
123010:(59pp).

BAUMGART, B. G. 1972. Winged edge polyhedron representation.

Tech. rep., Stanford, CA, USA.

CHEN, Y., TONG, X., WANG, J., LIN, S., GUO, B., AND SHUM,
H.-Y. 2004. Shell texture functions. ACM Trans. Graph. 23, 3,
343–353.

DEBEVEC, P., HAWKINS, T., TCHOU, C., DUIKER, H.-P.,
SAROKIN, W., AND SAGAR, M.
2000. Acquiring the re-
ﬂectance ﬁeld of a human face. In Proc. ACM SIGGRAPH, 145–
156.

D’EON, E., LUEBKE, D., AND ENDERTON, E. 2007. Efﬁcient
Rendering of Human Skin. Eurographics Symposium on Ren-
dering, 147–157.

DONNER, C., AND JENSEN, H. W. 2005. Light diffusion in multi-
layered translucent materials. ACM Trans. Graph. 24, 3, 1032–
1039.

DONNER, C., WEYRICH, T., D’EON, E., RAMAMOORTHI, R.,
AND RUSINKIEWICZ, S. 2008. A layered, heterogeneous re-
ﬂectance model for acquiring and rendering human skin. ACM
Trans. Graph. 27, 5, 140.

DONNER,

C.,

LAWRENCE,

R.,
HACHISUKA, T., JENSEN, H. W., AND NAYAR, S. 2009. An
empirical bssrdf model. ACM Transactions on Graphics 28, 3
(July), 30:1–30:10.

RAMAMOORTHI,

J.,

DORSEY, J., EDELMAN, A., LEGAKIS, J., JENSEN, H. W., AND
PEDERSEN, H. K. 1999. Modeling and rendering of weathered
stone. In Proc. ACM SIGGRAPH, 225–234.

GHOSH, A., HAWKINS, T., PEERS, P., FREDERIKSEN, S., AND
DEBEVEC, P. 2008. Practical modeling and acquisition of lay-
ered facial reﬂectance. ACM Trans. Graph. 27, 5, 139.

GOESELE, M., LENSCH, H. P. A., LANG, J., FUCHS, C., AND
SEIDEL, H.-P. 2004. DISCO: acquisition of translucent objects.
ACM Trans. Graph. 23, 3, 835–844.

HANRAHAN, P., AND KRUEGER, W. 1993. Reﬂection from lay-
ered surfaces due to subsurface scattering. In Proc. ACM SIG-
GRAPH, 165–174.

HAO, X., AND VARSHNEY, A. 2004. Real-time rendering of

translucent meshes. In ACM Trans. Graph., vol. 23. 120–142.

HA ˇSAN, M., FUCHS, M., MATUSIK, W., PFISTER, H., AND
RUSINKIEWICZ, S. M. 2010. Physical reproduction of mate-
rials with speciﬁed subsurface scattering. ACM Transactions on
Graphics 29, 3 (Aug.).

ISHIMARU, A. 1978. Wave Propagation and Scattering in Random

Media. Academic Press.

JENSEN, H. W., MARSCHNER, S. R., LEVOY, M., AND HANRA-
HAN, P. 2001. A practical model for subsurface light transport.
In Proc. ACM SIGGRAPH, 511–518.

LENSCH, H. P. A., GOESELE, M., BEKAERT, P., MAGNOR, J.
K. M. A., LANG, J., AND SEIDEL, H.-P. 2003.
Interactive
rendering of translucent objects. Computer Graphics Forum 22,
2, 195–205.

MATUSIK, W., AJDIN, B., GU, J., LAWRENCE, J., LENSCH, H.
P. A., PELLACINI, F., AND RUSINKIEWICZ, S. 2009. Printing
spatially-varying reﬂectance. ACM Trans. Graph. 28, 3, 1–6.

62:8       •       Y. Dong et al.ACM Transactions on Graphics, Vol. 29, No. 4, Article 62, Publication date: July 2010.Figure 7: Comparison of scattering effects of real material samples and fabricated volumes under circular lighting.

Figure 8: Comparison of the rendering results of input heterogeneous BSSRDFs and the photographs of fabricated volumes under different
lightings.

Figure 9: Fabricated salmon with BSSRDF measured from a real salmon slice. (a) Photograph of real salmon slice under diffuse lighting.
The BSSRDF measured in the blue box is used as input to our system. (b) Photograph of result volume under diffuse lighting. (c) Rendering
results of the input BSSRDF under line lighting. (d) Photograph of result volume taken under the same line lighting.

rrr123412341234123412341234rrr(a)(b)(c)(d)(e)Fabricating Spatially-Varying Subsurface Scattering       •       62:9ACM Transactions on Graphics, Vol. 29, No. 4, Article 62, Publication date: July 2010.Figure 10: Fabricated jello. (a) A real piece of jello, the homogeneous BSSRDF of which is used as input to our system (b) A fabricated
piece of jello generated by 3D printer. (c) Photograph of the real piece of jello under line lighting. (d) Photograph of the piece of fabricated
jello under the same line lighting. The real jello and the fabricated one have the same size of 50mm × 50mm × 27mm

Figure 11: Fabricated round plate with designed jade-like subsurface scattering. (a) The input BSSRDF rendered with diffuse light. (b)
Photograph of fabricated round plate under diffuse light. (c)(d) Appearances of the fabricated round plate captured under different lightings.
The object size is 82mm × 82mm × 9mm

MOUNT, D., AND ARYA, S. 1997. ANN: A library for approxi-
mate nearest neighbor searching. In CGC 2nd Annual Fall Work-
shop on Computational Geometry.

WANG, R., TRAN, J., AND LUEBKE, D. 2005. All-frequency
interactive relighting of translucent objects with single and mul-
tiple scattering. ACM Trans. Graph. 24, 3, 1202–1207.

NICODEMUS, F. E., RICHMOND, J. C., HSIA, J. J., GINSBERG,
I. W., AND LIMPERIS, T. 1977. Geometrical Considerations
and Nomenclature for Reﬂectance. National Bureau of Standards
(US).

PEERS, P., VOM BERGE, K., MATUSIK, W., RAMAMOORTHI, R.,
LAWRENCE, J., RUSINKIEWICZ, S., AND DUTR ´E, P. 2006.
A compact factored representation of heterogeneous subsurface
scattering. ACM Trans. Graph. 25, 3, 746–753.

PHARR, M., AND HANRAHAN, P. M. 2000. Monte Carlo evalua-
tion of non-linear scattering equations for subsurface reﬂection.
In Proc. ACM SIGGRAPH, 275–286.

PORUMBESCU, S. D., BUDGE, B., FENG, L., AND JOY, K. I.

2005. Shell maps. ACM Trans. Graph. 24, 3, 626–633.

PRESS, W. H., ET AL. 1992. Numerical Recipes in C (Second

Edition).

SONG, Y., TONG, X., PELLACINI, F., AND PEERS, P. 2009.
SubEdit: a representation for editing measured heterogeneous
subsurface scattering. ACM Transactions on Graphics 28, 3
(Aug.), 31:1–31:9.

STAM, J. 1995. Multiple scattering as a diffusion process. In Euro.

Rendering Workshop, 41–50.

TARIQ, S., GARDNER, A., LLAMAS, I., JONES, A., DEBEVEC,
P., AND TURK, G. 2006. Efﬁciently estimation of spatially vary-
ing subsurface scattering parameters. In 11th Int’l Fall Workshop
on Vision, Modeling, and Visualzation 2006, 165–174.

TONG, X., WANG, J., LIN, S., GUO, B., AND SHUM, H.-Y. 2005.
Modeling and rendering of quasi-homogeneous materials. ACM
Trans. Graph. 24, 3, 1054–1061.

VILBRANDT, T., MALONE, E., H., L., AND PASKO, A. 2008.
Universal desktop fabrication. In Heterogeneous Objects Mod-
elling and Applications, 259–284.

WANG, J., ZHAO, S., TONG, X., LIN, S., LIN, Z., DONG, Y.,
GUO, B., AND SHUM, H.-Y. 2008. Modeling and rendering of
heterogeneous translucent materials using the diffusion equation.
ACM Trans. Graph. 27, 1, 9:1–9:18.

WANG, R., CHESLACK-POSTAVA, E., LUEBKE, D., CHEN, Q.,
HUA, W., PENG, Q., AND BAO, H. 2008. Real-time editing
and relighting of homogeneous translucent materials. The Visual
Computer 24, 565–575(11).

WEYRICH, T., MATUSIK, W., PFISTER, H., BICKEL, B., DON-
NER, C., TU, C., MCANDLESS, J., LEE, J., NGAN, A.,
JENSEN, H. W., AND GROSS, M. 2006. Analysis of human
faces using a measurement-based skin reﬂectance model. ACM
Trans. Graph. 25, 3, 1013–1024.

WEYRICH, T., PEERS, P., MATUSIK, W., AND RUSINKIEWICZ,
S. 2009. Fabricating microgeometry for custom surface re-
ﬂectance. ACM Trans. Graph. 28, 3, 1–6.

XU, K., GAO, Y., LI, Y., JU, T., AND HU, S.-M. 2007. Real-time
homogenous translucent material editing. Computer Graphics
Forum 26, 3, 545–552.

Appendix: We compute the gradient of objective function relative to material
properties in a voxel v with the adjoint method [Wang et al. 2008a]:

dEh/dκ(v) =

∇ϕi(v) · ∇φi(v) − 2λ ∆κ(v),

N f
∑
i=1

N f
∑
i=1

dEh/dσa(v) =

ϕi(v)φi(v),

where N f = Nx × Ny and φi(v) is determined by the original diffusion equation with
the unit illumination at each surface point xi, and ϕ(v) is determined by the adjoint
equation of the original diffusion equation:

∇ · (κ(v)∇ϕ(v)) − σa(v)ϕ(v) = 0,

v ∈ V,

ϕ(x) + 2cϕ(x)

∂ ϕ(x)

∂ n

=

2c
π

(cid:48)
(Rd (xi, x) − R
d (xi, x)),

x ∈ A,

(cid:48)
d (xi, x) is the difference between the measured BSSRDF Rd (xi, x)
where Rd (xi, x) − R
(cid:48)
and BSSRDF R
d (xi, x) computed from the original diffusion equation with the unit
illumination at xi.

(13)

(14)

(15)

(16)

(a)(b)(c)(d)62:10       •       Y. Dong et al.ACM Transactions on Graphics, Vol. 29, No. 4, Article 62, Publication date: July 2010.