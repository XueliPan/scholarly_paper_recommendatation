Author manuscript, published in "Computer Graphics Forum 29, 2 (2010) 497-506"
 DOI : 10.1111/j.1467-8659.2009.01619.x

9
0
0
2

 
c
e
D
1
3

 

 
-
 
1

 

i

n
o
s
r
e
v
 
,

4
3
6
3
4
4
0
0
-
a
i
r
n

i

EUROGRAPHICS2010/T.Akenine-MöllerandM.Zwicker(GuestEditors)Volume29(2010),Number2Real-timeRenderingofHeterogeneousTranslucentObjectswithArbitraryShapesYajunWang†‡§¶JiapingWang†NicolasHolzschuch‡¶KarticSubr‡¶Jun-HaiYong§BainingGuo†§†MicrosoftResearchAsia§TsinghuaUniversity‡INRIAGrenobleRhône-Alpes¶CNRSandUniversitédeGrenoble,LaboratoireJeanKuntzmanFigure1:Renderingresultsat22framesper-secondoftheStanfordThaiStatue(157Ktriangles)withoursystem.AbstractWepresentareal-timealgorithmforrenderingtranslucentobjectsofarbitraryshapes.Weapproximatethescatter-ingoflightinsidetheobjectsusingthediffusionequation,whichwesolveon-the-ﬂyusingtheGPU.Ouralgorithmisgeneralenoughtohandlearbitrarygeometry,heterogeneousmaterials,deformableobjectsandmodiﬁcationsoflighting,allinreal-time.Inapre-processingstep,wediscretizetheobjectintoaregular4-connectedstructure(QuadGraph).Duetoitsregularconnectivity,thisstructureiseasilypackedintoatextureandstoredontheGPU.Atruntime,weusetheQuadGraphstoredontheGPUtosolvethediffusionequation,inreal-time,takingintoac-countthevaryinginputconditions:Incominglight,objectmaterialandgeometry.Wehandledeformableobjects,providedthedeformationdoesnotchangethetopologicalstructureoftheobjects.1.IntroductionSubsurfacescatteringoflightisacomplexphenomenonthatoccursinmanymaterialssuchasjade,marbleandhumanskin.Itplaysanimportantroleintherealismofrenderedscenes,butunfortunatelyisalsochallengingtosimulate.Intranslucentobjects,theoutgoingradianceateachpointonthesurfacedependsonthreefactors:Incomingradianceatallpointsonthesurface,thepathfollowedbythelightinsidetheobjectaswellastheopticalpropertiesalongthispath.Accuratelyrenderingatranslucentobjectcantakesev-eralhourswithoff-linephysicalsimulation.Toacceleratetherenderingprocess,Jensenetal.[JMLH01,JB02]intro-ducedthediffusionapproximation:Assuminghomogeneousmaterialsandinﬁniteplanarboundaries,multiplescatteringeffectscanbesimulatedefﬁcientlyusingadipoleapproxi-mation.However,theconstraintsforthisdiffusionapprox-imationarenotfullysatisﬁedbymanyreal-worldobjects,thathavecomplexshapesandarecomposedofheteroge-neousscatteringmaterials.Thediffusionequation[Ish78]fullydescribessubsurfacemultiple-scatteringeffectsintranslucentobjects,includingheterogeneousmaterials.Inpractice,solvingthediffusionrequiresadiscretizedmodeloftheinteriorofthetranslucentobject.Wangetal.[WZT∗08]usedaregulargrid,thepoly-grid;thisgridhadtobebuiltmanually,andisnotsuitedforcomplexgeometry(highgenusorthinfeatures).Inthispaper,wepresenttheﬁrstmethodtosolvethedif-fusionequation,inreal-time,onobjectsofarbitraryshapeswithheterogeneousmaterials.Ourmethodisbasedona4-connectedstructure,theQuadGraph.Inapre-processingsubmittedtoEUROGRAPHICS2010.9
0
0
2

 
c
e
D
1
3

 

 
-
 
1

 

i

n
o
s
r
e
v
 
,

4
3
6
3
4
4
0
0
-
a
i
r
n

i

21316/Real-timeRenderingofHeterogeneousTranslucentObjectsstep,webuildtheQuadGraphautomaticallyastheconnec-tivitygraphofatetrahedralizationoftheobject.Ateachnode,westorethediffusioncoefﬁcientsofthematerial.ThisQuadGraphisthenstoredontheGPUinacompactway,exploitingtheregularconnectivity.Atrun-time,weusetheGPUtosolvethediffusionequationateachnodeoftheQuadGraph,inreal-time,accountingfordynamicmaterialpropertiesanddeformationstothegeometry.Ouralgorithmisrobustenoughtohandleobjectswitharbitrarygenusandarbitrarilythinfeatures(seeﬁgures1and10).Weﬁrstreviewtheliteratureontranslucentmaterialsandsubsurfacescattering(section2).Next,wepresenttheback-groundonthediffusionequation(section3).Insection4wedescribeourdatastructure,theQuadGraph,itsconstructionandthelinearizationofthediffusionequation.Practicalim-plementationdetailsincludingcompactstorageoftheQuad-GraphontheGPU,solvingtheequationandrenderingareexplainedinsection5.Insection6,wepresentexperimentalresultsandtimings.Finally,insection7,weproposedirec-tionsforfuturework.2.RelatedWorkTranslucentMaterials:Subsurfacescatteringef-fectscanbesimulatedusingMonte-Carlometh-ods[DEJ∗99,PH00,LPT05]orPhotonMapping[JC98].Thesemethodsarephysicallyaccurate,andapplytoanyobjectormaterial,butrequireconsiderablerenderingtimeforeachframe(usuallyhours).Jensenetal.[JMLH01]introducedthediffusionapproximationforhomogeneousmaterialswithaninﬁniteplanarboundary.Withthisapproximation,therenderingtimeisloweredtominutes.DachsbacherandStamminger[DS03]extendedthisworktoachievereal-timerendering,usingthesameapproximation.Severalpapershaveextendedthisworktomulti-layeredtranslucentmaterials,e.g.[DJ05],andespeciallyhumanskin[GHP∗08,DWd∗08].Arbreeetal.[AWB08]usedthelightcutsapproach[WFA∗05,WABG06]torenderobjectsofarbitraryshape,withhomogeneousmaterials.Severalpapershavepresentedalgorithmsforfastrenderingofpar-ticipatingmedia[MSM∗04,ZRL∗08,SKLU∗09],buttheyarerestrictedtoregularvolumetricshaperepresentation.Acquisition:Adifferentlineofresearchtargetstheacquisitionofmaterialproperties,fortranslucentobjects:Tongetal.[TWL∗05]forquasi-homogeneoustranslucentmaterials,Goeseleetal.[GLL∗04]foracquiringthepropertiesofanentireobject,Peersetal.[PvBM∗06]forcapturingthepropertiesofaﬂatsample.Thesemethodssamplethecompletelighttransportoperatorfortheobjectorforamaterialsample.Consequently,theystoreverylargedatasetsthatrestrictseditabilityofmaterialproperties.PrecomputedRadianceTransfer:RecentlyPrecom-putedRadianceTransfer[SKS02]hasbeenextendedFigure2:Renderingwithdiffusionequation.torendertranslucentobjectsinreal-time,throughpre-computationofthelighttransportduetosubsurfacescattering[HV04,WTL05].Xuetal.[XGL∗07]andWangetal.[WCPW∗08]precomputedthesubsurfacescatteringofaseriesof1Dhomogeneousbasisscatteringproﬁlesandlinearlycombinedthemon-the-ﬂywithvaryingweightstoachieveruntimealterationofopticalproper-ties.Thesemethodsrequireprecomputationofthelighttransport,withﬁxedmaterialpropertiesand/orgeometricalshapeoftheobject.Theyarenotsuitedforapplicationsthatrequiredynamiceditingofthematerialorthegeometry.DiffusionEquation:Multiplescatteringeffectscanbemodeledbythediffusionprocess[Ish78],describedbyaPDE–thediffusionequation–thatcanbenumericallysolved.TheDiffusionEquationwasﬁrstintroducedincom-putergraphics[Sta95]forrenderingparticipatingmedia.Haberetal.[HMBV05]extendedthisworktoobjectsofarbitraryshapes,usingembeddedboundarydiscretization.Wangetal.[WZT∗08]achievedreal-timerenderingoftranslucentobjectsontheGPU,usingaquasi-regular6-connectedstructure,thepolygrid.However,thismethodisrestrictedtoobjectswithsimplegeometry(lowgenus,nosharpfeatures).Ouralgorithmisalsobasedonthediffusionequation,al-lowingustohandleheterogeneousmaterials.However,themaindifferencewithpreviousworkisthatwediscretizetranslucentobjectsusingtetrahedrainsteadofcubicgrids.Thisallowsustohandlearbitrarygeometry,inreal-time.3.TheDiffusionEquationLightenteringatranslucentobjectinteractswiththematerialoftheobjectandisscatteredseveraltimesbeforeleavingtheobject.Ifwefocusonlyonthismultiply-scatteredcompo-nent,lightwithintheobjectisrelatedtothelightenteringtheobjectbyaPDE,thediffusionequation[Ish78,Sta95]withincomingradiancebeingtheboundarycondition(seeﬁgure2).Thesolutiontothediffusionequationexpressesthedis-tributionoflightthroughouttheobjectandlightleavingtheobjectisobtainedbycomputingtheoutgoingradianceatthesurface.Moreformally,consideranobjectΩwithboundary∂Ω,composedofahighlyscattering,non-emissive,heteroge-neousmaterial,deﬁnedbyitsabsorptioncoefﬁcientµ(x)andreducedscatteringcoefﬁcientσ′s(x)[JMLH01].Thedif-fusionequationdeﬁnestheradiantﬂuxϕ(x)withinthisob-submittedtoEUROGRAPHICS2010.9
0
0
2

 
c
e
D
1
3

 

 
-
 
1

 

i

n
o
s
r
e
v
 
,

4
3
6
3
4
4
0
0
-
a
i
r
n

i

1316/Real-timeRenderingofHeterogeneousTranslucentObjects3Figure3:QuadGraph(c)isconstructedfromthetetrahe-dralization(b)ofasurfacemeshbytakingcentroidoftetra-hedraasnodesandfacesasedges.(d)zoomsintheblueboxregionof(c).Greenline:alinkbetweeninnernodes.Redline:alinkbetweeninnernodeandsurfacenode.jectas:∇·(κ(x)∇ϕ(x))−µ(x)ϕ(x)=0,x∈Ω(1)whereκ(x)=[3µ(x)+σ′s(x)]−1.Weusethediffusivesourceboundaryconditionasde-scribedbyArbree[AWB09]basedontheRobinboundarycondition[HST∗94,SAMD95],whichrelatestheincomingradianceLionthesurfaceoftheobject∂Ωtotheradiantﬂuxasϕ(x)+2Aκ(x)∂ϕ(x)∂⃗n=41−Fdrq(x),x∈∂Ω(2)whereq(x)=∫2πLi(x,ωi)(⃗n·ωi)Ft(ωi)dωi,(3)A=(1+Fdr)/(1−Fdr)andq(x)isthediffusedincominglightatthesurfacepointx.FtandFdrarethediffuseFresneltransmittanceandFresnelreﬂectancecoefﬁcients,respec-tively[JMLH01].Botharefunctionsoftherefractionindexη.Onceradiantﬂuxϕ(x)insidetheobjectisdetermined,wecomputetheoutgoingradianceontheboundaryLo(xo,ωo)asitsderivativealongthenormal⃗natpointxo∈∂Ω[AWB09]:Lo(xo,ωo)=Ft(ωo)4π[(1+1A)ϕ(x)−41+Fdrq(x)](4)4.SolvingtheDiffusionEquationonQuadGraphWerepresenttheboundaryconditionandsolvethediffusionequationinadiscretedomain.Aregular4-connectedvolu-metricgraphcalledQuadGraphisproposedtoserveassuchadomain,whichisautomaticallyconstructedgiventhesur-facegeometryoftheobject.Inthissection,wedescribehowtoconstructtheQuadGraphandsolvethediffusionequationonit.4.1.QuadGraphTheQuadGraphisavolumetricgraph;nodesareconnectedtoeither1othernode(surfacenodes),orto4othernodesFigure4:Fourtypesoftetrahedron(C0−3)with0-3out-sideface(s).Outsidefaces,relyonthevolumeboundary,areﬁlledwithsolidcolor.C2/C3tetrahedraaresplitbyaddinganewvertexandfouredgesshowninblue.SplittingaC2tetrahedronresultsintwoC0tetrahedraandtwoC1tetrahe-dra.SplittingaC3tetrahedronresultsinoneC0tetrahedraandthreeC1tetrahedra.(innernodes).Surfacenodes(N∂Ω)arepositionedatthesur-faceoftheobject,andtheysampletheincomingradianceandrepresenttheboundarycondition.Innernodes(NΩ),dis-tributedinsidethevolume,samplevolumetricopticalprop-ertiesandrepresentthesolutionofthediffusionequation,radiantﬂux.Theentiregraph(NΩ+)istheunionofsurfacenodesandinnernodes,NΩ∪N∂Ω.Asshowninﬁgure3,tobuildtheQuadGraph,westartwithanautomatictetrahedralizationofthetrianglemesh[ACSYD05,LS07].Afterthetetrahedralization,agiventetrahedroncanhavefrom0to3ofitsfacesontheboundaryoftheobject(weassumethattherearenoisolatedtetrahe-dra).Wesplitalltetrahedrawith2or3facesontheboundarybyaddinganewvertexattheircentroidsasshowninﬁgure4,sothattheresultingtetrahedralmeshonlycontainstetrahedrawith0or1facesontheboundary.WethenbuildtheQuadGraphastheconnectivitygraphofthistetrahedralmeshasillustratedinﬁgure5:eachtetra-hedronisconvertedintoagraphnode,locatedatitscen-troid.Iftwotetrahedrashareagivenface,thentheircen-troidsareconnectedinthegraph.Tetrahedrawithonefaceontheboundaryoftheobjectareconvertedintoasetoftwoconnectednodes:aninnernodeandasurfacenode.Thegeo-metricpositionofthesurfacenodeisdeterminedastheclos-estintersectionbetweenthesurfacemeshandtheraylinkingittotheinnernode.Figure3showsanexampleoftheQuad-Graph.OncewehavebuilttheinitialQuadGraph,wereﬁneFigure5:ConstructionQuadGraphfromtetrahedronmesh.Left:aC0tetrahedronisconvertedtoaninnernode(Green).Right:aC1tetrahedronisconvertedtoaninnernode(Green)andasurfacenode(Red).submittedtoEUROGRAPHICS2010.9
0
0
2

 
c
e
D
1
3

 

 
-
 
1

 

i

n
o
s
r
e
v
 
,

4
3
6
3
4
4
0
0
-
a
i
r
n

i

41316/Real-timeRenderingofHeterogeneousTranslucentObjectsthepositionoftheinnernodesforevendistributionbyap-plyingreaction-diffusion[Tur91]tothe3Dpoints.OurmethodisbasedonthetetrahedralizationmethodofAlliezetal.[ACSYD05],whichproducesnearlyequilat-eraltetrahedraofregularsize.Ittakesasingleparameter,K,whichcontrolshowmuchlargertetrahedrainsidetheobjectare,comparedtothosenearthesurface.4.2.DiscretizedDiffusionEquationOncewehavebuilttheQuadGraph{NΩ,N∂Ω},wedis-cretizetheDiffusionEquation(Equations1and2)intolin-earequationsusingaFiniteDifferenceMethod(FDM),asin[Sta95]:4∑j=11d2ijκ(nj)ϕ(nj)−(wκ(ni)+µ(ni))ϕ(ni)=0(5)ϕ(ns)+2Aκ(ns)ϕ(ns)−ϕ(nk)dsk=41−Fdrq(ns)(6)ni∈NΩns∈N∂ΩThesuminEquation5isoverthefournodesnjconnectedtothenodeni.InEquation6,nkisthesingleinnernodeconnectedtothesurfacenodens.Inequation5,weusew=∑4j=11/d2ij,andd∗∗denotesthedistancebetweentwonodes,orthelengthofthegraphedgeconnectingthem.Wesampleopticalproperties(κandµ)atthegraphnodes.q(ns)isthediffusedincominglightforeachsurfacenode.WeapproximatethecoefﬁcientsofLaplacianoperatorwiththeinversedistance(α=−2)[Tau95].Oncewehavesolvedthediffusionequationdescribedinsection4.3,weﬁndtheoutgoingradianceLo(ns,ωo)accordingtotheradi-antﬂuxofthecorrespondingsurfacenodeϕ(ns):Lo(ns,ωo)=Ft(ωo)(ϕ(ns)−2q(ns))2π(1+Fdr),ns∈N∂Ω(7)4.3.SolvingthelinearizedequationWesolvethelinearizedequations(5,6)ontheQuad-Graphusingtherelaxationschemeasin[Sta95,WZT∗08]:westartbyinitializingthevalueoftheradiantﬂuxateachnodetoϕ0(n)(e.g.zero),anditeratethefollowingstepsuntilreachauserdeﬁnednumberofiterations.ϕt+1(ni)=∑4j=1κ(nj)ϕt(nj)/d2ijwκ(ni)+µ(ni)ni∈NΩ(8)ϕt+1(ns)=2Aκ(ns)ϕt(nk)+dsk4q(ns)1+Fdr2Aκ(ns)+dskns∈N∂Ω(9)Tospeed-uptheconvergence,weuseamulti-resolutionscheme,similarto[WZT∗08].WedesignmultiplelevelshoftheQuadGraph,{NhΩ,Nh∂Ω}.Eachlevelisbuilt,indepen-dently,asatetrahedralizationofasimplerversionofthesur-facemesh,withthenumberofsurfacepointsdecreasingbyafactoroffourbetweentwohierarchicallevels.NotethattheﬁnestlevelusestheexactfullQuadGraph,sonoapprox-imationisintroducedbyusingthemulti-resolutionschemeifconvergenceisfulﬁlled.Afterwehavethesemulti-resolutionrepresentationsoftheobject,westartbysolvingatthecoarsestlevel,h=0,usethissolutionasthestartingpointforsolvingatthenextlevel,anditerate.Thecoarselevelgeneratesablurredsolu-tion(ﬁgure14b)withcorrectoveralldistributionandservesastheinitializationfortheﬁnerlevel.Speciﬁcally,initialra-diantﬂuxatthelevelh+1issampledfromthesolutionofbnearbynodesonlevelh,withinterpolationweightspropor-tionaltothesquareoftheinversedistance[She68]:ϕ(nh+1x)=b∑y=1wxyϕ(nhy)(10)wxy=w′xy∑by=1w′xyw′xy=(cid:13)(cid:13)(cid:13)nh+1x−nhy(cid:13)(cid:13)(cid:13)−2.Wetreatsurfacenodesandinnernodesindependentlyinthishierarchicalsamplingprocess.Weusedb=4forsurfacenodes,andb=8forinnernodes,i.e.eachsurfacenodeataﬁnerleveliscomputedbyinterpolatingthevaluesfrom4surfacenodesatthecoarserlevel.TheinterpolationweightsbetweenthedifferentlevelsoftheQuadGraph(wxy)arepre-computedaspartofthepre-processingstep.Theyareinde-pendentoftheopticalpropertiesofthematerial,andinvari-anttosmoothshapedeformation.5.GPUImplementationandRenderingOuralgorithmsolvesthediffusionequationinsidethetranslucentobjectateachframe,withoutprecomputationofthelighttransport,thusallowingfordynamicillumina-tion,opticalpropertiesandshapedeformations.WestoretheQuadGraphintexturesontheGPUasapre-processingstep.Ateachframe,weﬁrstsampletheincomingilluminationus-ingshadowmappingonthesurfaceofthetranslucentobject,thensolvetheDiffusionEquationontheGPUusingitasaboundarycondition.5.1.StorageWestoretheQuadGraphitselfontheGPUusing2Dtextures(seeﬁgure6).EachnodeoftheQuadGraphcorrespondstoFigure6:Texturesforencodingparameters.Upperrow(a):16-bitsﬂoattexturesthatencodevariables.Bottomrow(b):32-bitsintegertexturesthatencodeconstants.submittedtoEUROGRAPHICS2010.9
0
0
2

 
c
e
D
1
3

 

 
-
 
1

 

i

n
o
s
r
e
v
 
,

4
3
6
3
4
4
0
0
-
a
i
r
n

i

1316/Real-timeRenderingofHeterogeneousTranslucentObjects5Figure7:Texturepacking.Topologicallynearbynodes(red)arepackedinthesametextureblock(blue).asingleindex(u,v),applyingtoallthetextures.Thetex-turesaresubdividedalongonedimension(v)betweensur-facenodesandinnernodes,sothatthenodetypeiseasilydeterminedbyasimpletest.Connectivityisencodedusingtwo32-bitsRGBAinte-gertextures,encodingforeachnodetheindicesofthecon-nectednodes(twochannelsperindex).Wealsouse2RGBAtexturesof16-bitsﬂoating-pointnumberstoencodethege-ometricpositionofeachnodeanditsopticalproperties(κ(n),µ(n)).Weuses16-bitsﬂoating-pointinsteadof32-bitsinanysituationiftheprecisionissufﬁcient,whichre-ducedtheamountofvideomemorytobeaccessed.Aseparatesetoftexturesencodesthehierarchicallev-elsoftheQuadGraph:32-bitsRGBAintegertexturestoen-codetheconnectivitybetweenthedifferentlevels,and16-bitsﬂoatingpointnumberstoencodetheweightsusedforsamplingresultsonthenexthierarchicallevel.TheentireGPUmemorycostforouralgorithmisroughly20MBformodelswithroughly100Kvertices(seeTable1).AcrucialpointforapracticalGPUimplementationisim-provingthecachehitrateofgraphicsmemoryaccessontheGPU.Wepacktogethernearbynodes(seeﬁgure7):thetex-tureissubdividedintomultipleblocksofr×rtexels,andeachblockisﬁlledwithasetofconnectednodes.Weuseagreedyapproachforﬁllingthetexture:startingfromaseednode,wedoabreadth-ﬁrsttraversalonthegraph,andas-signthemtotheblockuntilwehavereachedr2nodes.Thenextnodeisthenusedasanewseednode,toﬁllthenextblock.Whenthetraversalﬁndsanalreadyassignednode,itdoesnotassignittoanotherblock,butitstillvisitsallthenodesthatareconnectedtoit.Weiteratethisprocessuntilallgraphnodeshavebeenassigned.Inourexperiments,webindtextureϕt+1toaFBOastherendertargetrenderarectanglecoveringthetexelscontainingthenodestobeupdated,withfragmentshader.foreachfragment:fetchindicesofneighbouringnodesnjfetchpositionsandopticalpropertiesforni,njcomputeLaplaceweightsbasedondistancebetweennodescomputevalueforϕt+1basedonEq.9or8.endforFigure8:Pseudocodeforasingleiterationuser=32.Suchachosenisbasedonthetetrahedralizationdensityofthegeometrymodelsusedinourexperiments.Forpackingtogetherinnernodes,weusetheconnectivityinsidethegraph.Forsurfacenodes,weuseproximityonthesurface.Inourexperiments,thislocalizedstorageoftheQuadGraphintexturesresultsina30%to60%speedupoverrandomstorage.5.2.SolvingtheEquationWesolvethediffusionequationateachframe,recursivelyoneachhierarchicalleveloftheQuadGraph,startingwiththecoarsestlevel(h=0)(seeﬁgure9forapseudo-codeofouralgorithm).Foreachlevel,westartbyevaluatingtheincomingdif-fuseilluminationonthesurface,includingshadows(usingshadowmapping)andmultiplywithFresneltransmissioncoefﬁcient.Incominglightisstoredina16-bitsﬂoatingpointtexture,foreachsurfacenodeoftheQuadGraph.Wethensolvethediffusionequationiteratively,usingtwoauxiliarytexturestostoretheradiantﬂux,beforeandafterthecurrentiteration(seeﬁgure8forthepseudo-codeofasingleiteration).Aftercomputinganiteration,wetestforconvergence.Ifwehaveconvergedatthishierarchicallevel,wemoveontothenextlevel,usingtheresultsatthislevelasastartingpoint,afterre-sampling.Otherwise,weswapthetwotexturesandcomputethenextiteration.5.3.DisplayingResultsWedonotdisplaythegeometryoftheoriginalobject;in-stead,webuildasurfaceϒthatmapsdirectlytotheQuad-Graph,bytriangulatingallitssurfacenodes.OncewehavecomputedthesolutionoftheDiffusionEquation,weuseittocomputetheoutgoingradianceLoforallsurfacenodesnsusingEq.7,thenwerenderϒ.6.ExperimentalResultsWehaveimplementedouralgorithmonanIntelCore2Duo2.13GHzCPU,with2GBmemoryandanNVIDIAGeforce8800GTXGPUwith768MBgraphicsmemory.WeusedGLSLtoimplementthealgorithmontheGPU.Ateachnewframe:foreachmulti-resolutionlevelhcomputeincominglightq(ns)onallsurfacenodesinitializeϕ(n)bysamplingfromlevelh−1whilenotconvergedupdateϕ(ns)forallsurfacenodes(Eq.9)updateϕ(ni)forallinnernodes(Eq.8)endwhileendforcomputeradianceLo(ns,ωs)forallsurfacenodes(Eq.7)rendertheobjectsurfaceusingLoFigure9:Pseudocodeforourlinearsolver.submittedtoEUROGRAPHICS2010.9
0
0
2

 
c
e
D
1
3

 

 
-
 
1

 

i

n
o
s
r
e
v
 
,

4
3
6
3
4
4
0
0
-
a
i
r
n

i

61316/Real-timeRenderingofHeterogeneousTranslucentObjectsSceneFig.QuadGraphMemPrepIterFPSNsNiKL(MB)(min)Thai1157k369k1435244021.8Gargoyle10a62k139k0.5318105046.4Topmod10b121k260k0.2336154029.4Buddha10c66k120k0.531793057.6Fertility10d82k182k0.3325125034.4Twirl10e82k226k0.1327166022.1Heptoroid10f82k178k0.2224118021.6Lucy10g150k363k0.2433204021.0Table1:Statisticsoftestscenes:NsandNiarethenumberofsurfaceandinnernodes,respectively,oftheQuadGraphattheﬁnestlevel.Lisnumberofmulti-resolutionlevels;Memisthetotalsizeoftexturesoveralllevels;Prepistheprepro-cessingtimeincludingtetrahedralization,QuadGraphcon-structionandtexturepacking;Iteristhenumberofiterationsofthesolverateachlevel.Allimagesarerenderedat1024×1024with2×2super-samplingforantialiasing.WeaddedsurfaceshadingtoallresultsusingtheCook-TorranceBRDFmodel[CT81].Wehavetestedouralgorithmonseveralcomplexobjects,withsharpgeometricfeatures(seeﬁgures1and10).RenderingstatisticsforallourmodelscanbefoundinTable1.6.1.TestScenesFigure1showstherenderingresultsoftheStanfordThaimodelwiththecolorfulagatematerial.Oursystemgeneratesthesubsurfaceeffectsduetothehighlyheterogeneousma-terial.Complexsurfacedetailsandsmallgeometryfeatures,suchasthetrunkinthemiddleandclawinthebottom,arewellpreservedandexhibitrichvisualeffectswithdifferentlightingconditions.Pleaserefertotheaccompanyingvideoforanimatedsequences.Figure10showsrenderingresultswithvariousobjects.Objectswithhighgenus(b,c,f),highcurvature(b,e,f)andthinfeatures(a,c,e,g)arewellhandled.Wecanalsohan-dleanykindofmaterialandheterogeneities,suchaswax(a,c,e,f),jade(b),andmarble(d,g).Ouralgorithmproducesconvincingresultsinallcases,whichdemonstratesvariousvisualeffectontranslucentmaterials,suchascolorbleed-ing(a,d,e,g),back-lighting(b,c,d,f)andblurringofthegeometryfeatures(a,c,g).6.2.ComputationtimeFigure12showsthecomputationtime(inms)forseveraltestscenes,asafunctionofthenumberoftetrahedra.Forthreeofourmodels,theStanfordBunny,thedouble-holedonut(ﬁgure3)andtheFertilitystatue(ﬁgure10d),wehavesev-eraltetrahedralization:theyareplottedaslines.Othermod-els,forwhichwehaveasingletetrahedralization,appearas 0 50 100 150 0 250000 500000 750000 1e+06Rendering time (ms)Number of tetrahedraBunnyDouble hole DonutFertilityOther modelsLucyThai statueBudhaGargoyleHeptoroidTwirlTopmod ballFigure12:Computationtime,inms,asafunctionofthenumberoftetrahedra.Modelswithseveraltetrahedraliza-tionsareplottedasstraightlines(Bunny,Donut,Fertility).Othermodelsappearaspointsinthegraph.Formostofthemodels,therenderingtimevarieslinearlywithrespecttothenumberoftetrahedra.Thetwooutliers(TwirlandHep-toroid)havethinnerfeaturesandrequiremoreiterations.pointsonthegraph.Formostofthemodels,therenderingtimeappearstovarylinearlywithrespecttothenumberoftetrahedra.ThetwooutliersaretheTwirl(ﬁgure10e)andtheHeptoroid(ﬁgure10f).Thesetwomodelshavethinnerfeatures,andrequiremoreiterationsforconvergence.6.3.ComparisonwithGroundTruthTostudytheeffectoftheparameterKontheresultsofouralgorithm,wecomparedresultingimagesfordifferentval-uesofKagainstagroundtruthreferenceimagethatwascomputedusingphotonmapping.Figure11tabulatestheseresultsforfourdifferentvaluesofKandshowsdifferenceimagestothereferenceandscanlineplots.AlowervalueforKconstrainsthesizesofsurfaceandinternaltetrahedratovaryless.WhilereducingKincreasesthenumberoftetra-hedraandhencecomputationtime,itresultsinrenderedim-agesthatareclosertothegroundtruth.However,eventheincreasedqualityimagesrenderatinteractiverates(8fps).ByincreasingK,wecanfurtherincreasetheefﬁciencyattheappropriatecompromiseofﬁdelitytothegroundtruth.Theplotsintheimageshowourresult(blue)acrosstwodif-ferentscanlinescomparedagainstthegroundtruth(black).ForK=0.1,thebluecurveisquiteclosetothereferenceblackcurve.Toobtainintuitionaboutthe“sweetspot”,orthevalueofKatwhichweachieveasuitabletrade-offbetweenqual-ityandefﬁciency,weplottedtherelativerootmeansquared(RMS)errorofourresult(incomparisonwiththegroundtruth)againstKformultiplemodels(seeﬁgure13).ThisplotrevealsthatevenatK=1.0theRMSerrorislessthansubmittedtoEUROGRAPHICS2010.9
0
0
2

 
c
e
D
1
3

 

 
-
 
1

 

i

n
o
s
r
e
v
 
,

4
3
6
3
4
4
0
0
-
a
i
r
n

i

1316/Real-timeRenderingofHeterogeneousTranslucentObjects7Figure10:Wehavetestedouralgorithmonseveralcomplexobjects,includingobjectswithhighgenus(b,c,f),highcurvature(b,e,f)andwithsharpgeometricfeatures(a,c,e,g).GroundTruthK=1,N=141kK=0.5,N=246kK=0.3,N=468kK=0.1,N=973k21ms35ms68ms122msImageDifferencey=300y=400Figure11:Comparisonbetweengroundtruthandourmethod,fordifferentvaluesofK[ACSYD05].Forthisﬁgure,wecom-putedonlythetranslucencyeffects,withnoreﬂectionsonthesurface,toensureafaircomparison.Firstrow:theactualpicturescomputed.Secondrow:pixel-by-pixeldifferencewithreferenceimage(topleft).Thirdandfourthrow:1Dplotofpixelvaluesalongascanline.Thepositionsofthetwoscanlinesappearontheleftmostimageofthesecondrow.Thevaluesforthereferenceimageareinblack,ourresultsareinblue.ForK=0.1,ourresultsarequiteclosetothereference.NotethatforallvaluesofK,ouralgorithmﬁndsthesalientfeaturesofillumination,resultinginagoodvisualquality.submittedtoEUROGRAPHICS2010.9
0
0
2

 
c
e
D
1
3

 

 
-
 
1

 

i

n
o
s
r
e
v
 
,

4
3
6
3
4
4
0
0
-
a
i
r
n

i

81316/Real-timeRenderingofHeterogeneousTranslucentObjects 0 0.02 0.04 0.06 0.08 0 0.25 0.5 0.75 1RMS errorKBunnyDoublehole donutFertilityFigure13:RMSerroroftheimagescomputedwithoural-gorithm(comparedtoareferenceimage),asafunctionofK.10%.Theplotalsoshowsthatwecanachieveerrorsaslowas2%atslightcostsinefﬁciency.Finally,weveriﬁedthecontributionofthemulti-resolutionschemetoconvergenceratebyplottingrelativeerrorsagainstexecutiontime,withandwithoutthemulti-resolutionsolver.Figure14showsthattheuseofamulti-resolutionsolversigniﬁcantlyincreasesconvergencerate.6.4.ShapeDeformationandMaterialEditingOursystemalsosupportsruntimeshapedeformationasshowninﬁgure15andtheaccompanyingvideo.Anyde-formationalgorithmthatisabletoapplyadeformationﬁeldtotheobjectvolume(e.g.[SP86,JSW05,LLCO08]),canbeappliedtodrivethedeformationofQuadGraph.Defor-mationdescribedhereisonlychangingongeometryshape,thematerialchangingduetodeformation(e.g.condensedbysqueezing)isnotconsidered.RuntimeeditingoftheopticalFigure14:Theplot(a)comparesrelativeerrorachievedwith(blue)andwithout(red)themulti-resolutionsolver.(b)thesolutionofthecoarselevel.(c)thesolutionoftheﬁnerlevelwith(b)asinitialization.Figure15:Ouralgorithmcanhandledeformingobjects,aslongasthedeformationdoesnotbreaktheunderlyingtetra-hedralization.Figure16:Ouralgorithmcanhandlechangingtheopticalpropertiesatruntime.propertiesisdemonstratedinﬁgure16(andaccompanyingvideo)Wecanonlyhandledeformationsthatmaintaintheunder-lyingtetrahedralization.Deformationsarethereforelimitedinscopeandamplitude:wecannotchangethetopologyoftheobject.Althoughweonlyshowsimplematerialopticaleditingoperations,oursystemisﬂexibleenoughtoworkwithcom-plicatededitingoperationssincetherenderingtakestheop-ticalpropertyvolumeasinputdirectly.6.5.DiscussionReal-timesolver:ThemainadvantageofourQuadGraphalgorithmisitsabilitytosolvethediffusionequationinreal-time.Sincetherearenoprecomputationsbesidesthetetrahe-dralizationoftheinputgeometry,ouralgorithmcanhandledynamicallychangingtheincominglighting,materialprop-erties,andevenlimiteddeformationsofthegeometry,with-outtheneedforprecomputingthelighttransport.submittedtoEUROGRAPHICS2010.9
0
0
2

 
c
e
D
1
3

 

 
-
 
1

 

i

n
o
s
r
e
v
 
,

4
3
6
3
4
4
0
0
-
a
i
r
n

i

1316/Real-timeRenderingofHeterogeneousTranslucentObjects9Qualityvs.efﬁciency:TheparameterKcanbeusedtotrade-offaccuracyforefﬁciency:largevaluesofKresultinasmallernumberofinsidetetrahedra,thusmakingtheal-gorithmrunfaster,attheexpenseofaccuracy.SmallvaluesofKgiveresultsthataremoreaccurate,attheexpenseofrenderingtime.Buteveninitsfast,low-qualityversion,ouralgorithmidentiﬁesthesalientlightingfeatures,resultinginagoodvisualquality,anditmaintainsRMSerrorunder10%(seeﬁgure13).Sampling:Justasanydiscretizationscheme,ourQuad-Graphdomainrequiresadequatesamplingforcapturinghigh-frequencyeffects.Thatis,thetetrahedralizationneedstobedenseenoughtocapturevariationsin(1)incidentil-luminationatthesurfaceaswellas(2)theopticalproper-tiesofheterogenousmaterials.Theformerislessofaprob-lemsincemultiplescatteringresultsinadecimationofhigh-frequenciesintheincidentsurfaceradiance.Thelatterprob-lemlimitstherangeofeditablematerialsthatcanbefaith-fullyrenderedwithoutre-tetrahedralization.Arbitraryshape:Thedipoleapproximation[JMLH01]breaksdownatpointswithhighcurvature,whilethepoly-gridmethod[WZT∗08]isunabletohandlethinfeaturesorgeometrieswithhighgenuses.Sinceourdiscretizationisbasedontheinputgeometry,ouralgorithmisrobusttovari-ationsinthesefeatures.Discretizationmethod:OuralgorithmusesaFiniteDif-ferenceMethodfordiscretizingthediffusionequation.OtheralgorithmshaveusedaFiniteElementMethodsin-stead[AWB08,AWB09].Thelatterismoreaccurate,buttheformermapswelltotheGPU,allowingustobettertakead-vantageofthecomputingpowerofthisarchitecture.7.ConclusionandFutureWorkInthispaper,weintroducedanalgorithmforreal-timeren-deringoftranslucentobjects,ofarbitraryshape,withhetero-geneousmaterials.Ouralgorithmisrobustenoughtohandleobjectswitharbitrarygenusandﬁnesharpfeatures.Sinceallilluminationcomputationsareconductedinreal-time,wecanhandledeformableobjectsaswellasdynamicchangesintheopticalpropertiesandlightingconditions.Ouralgo-rithmisbasedonasimple4-connectedgraph,theQuad-Graph,builtautomaticallyfromatetrahedralizationofthetrianglemeshdeﬁningthesurfaceoftheobject.Asmostexistingalgorithmsforapproximatingsubsurfacescattering,ouralgorithmisrestrictedtothemultiplescatter-ingcomponentofsubsurfacescattering.Whilethiscompo-nentisusuallythemostvisibleforopticallydensematerials,recentresearch[DLR∗09,WZHB09]haveshownthatlow-orderscatteringeffectscanbequiteimpressiveinsomecir-cumstances.Infuturework,wewillinvestigatecomputationoflow-orderscatteringeffectsforincreasedrealism.Althoughouralgorithmhandlesdeformableobjects,de-formationsarelimited,inthesensethattheunderlyingtetrahedralizationmustremainvalid.Wecannotchangethetopologyoftheobject,orbreakitintopieces.Futureworkwillincludehandlingarbitrarydeformationsoftheobject.Finally,wewouldliketoextendouralgorithmtode-couplethelocalscatteringandhandleitbytexturespaceﬁlteringasin[dLE07],forﬁnedetailedmaterialvariation.Acknowledgements:WearegratefultoAdamArbree,BruceWalterandKavitaBalaforsharingtheirlatestworkonthenewdiffusionequationformulaandthehelpfuldis-cussionsonitsaccuracyandrobustness.WethankShuangZhaoandYueDongfortheirsourcecode,asreference,fortheforwarddiffusionequationandphoto-tracing.WealsothankJean-ClaudePaulforthehelpfuldiscussions.TheauthorsfromTsinghuaUniversityweresupportedbytheNationalScienceFoundationofChina(60625202,60911130368)andChinese863Program(2007AA040401).ThisworkwasfundedinpartbyANR(ANR-07-BLAN-0331"HFIBMR").YajunWangissupportedbyanINRIAinternshipgrant.Geometrymodelcredits:Gargoyle,fertilityandtwirlinﬁgure10(a,d,e)aredownloadedfromtheAIM@SHAPEShapeRepository(http://shapes.aim-at-shape.net/).ThaiStatue,BuddhaandLucyinﬁgure1andﬁgure10(c,g)aredownloadedfromtheStanford3DScanningRepository(http://graphics.stanford.edu/data/3Dscanrep/).HeptagonalToroidinﬁgure10(f)isgeneratedwithCarloSéquin’ssculpturegenerator(http://www.eecs.berkeley.edu/∼sequin/SFF/spec.heptoroid.html).TopmodBallinﬁgure10(b)isobtainedfromDavidMorrisandisoriginallycreatedbyTorolfSauermann(http://www.evolution-of-genius.de/).References[ACSYD05]ALLIEZP.,COHEN-STEINERD.,YVINECM.,DESBRUNM.:Variationaltetrahedralmeshing.ACMTrans.Graph.24,3(2005),617–625.[AWB08]ARBREEA.,WALTERB.,BALAK.:Single-passscal-ablesubsurfacerenderingwithlightcuts.ComputerGraphicsFo-rum(Eurographics’08)27,2(2008),507–516.[AWB09]ARBREEA.,WALTERB.,BALAK.:Diffusionformulationforheterogeneoussubsurfacescattering.Cor-nellComputerScienceTechnicalReport,CornellUniversity(http://hdl.handle.net/1813/14199)(Dec2009).[CT81]COOKR.L.,TORRANCEK.E.:Areﬂectancemodelforcomputergraphics.ComputerGraphics(SIGGRAPH’81)15,3(1981),307–316.[DEJ∗99]DORSEYJ.,EDELMANA.,JENSENH.W.,LEGAKISJ.,PEDERSENH.K.:Modelingandrenderingofweatheredstone.InProc.ACMSIGGRAPH(1999),pp.225–234.[DJ05]DONNERC.,JENSENH.W.:Lightdiffusioninmulti-layeredtranslucentmaterials.ACMTrans.Graph.24,3(2005),1032–1039.[dLE07]D’EONE.,LUEBKED.,ENDERTONE.:EfﬁcientRen-deringofHumanSkin.InRenderingTechniques(EurographicsSymposiumonRendering)(June2007),pp.147–157.submittedtoEUROGRAPHICS2010.9
0
0
2

 
c
e
D
1
3

 

 
-
 
1

 

i

n
o
s
r
e
v
 
,

4
3
6
3
4
4
0
0
-
a
i
r
n

i

101316/Real-timeRenderingofHeterogeneousTranslucentObjects[DLR∗09]DONNERC.,LAWRENCEJ.,RAMAMOORTHIR.,HACHISUKAT.,JENSENH.W.,NAYARS.:Anempiricalbssrdfmodel.ACMTrans.Graph.28,3(2009),1–10.[DS03]DACHSBACHERC.,STAMMINGERM.:Translucentshadowmaps.InRenderingTechniques(EurographicsWorkshoponRendering)(2003),pp.197–201.[DWd∗08]DONNERC.,WEYRICHT.,D’EONE.,RAMAMOOR-THIR.,RUSINKIEWICZS.:Alayered,heterogeneousreﬂectancemodelforacquiringandrenderinghumanskin.ACMTrans.Graph.27,5(2008),1–12.[GHP∗08]GHOSHA.,HAWKINST.,PEERSP.,FREDERIKSENS.,DEBEVECP.:Practicalmodelingandacquisitionoflayeredfacialreﬂectance.ACMTrans.Graph.27,5(2008),1–10.[GLL∗04]GOESELEM.,LENSCHH.P.A.,LANGJ.,FUCHSC.,SEIDELH.-P.:DISCO:acquisitionoftranslucentobjects.ACMTrans.Graph.23,3(2004),835–844.[HMBV05]HABERT.,MERTENST.,BEKAERTP.,VANREETHF.:Acomputationalapproachtosimulatelightdiffusioninar-bitrarilyshapedobjects.InProc.GraphicsInterface(2005),pp.79–85.[HST∗94]HASKELLR.C.,SVAASANDL.O.,TSAYT.-T.,FENGT.-C.,MCADAMSM.S.,TROMBERGB.J.:Boundaryconditionsforthediffusionequationinradiativetransfer.J.Opt.Soc.Am.A11,10(1994),2727–2741.[HV04]HAOX.,VARSHNEYA.:Real-timerenderingoftranslu-centmeshes.ACMTrans.Graph.23,2(2004),120–142.[Ish78]ISHIMARUA.:WavePropagationandScatteringinRan-domMedia.AcademicPress,1978.[JB02]JENSENH.W.,BUHLERJ.:Arapidhierarchicalrender-ingtechniquefortranslucentmaterials.ACMTrans.Graph.21,3(2002),576–581.[JC98]JENSENH.W.,CHRISTENSENP.:Efﬁcientsimulationoflighttransportinsceneswithparticipatingmediausingphotonmaps.InProc.ACMSIGGRAPH(1998),pp.311–320.[JMLH01]JENSENH.W.,MARSCHNERS.R.,LEVOYM.,HANRAHANP.:Apracticalmodelforsubsurfacelighttransport.InProc.ACMSIGGRAPH(2001),pp.511–518.[JSW05]JUT.,SCHAEFERS.,WARRENJ.:Meanvaluecoor-dinatesforclosedtriangularmeshes.ACMTrans.Graph.24,3(2005),561–566.[LLCO08]LIPMANY.,LEVIND.,COHEN-ORD.:Greencoor-dinates.ACMTrans.Graph.27,3(2008),1–10.[LPT05]LIH.,PELLACINIF.,TORRANCEK.E.:Ahybridmontecarlomethodforaccurateandefﬁcientsubsurfacescat-tering.InRenderingTechniques(EurographicsSymposiumonRendering)(June2005),pp.283–290.[LS07]LABELLEF.,SHEWCHUKJ.R.:Isosurfacestufﬁng:fasttetrahedralmesheswithgooddihedralangles.ACMTrans.Graph.26,3(2007),57.[MSM∗04]MAXN.L.,SCHUSSMANG.,MIYAZAKIR.,IWASAKIK.,NISHITAT.:Diffusionandmultipleanisotropicscatteringforglobalilluminationinclouds.JournalofWSCG12,1-3(February2004).[PH00]PHARRM.,HANRAHANP.M.:MonteCarloevaluationofnon-linearscatteringequationsforsubsurfacereﬂection.InProc.ACMSIGGRAPH(2000),pp.275–286.[PvBM∗06]PEERSP.,VOMBERGEK.,MATUSIKW.,RA-MAMOORTHIR.,LAWRENCEJ.,RUSINKIEWICZS.,DUTRÉP.:Acompactfactoredrepresentationofheterogeneoussubsurfacescattering.ACMTrans.Graph.25,3(2006),746–753.[SAMD95]SCHWEIGERM.,ARRIDGES.,M.H.,D.T.D.:Theﬁniteelementmethodforthepropagationoflightinscatteringmedia:Boundaryandsourceconditions.MedicalPhysics22,11(1995),1779–1792.[She68]SHEPARDD.:Atwo-dimensionalinterpolationfunctionforirregularly-spaceddata.InACMNationalConference(NewYork,NY,USA,1968),ACM,pp.517–524.[SKLU∗09]SZIRMAY-KALOSL.,LIKTORG.,UMENHOFFERT.,TÓTHB.,KUMARS.,LUPTONG.:Parallelsolutiontotheradiativetransport.ParallelGraphicsandVisualizationSympo-sium2009(2009).[SKS02]SLOANP.-P.,KAUTZJ.,SNYDERJ.:Precomputedradiancetransferforreal-timerenderingindynamic,low-frequencylightingenvironments.ACMTrans.Graph.21,3(2002),527–536.[SP86]SEDERBERGT.W.,PARRYS.R.:Free-formdeformationofsolidgeometricmodels.SIGGRAPHComput.Graph.20,4(1986),151–160.[Sta95]STAMJ.:Multiplescatteringasadiffusionprocess.InEurographicsWorkshoponRendering(June1995),pp.41–50.[Tau95]TAUBING.:Asignalprocessingapproachtofairsurfacedesign.InProc.ACMSIGGRAPH(1995),pp.351–358.[Tur91]TURKG.:Generatingtexturesonarbitrarysurfacesusingreaction-diffusion.ComputerGraphics25,4(1991),289–298.[TWL∗05]TONGX.,WANGJ.,LINS.,GUOB.,SHUMH.-Y.:Modelingandrenderingofquasi-homogeneousmaterials.ACMTrans.Graph.24,3(2005),1054–1061.[WABG06]WALTERB.,ARBREEA.,BALAK.,GREENBERGD.P.:Multidimensionallightcuts.ACMTrans.Graph.25,3(2006),1081–1088.[WCPW∗08]WANGR.,CHESLACK-POSTAVAE.,WANGR.,LUEBKED.,CHENQ.,HUAW.,PENGQ.,BAOH.:Real-timeeditingandrelightingofhomogeneoustranslucentmaterials.TheVisualComputerJournal(ProceedingsofComputerGraphicsIn-ternational2008)24,7-9(2008),565–575.[WFA∗05]WALTERB.,FERNANDEZS.,ARBREEA.,BALAK.,DONIKIANM.,GREENBERGD.P.:Lightcuts:ascalableap-proachtoillumination.ACMTrans.Graph.24,3(2005).[WTL05]WANGR.,TRANJ.,LUEBKED.:All-frequencyinter-activerelightingoftranslucentobjectswithsingleandmultiplescattering.ACMTrans.Graph.24,3(2005),1202–1207.[WZHB09]WALTERB.,ZHAOS.,HOLZSCHUCHN.,BALAK.:Singlescatteringinrefractivemediawithtrianglemeshbound-aries.ACMTrans.Graph.28,3(2009).[WZT∗08]WANGJ.,ZHAOS.,TONGX.,LINS.,LINZ.,DONGY.,GUOB.,SHUMH.-Y.:Modelingandrenderingofhetero-geneoustranslucentmaterialsusingthediffusionequation.ACMTrans.Graph.27,9(2008).[XGL∗07]XUK.,GAOY.,LIY.,JUT.,HUS.-M.:Real-timehomogenoustranslucentmaterialediting.ComputerGraphicsForum26,3(2007),545–552.[ZRL∗08]ZHOUK.,RENZ.,LINS.,BAOH.,GUOB.,SHUMH.-Y.:Real-timesmokerenderingusingcompensatedraymarching.ACMTrans.Graph.27,3(2008),36.submittedtoEUROGRAPHICS2010.