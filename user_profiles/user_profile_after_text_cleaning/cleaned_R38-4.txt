characterize record li r j wang research j abstract develop new map membership use trace group look multiple participate campaign apply technique trace web mail service trace successfully present new size behavior also con researcher derive different one fifteen one introduction recent become widespread problem compromise machine generally refer set control single entity call use channel control operate multiple nefarious use mount attack steal user generate click fraud nine send sixteen anecdotal evidence drive force economics common strategy monetize send de liberally include traditional advertisement message well message message unwanted message paper develop new map membership use trace primary data source large trace web mail service use trace identify individual analyze membership belong primary indicator use guide assign multiple membership single participation campaign mass basic assumption message similar content often send control entity message share common economic interest therefore send machine message likely also control operate single entity though may different entity group similar message relate campaign identify set focus contrast much previous work study previous study use propose monitor remote compromise relate propagation six actively deploy intrusion detection thirteen monitor channel communication three six eleven fourteen redirect c eight use passive analysis information fifteen seventeen focus instead least couple major bene first support greatly deployment story analysis do exist trace one small number large web mail yahoo mail second focus factor directly relate economic motivation behind many harder evade detection compare previous approach particular stop send destroy purpose lastly group analyze potentially less easier task analyze log message query vary greatly one implementation another three six eight eleven fourteen fifteen seventeen approach without challenge one obvious caveat able uncover involve however show later number size discover similar previous suggest method cover large portion name challenge trivial identify message campaign often slightly different presence host dynamic address make count number machine hard lastly log analyze large size experiment useful method scale potentially size work answer challenge primary work analyze entire contrast individual bot behavior message propose evaluate identify cluster use trace work study trace base economic motivation monetize approach analyze regardless internal organization communication approach thwart encrypt c unlike previous work use six eleven fourteen fifteen seventeen report new involve example report relationship usage basic size also con previous report usage pattern successfully find examine subset message receive web mail service size find range host ten thousand host measurement result useful several ways first know size membership give us better understand threat pose second membership geographic useful information deployment rewall placement c third characterize behavior monetize may help perhaps reduce pro send generate click fraud nefarious finally information may also give law enforcement help combat illegal believe present may also applicable relate identify membership click fraud analogous search engine click log analogous trace rest paper organize follow compare work relate work section two present approach extract mine section three four describe result analysis section five finally conclude section six two relate work gather study fall mainly two fifteen category collect c inside use channel three six eleven c redirection eight second category track external trace example use information fourteen seventeen ow data across large tier one network twelve work fall second category use message external trace data source interest relatively easy collect comprehensive nature comparison probe fourteen fifteen seventeen require extra query track capability could limit query rate previous work focus c generate work study trace base economic motivation monetize along direction expect new category trace use characterize different see section six work take individual aggregate aggregation propose paper may generally bene analysis trace category several previous study two sixteen use message collect single small number point gain insight different two cluster base destination link message mainly study machine host land page contrast cluster base content study source ie send infrastructure sixteen also study interaction message however infer data work general study among message sender address three overview technique take input large message collect period days output list probable involve generate message correspond statistics size activity time geographic distribution participate host major step involve identify describe next section present detail one cluster message campaign assume message identical similar content send control entity step identify group message refer campaign lot message campaign similar identical evade detection use shingle four group basic idea compute number ten message message share common identical close content two assess dynamics host dynamic address affect result raise estimation host involve period time use model reverse effect compute dynamics different part address space concretely extract one average time address get reassign two reassignment range use propose way estimate probability whether two message send different time initiate machine approach bear resemblance eighteen three merge campaign multiple campaign come base two step merge individual campaign together set campaign initiate send host overlap message campaign estimate likelihood send host also participate another campaign take dynamics account large number participate campaign merge two together work large step pose formidable computational challenge single computer design use ten model run cluster experiment acceptable turnaround time due space limitation however cover implementation detail paper four methodology section discuss detail approach extract membership analyze data de ne set term use discussion message unsolicited bulk message often send many people little change content campaign set message almost content content closely relate link target set machine collaborate together run one campaign initial process work collect web mail service refer hereafter junk mail sample collection message report automatical contain five million message collect period may may sample rate one size one use sixteen collect fifteen however one order magnitude use two collect seven days think duration reasonable give fact campaign change fast time two initial process message next step extract reliable sender address heuristically message although message format dictate chain relay address message malicious relay easily alter therefore simply take chain instead method follow similar one five first trust sender report receive previous relay address server trust list mail service continue follow previous receive line till reach unrecognized address header address take source also parse body part get text message end message send time content along sender address identify campaign campaign consist many relate message message campaign share set common feature similar content link without redirection target exploit feature cluster message content together single campaign often obfuscate message content message campaign slightly different text one common obfuscate technique misspell commonly word insert extra character offer additional ways obfuscate message insert comment include invisible text use escape sequence specify character present text content image form randomize image algorithm cluster together message content must robust enough overcome obfuscation fortunately obfuscation change main content message render still need readable deliver information thus use ad approach preclean raw content get render content use shingle four algorithm cluster content together basic idea generate set represent content message two message share number mark connect content consider message node graph draw edge two nod correspond two message connect content share embed link de ne connect component graph campaign use algorithm seven label connect graph label represent campaign thus generate list detect campaign assign label associate campaign list f ti g consist address send time ti extract message campaign text shingle one possible approach group campaign ways complementary overall approach example one could use target approach propose two campaign different approach different con example text shingle certainly handle message completely image approach miss campaign contain different message redirect skip many message send use set message build list know relay address include service popular open relay sender address message extract section list exclude analysis relay message also remove campaign whose within single likely own instead bot machine powerful may employ multiple physical location directly send therefore employ another rule remove campaign less three geographic admittedly list remove campaign try strike balance let many campaign remove wrongly many campaign already block message many open relay use moreover con dent campaign originate even geographic operate find ways clearly characterize nature campaign come smaller number geographic future work assess dynamics many home computer currently connect cable service assign new address constantly anywhere every couple every couple days affect estimation number host involve campaign correct estimate dynamic address compensate merge dynamic address address campaign problem dynamics present study eighteen however able directly use result application require different set design similar different approach estimate dynamics begin assume within particular address reassignment strategy uniform also assume address reassignment process measure two address reassignment average lifetime address particular host maximum distance address assign host measure log seven days user june messenger instant message service event obtain address session associate construct sequence assume user connect messenger service small set machine ce computer home computer detect case multiple address associate particular label change address reassignment address close de ne close within couple consecutive otherwise assume two different machine involve aggregate detection among address remove anomalous calculate base process assumption individual thus give two two different time either distance range another regard two two different machine within distance range make computation p actually machine one w probability machine keep address interval duration p six actually machine one one one w probability machine change address reassignment happen interval duration figure one show probability density function reassignment time among never see reassignment seven day log accord large portion address get reassign almost every day identify campaign represent sequence event message belong campaign question give two campaign know whether share controller ie part put two campaign connect de ne connection two campaign give event campaign event campaign assign connection weight connection weight probability two would see actually machine de probability section ie w two address equal one w two address equal within distance range zero otherwise campaign use w ti one w ti zero w p measure fraction connect j represent w call connectivity degree range zero one w large mean portion connect thus merge use connectivity degree w decide whether merge campaign another expect bimodal pattern distribution w large portion w value small correspond pair campaign small portion w value relatively large correspond pair campaign w value middle w value middle reasonable threshold merge campaign w figure two meet expectation base select two reasonable threshold decide whether campaign merge another experiment also test five find change little effect detection result detection sensitive threshold give us con validity cluster connectivity degree w also relate way use controller always use run campaign observe campaign w one campaign however show section use subset available time estimate size contain sequence correspond send want identify distinct machine generate section already de probability two machine use de examine event machine previous event reoccurrence estimate probability address reoccurrence previous address c one p reoccurrence range happen event value c equal one address reoccurrence zero address reoccurrence count number distinct machine appear way furthermore want estimate total size assume behave similarly bot send approximately equal number message de ne follow r rate n number message observe number observe one want measure size number message send per bot mean number message send per bot b number ie size estimate number message expect number observe one message b r one r one one n one r one f p zero l e c g l f p sixteen eight four two one five zero one two three four five six seven zero two four six eight one duration days connectivity degree figure one reassign duration figure two campaign merge weight thus get average number message send per bot size b see campaign actually volume particular seventy message send campaign last less eight log log one r one b n five metrics find section present result metrics behavior send message metrics measure campaign detect describe section four campaign duration duration campaign de time last see campaign important metric behavior present measurement note often different lifetime often rent launch multiple campaign time get result use follow method look campaign happen appear second day count many days last look appear day may well already run day campaign run continuously start second day likely enough ensure campaign indeed start day additionally remove seven enough similar message campaign give reliable result message might user introduce automatical detect false figure three show cumulative distribution function campaign see fifty campaign actually within twelve distribute rather evenly twelve eight days twenty campaign persist eight days figure four show campaign weight volume compare figure three size capability level activity two important metrics understand measure capability need estimate total size base nine days observation measure level activity estimate active work set short time window one hour population dynamic time use size refer estimate number actually use time window size estimate explain section infect machine often clean several period infection machine least every days thus actually use observation window nine days give good approximation number machine control controller consider dynamics number distinct address appear could two time number distinct machine estimate detect follow base estimate total size indicate upper bind likely compromise many machine total issue proxy nat could affect accuracy size estimation topic future study figure five show estimate estimate total size range couple machine ten machine fifty contain consistent similar metric fifteen number message send per bot range couple observation window figure six conservative limit number message send per bot estimation number actually use see f c one eight six four two zero zero one eight six four two f c f c e h g e w f c one eight six four two zero zero one eight six four two zero ten last time last time figure three campaign duration figure four campaign duration weight volume zero one ten total size active size overtime active window size per bot figure five size figure six message send per bot active size level activity time window one hour experiment active size de number use send message time window send per active bot de number message send bot time window experiment study time window duration since limit one couple reasonably assume reassignment happen measure active size number send per active bot time one hour calculate time window average result time period active size number message send per active bot strong impact effectiveness send generally use two method evade base one send message per bot look like legitimate use two use small portion machine one time among machine control figure seven show relationship average active size number message send per active bot see tend send less per bot tend send per bot ways suggest may clear plan number message send stop meet alternatively number address possess may limit total number message send also relationship active duration number message send per bot take together figure seven conclude size primary factor determine number message send per bot activity ratio activity ratio de ratio active size estimate total size activity ratio time window one hour calculate average nine days average activity ratio range zero one value one mean use machine control zero mean use none machine average activity ratio indicate whether use machine use small fraction machine round robin among machine figure eight activity ratio eighty use less half time network activity ratio total size relate general controller might use portion control regardless total number control l e c g l b c p f g v ten one one f c one eight six four two zero ten zero one two three four five six seven eight nine one act size average relative size figure seven average active size average number message send per active bot figure eight activity ratio aspect life span campaign look message receive day server end user much campaign new use every day new campaign monitor might helpful however devote business identify promise study duration campaign basis look message receive particular day identify campaign message belong compute distribution campaign activity particular day experiment study activity last day observation window look backward least active x one x nine days figure nine show sixty receive day send good indication monitor behavior membership use approach propose paper help reduce amount receive daily basis geographic distribution geographic distribution important metric ability compromise take machine figure ten show half detect control machine thirty even control machine show currently widely distribute part wide distribution could also malicious people develop sophisticate mean control widely distribute machine observe typically send message topic world especially range assign cable service one wide geographic distribution result consistent use estimation method propose section total number involve send world observation period machine six conclusion future work work step study economic directly trace actual operation use one primary revenue source get picture bot activity one con deepen understand suggest previous work identify common associate message allow us make estimate size behavioral amount send per bot geographical distribution hope work open new understand think least couple interest future first want validate result detect result infer use compare detection result also let us know portion miss approach second want use detection result paper extra source information example assign different volume belong different give previous behavior may also check existence query log ad click log third certain image shingle use together cluster message finally want study possible order avoid detect approach seven author work summer intern research work also support part trust team research one eight six four two f c zero f c one eight six four two zero zero campaign twenty forty sixty eighty duration days participate figure nine campaign duration aspect figure ten number eleven f c g track explore methodology prevent distribute attack five twelve b detection characterization seven thirteen g j j h forensic network data analysis use animate visualization five fourteen j f multifaceted approach understand phenomenon six fifteen j f bigger maybe better seven sixteen n understand behavior six seventeen n reveal membership use counterintelligence sruti six eighteen f k e dynamic address seven secure technology receive support national science foundation award number follow cisco sun unite paper author necessarily view fund sponsor reference one shadow server two c savage g characterize scam host infrastructure security seven three j r singh algorithm detection sruti six four z glassman c g syntactic cluster web five distribute content independent method detection seven six e f zombie roundup understand detect disrupt sruti five seven h c e r l stein c introduction second edition press eight c lee w model bot net propagation use time zone six nine n click quality security team anatomy seven ten dean j data process large cluster one