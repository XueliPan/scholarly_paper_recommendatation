flash photography enhancement via intrinsic b c figure one top photograph take dark environment image noisy blurry bottom flash photography provide sharp flat image distract shadow silhouette object b inset show noise image c technique merge two image transfer available light note shadow candle table abstract enhance photograph shoot dark combine picture take available light one take flash preserve original light insert sharpness flash image use bilateral filter decompose image detail large scale reconstruct image use large scale available light detail flash detect correct flash shadow combine advantage available illumination flash photography computational photography flash photography tone map bilateral filter image fusion one introduction dark illumination photographer usually face frustrate dilemma use flash picture rely research project laboratory joint unit permission make digital hard copy part work personal classroom use grant without fee provide copy make distribute profit direct commercial advantage copy show notice first page initial screen display along full citation copyright work own must honor abstract credit permit copy otherwise republish post redistribute list use component work work require prior specific permission fee may request broadway new york one available light usually warm atmosphere suffer noise blur fig one top b hand flash photography cause three unacceptable red eye flat harsh light distract sharp shadow silhouette fig one bottom much work address redeye removal harsh light shadow remain major impediment propose combine best two light take two successive photograph one available light one flash recombine two picture take advantage main one fig one c central tool decomposition image layer assume contain variation due illumination layer contain albedo relate work work flash photography focus redeye removal many use prevent red eye professional rely flash indirect light prevent harsh light silhouette shadow work relate continuous flash use flash picture combine linearly interface al provide additional control user spatially vary blend al al fuse image take different enhance context legibility al use flash photograph white balance photography allow image malik new also compensate motion frame kang al ward note different approach operate light picture invert nonlinear clamp two image flash approach summarize fig two take two without flash align two image compensate camera motion detect shadow cast flash correct color use local white balance finally perform nonlinear decomposition two image detail layer recombine appropriately first present basic technique discuss shadow correction section three introduce advance reconstruction section four present result section five take photograph two photograph without flash take rapidly possible avoid motion either photographer subject response curve two ideally know better relative radiometric calibration strict requirement similarly obtain better result white balance set manual future foresee take two image row implement camera perform experiment use tripod remote control fig one eight fig two five seven latter particular require good image alignment rest paper assume image normalize flash image zero one registration two image trivial light condition dramatically different follow kang al compare image rather value use filter small variance two noise keep five highest reject dark information reliable use pyramidal refinement strategy similar ward find transformation minimize keep advance approach could use compensate subject motion kang al bilateral first image intensity color fig two assume use standard although show appendix improve context color layer simply correspond original value divide intensity rest paper use f f intensity flash image want decompose image layer correspond illumination sharp detail respectively use bilateral filter smith smooth image respect sharp feature thereby avoid around strong edge bilateral filter define weight average weight depend f spatial location also weight g difference give input image output bilateral filter one k p f p g one k normalization k p f p g practice g penalize across edge large intensity filter use oh al image edit al tone map use fast bilateral filter nonlinear filter approximate set perform computation domain respect intensity output filter provide log layer detail layer deduce division intensity layer subtraction log domain use spatial variance f fifteen image diagonal intensity influence g use g four follow figure two take two image available light flash respectively color detail intensity correct flash shadow recombine appropriate layer preserve available light gain sharpness detail flash image response contrast light two image try extract light picture combine fine detail flash picture build local decompose image two layer correspond small al al turk al contrast large scale reduce thereby preserve detail interpret term intrinsic image al barrow large scale see estimate illumination detail correspond albedo oh al although type hard barrow tappen al tone map get away coarse approximation layer eventually recombine exploit approach decompose flash image wealth dedicate al al use acquire geometry large set input image contrast perform light transfer two image volume al present set base image pair approach share many work particular use bilateral filter main difference two approach lie treatment flash shadow figure three basic reconstruction shadow correction flash shadow right face ear need correction correction note yellowish halo right character red cast ear see fig four close figure four enlargement fig three correction smooth shadow leave right flash flash white balance color correction reconstruction ignore issue shadow recombine image fig two use detail color layer flash image sharper white balance reliable use layer picture order preserve mood tonal model original light situation layer simply add log domain fig three illustrate result basic approach output combine sharpness flash image tonal model image dark contrast large scale need enhance opposite contrast reduction set target contrast layer scale range log value accordingly low quantization original image create bilateral filter result layer addition compute white balance two image compute weight average three channel weight bright white color flash image take white balance use preserve warm tone available light practice color cast image usually strong apply partially use usually two must still improve output flash shadow intensity increase match large scale image distinct color cast noise definition receive light flash inherit image ring flash might reduce must perform additional process alleviate three shadow treatment order correct must detect lie shadow umbra penumbra different require different detection correct color noise shadow correction apply shadow robust false potential detection shadow create visible umbra detection expect difference image flash tell much additional light receive flash image radiometrically calibrate histogram detect umbra penumbra figure five shadow detection exactly light receive flash however shadow always correspond zero indirect light shadow always correspond value exact cutoff use histogram analysis compute threshold ti determine umbra shadow correspond mode histogram additional light receive part scene light flash vary albedo distance normal part shadow indirectly illuminate receive uniform low amount light compute histogram use bin smooth blur variance two bin start coarse threshold two discard value use first local minimum histogram two threshold shadow detection fig five successfully detect umbra however penumbra correspond smoother gradation detect histogram technique use complementary detection base gradient shadow penumbra detection shadow create strong flash image correspond image detect use two criteria difference connectedness umbra compute magnitude gradient f f smooth variance two remove noise identify candidate penumbra gradient flash image keep close umbra least one neighbor umbra practice use square neighborhood size one photo diagonal computation perform efficiently convolve binary umbra map box filter also must account shadow cast tiny object piece fur since might pure penumbra without umbra use similar strategy consider shadow large number neighbor higher gradient flash image use threshold eighty square neighborhood size seven photo diagonal observe concern penumbra robust respect scene size penumbra vary much case flash photography distance light distance image plane variation penumbra size ratio distance perspective projection mostly cancel flash detail computation detect shadow refine flash image exploit shadow mask exclude shadow bilateral filter result detail layer flash image affect shadow variation color noise correction color shadow simply correct use white balance al two reason first shadow receive different amount indirect light flash result hybrid color cast affect ambient light color bleed object second image often lack information blue channel due yellowish light poor sensitivity small fig three illustrate cause global white balance shadow order address issue use local color correction copy color illuminate flash image example fig three shadow fall wall sofa frame jacket object intrinsic color shadow illuminate region inspire bilateral filter compute color shadow weight average neighbor flash image f full color information weight depend three term spatial color similarity f binary term exclude shadow fig six perform computation color layer see fig two use f photo diagonal spatial g one color similarity describe use sum weight k measure uncertainty discard color correction k threshold practice use smooth feather two two avoid recall layer intensity obtain image affect shadow shadow use detail layer flash image could affect due shadow boundary instead copy detail layer image correct noise level scale detail match variance flash detail outside shadow order ensure continuity shadow correction use feather boundary detect shadow follow linear ramp update linear combination original value fig three four show result shadow correction robust false shadow simply copy color image wrongly shadow color noise preserve long similar color shadow distance photo color similarity final weight distance color similarity shadow mask flash photo outside shadow inside shadow shadow mask outside shadow inside shadow reconstruct color figure six flash shadow color layer compute weight average color weight depend three term distance similarity image binary shadow mask picture dark property bilateral filter reliable noise level range signal level similar technique use color correction use flash image similarity measure propose modify one image compute term g function value one f k p f p g f p f f p two preserve edge although really present image shadow correction however perform shadow edge flash picture transfer g term fig one exploit decomposition layer flash image also exploit drive reconstruction distance make object closer camera use emphasize main object use version shadow assign use average neighbor similarity define image principle multiply large scale image perform use parameter use fig eight five result discussion technique take fifty second three image majority time spend color correction bilateral filter efficiently since operate three channel image fig eight include shadow correction take ten second fig one three seven eight illustrate result available light preserve color sharpness detail flash picture gain experience main failure technique poor quality quantity available light example light behind subject result underexpose subject find however hard outperform poor light flash well know light along optical axis result good tonal model contrast fig two eight present nice side light al propose similar approach call joint four advance wealth information provide pair image exploit enhance result dark advance light transfer bilateral filter flash result figure seven flash light result flat image result light seem come window right receive conflict feedback fig seven show image quality subjective question image light come back unusual light photograph appreciate strong sense light provide object lack tonal model another failure overexposure flash lead flat detail layer situation detail information neither due noise flash photo due saturation shadow detection work best depth range limit distant object receive light flash detect shadow technically correct kind shadow due necessitate treatment cast shadow fortunately color correction robust false degrade identity case although transition could potentially create similarly black object detect shadow affect quality since black two image remain black output light flare brighten shadow method ward could alleviate problem use image variety include fig one image kodak show paper choice camera usually dictate availability time shoot affect approach noise level flexibility control accuracy flash white balance compression quality example kodak exhibit strong dark image require use filter need filter primarily drive picture kodak higher noise level old despite age size allow take image dark condition addition use raw format twelve allow higher precision flash image lower image dominate noise however sensitivity equivalent iso structure noise make filter necessary six future work present method improve light flash photography combine picture take flash one use available light use filter estimate see intrinsic layer image use transfer available illumination flash picture detect shadow cast flash correct color balance noise level even picture extremely noisy method successfully transfer light due use flash image perform filter method could tailor particular g base model tra figure eight tonal model cloth face accurately transfer available light main subject visible result original image redeye removal could benefit additional information provide pair image texture synthesis could use improve shadow correction ideally want alleviate disturbance flash consider use infrared illumination however challenge require different provide limit resolution color information difference flash image contain much information scene although fundamental ambiguity remain albedo distance normal direction additional information could greatly expand range power picture enhancement tone map photo edit image acknowledge support cise research infrastructure award center grant stay support ens many thank marc ray eric martin shelly pater hanna appendix traditional approach rely linear weight r g b intensity estimation formulae valid point view improve illumination linear intensity computation result lower value albedo particular blue white object result intensity transfer might overcompensate show fig nine leave red fur become bright alleviate use channel weight linear combination r g practice use channel flash image weight picture ensure consistency two formula also use tone map higher color fidelity g b b fast bilateral filter display image graphics three automatic redeye detection correction image process continuous flash tech rep bridge gap color image human observation image process six kang winder high dynamic range video graphics three digital extend dynamic range combine differently expose picture ann conference inverse light pho color image conference oh model ing photo edit digital photography flash image pair graphics volume image fusion context enhance figure nine computation intensity greatly affect final image leave linear weight red fur become bright right use nonlinear formula stark photographic tone reproduction digital image graphics three reference rick convey shape feature visualization tone map algorithm high contrast image workshop render barrow recover intrinsic scene image computer vision academic press wang spatially nonuniform scale function high contrast image graphics interface illumination distribution brightness shadow adaptive estimation illumination distribution unknown reflectance shadow smith j new low level image process tappen f freeman w e h recover intrinsic image single image nip c r bilateral filter gray color image turk boundary hierarchy contrast reduction two display high contrast image graphics eighteen one trilateral filter high symposium contrast image mesh render ward fast robust image registration high dynamic range photograph j graphics tool eight two image stack tech derive intrinsic image image sequence rep forty malik recover high dynamic range radiance map photograph j b render high dynamic range image image j f b illumination color image conference malik inverse global illumination recover reflectance model real photograph eye detection human face recognition intelligent ally