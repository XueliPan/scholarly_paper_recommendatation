visual computer manuscript insert editor wang lin spherical harmonics scale abstract paper present new sh operation call spherical harmonics scale shrink expand spherical function frequency domain show problem elegantly formulate linear transformation sh efficient compute easy implement spherical harmonics scale particularly useful extrapolate visibility radiance function sample point point closer farther light source sh scale present shadow general deformable object efficient approximation spherical irradiance function within midrange illumination environment signal process illumination render spherical harmonics fig one scale operation top row scale spherical function around p bottom row spherical harmonics scale one introduction practical computer graphics especially render global illumination effect spherical harmonics offer efficient representation spherical signal representation widely use computer graphics model illumination three visibility function five seven spherical harmonics basis several define spherical harmonics efficiently compute make spherical harmonics wang institute compute technology academy science graduate school academy science e university lin research work do wang intern research eleven relate work global illumination integral render equation expensive impractical render efficient solution problem represent irradiance surface reflectance spherical harmonics solve spherical convolution sh dot product sh coefficient three approach utilize work radiance transfer five convolve sh kernel transfer radiance account visibility basic formulation present static extend functionality spherical harmonics propose facilitate change light condition object five spherical harmonic describe rotation environment map without sh rotation also employ shadow two wang al field technique eight rotation local light source occlude object locally deformable object sloan al six present zonal harmonics demonstrate basis efficient rotation implement current two method introduce fast evaluation radiance sh triple product light reflectance visibility triple product present operation spherical harmonic equivalent multiplication two spherical function unlike dot product triple product result new spherical harmonic projection instead scalar triple product somewhat cumbersome compute would expensive employ large number spherical function involve recently new operation spherical harmonics call spherical harmonics exponentiation four propose efficient evaluation visibility scene deformable object instead compute expensive sh product per blocker previous work perform inexpensive vector sum accumulate log blocker visibility sh exponentiation yield product visibility vector approach visibility function associate numerous efficiently aggregate twelve overview paper propose new sh operation call spherical harmonics scale shrink expand spherical harmonics project function around give point sphere result procedure illustrate fig one input spherical function show scale respect point p scale spherical function smaller contract region boundary towards p scale extend away p address problem compute spherical scale spherical harmonics projection illustrate bottom row fig one find spherical harmonics scale formulate linear transformation sh cheap compute easily implement spherical harmonics scale bring new functionality extrapolate visibility radiance function sample point point locate farther closer light source occlude object present two take advantage property one shadow technique general object deformation construct approximate shadow field fly sample visibility single radial distance object rapidly scale function radii second application utilize spherical harmonics scale efficiently approximate spherical irradiance function midrange illumination environment map define finite sphere two spherical harmonics scale polar shrink expand spherical function around zero axis new function express one monotonically increase angular scale function polar angle independently azimuth angle spherical function represent visibility give point move closer result scale visibility function likewise move farther correspond angular scale function spherical function represent radiance change solid angle due scale must consider energy preservation account solid angle one rewrite sin sin sin two combine one two define spherical scale sin three sin without energy preservation sin energy preservation scale sh representation spherical function represent spherical harmonics spherical scale also do directly spherical harmonics domain refer operation spherical harmonics scale represent spherical harmonics express linear transformation respect sh basis function z z z z x z z j j x z z j j j x j j j four spherical harmonics scale three give angular scale function spherical harmonics scale reduce product sh scale transformation matrix j call st r j five sh scale transformation matrix four sh scale transformation matrix define j z z j six interest property transformation matrix less nonzero matrix nonzero independent angular scale function prove appendix regardless whether energy preserve exactly n two one three n four nonzero n spherical representation example spherical harmonics nonzero locate matrix show fig two since nonzero transformation matrix independent angular scale function computational save gain reduce product five set sum nonzero angular scale function analogous backward warp function use image process angular scale function backward map polar angle define accord application typically series angular scale function k k provide perform scale different instance correspondingly different scale transformation matrices fig two nonzero sh scale transformation matrices x represent nonzero fig three plot six randomly select respect k scale visibility function k respect different k case k express analytically even analytical form exist k k k often expensive calculate choose numerically compute k sample value k linearly interpolate intermediate value show fig three different scale transformation matrices change smoothly respect k find sufficient sample forty value k exponential distribution three sh scale shadow field deformable object traditionally soft shadow directly compute relative position light source dependence scene configuration become difficult due large number possible object dynamic scene enable amount soft shadow generation dynamic shadow field technique eight light visibility model shadow effect individually allow independent arrangement run time shadow effect efficiently combine accord scene arrangement give fast performance light source shadow field call source radiance field sample incoming radiance distribution point empty space surround illuminant point sample uniform angularly radially point give radial distance center light source form sphere sample angularly uniform distribution sample point incoming radiance distribution record cube map incoming radiance value different shadow field occlude object call object occlusion field cube map similarly sample instead record visibility information alpha value four wang al fig four cone geometric approximation sample point bound sphere whose visibility extrapolate point angular direction different approximation radial distance angle actual angle object silhouette b intermediate within sample point shadow field cube map interpolate cube map eight nearest sample point cube map represent term spherical harmonics facilitate process deformable object shadow field become infeasible due large number possible object address problem take advantage observation one view shadow field entity increase decrease distance form visibility function radiance distribution appear approximately decrease increase scale illustrate top row fig five base property propose sample shadow field single radial distance rapidly extrapolate sample radii sh scale principle geometry object must know order obtain precise angular scale function since information generally unknown utilize cone geometric approximation object surface form cone face sample point show fig four angle virtual cone radial direction set four implementation may adjust user obtain better approximation give object geometric approximation angular scale function k r give k zero zero k tan k one tan k tan result geometric approximation exhibit bird model fig five approximate visibility function bottom row closely resemble actual visibility function give top row slight exist approximate visibility function approximation nevertheless adequate shadow occlude object utilize sh scale function one light source spherical function also express radiant energy term unit solid angle instead binary visibility account radiant intensity respect solid angle use energy preserve sh scale function two render algorithm perform run time frame two stag first stage function compute fly sample point bound sphere scene sample point rectangle towards center object light source use function read back visibility radiance function next function convert spherical harmonic second stage scene vertex sh visibility function respect object sh radiance function respect light source scale respond compute correspond sh scale transformation matrix soft shadow value compute accord algorithm give eight st since visibility function deformable object sample extrapolate sh scale shadow field deformable compute rat moreover object surface also approximate within bound sphere use k one expand original visibility function instead shrink midrange environment light fig five approximate visibility scale visibility function top row actual visibility different radii bottom row correspond visibility compute cone geometry approximation visibility acquire bound sphere radius r leave right radius efficient render global illumination effect complex distant light several base radiance transfer propose five two address transfer distant directional illumination environment map spherical harmonics scale five table one performance data deformable shadow field scene fly dragon egg deform light bend sponge teapot plane vert render algorithm involve two step vertex first scale radiance function sphere center vertex position obtain since vertex arbitrary direction relative sphere center first rotate direction scale rotate back second combine incoming radiance represent sh basis transport vertex calculate soft shadow value describe five four experimental result implement two describe sec three ram graphics card spherical harmonics representation use present experiment overall performance data list table one deformable shadow field display render frame sequence fly dragon fig eight transform egg fig nine bend sponge block fig ten complete sequence refer reader supplementary video scene fig eight contain deformable local light source consist planar red emitter green emitter connect adjustable angle visibility function approximate spherical harmonics scale generate soft shadow consistent animate object fig seven compare result approximation fully sample shadow field use eight midrange environment light show fig eleven render image teapot plane midrange environment light example sample irradiance distribution center scene irradiance distribution vertex extrapolate use sh scale corner image illustrate light distribution consist red green source also show position orientation teapot within environment light sphere notice shadow shade change teapot plane move scene fig six sh scale midrange environment light object fix surround scene effectively handle light nondistant source distribution incoming source illumination vary point point scene efficiently address issue al one approximate incident light object sample illumination distribution point eight sample per object interpolate point use spherical harmonic spherical harmonic scale present substantially efficient technique case environment map illumination distant originate sphere radius r capture single irradiance function center sphere irradiance function within sphere scale show fig six r correspond denote vector sign quantity angular scale function k r give k two p one cot one k seven one one k fig seven comparison fully sample shadow field leave column extrapolation sh scale right column wang al eight k lin b shadow field dynamic graph three appendix structure sh scale transformation matrix spherical harmonics define l l p zero k zero l cos p l sin l l cos p l cos zero cos zero zero p denote associate k normalization factor k l one four l l spherical harmonics decompose l l l l l l cos zero zero l sin zero k zero l p l cos zero p cos zero l p zero l cos zero l l denote j equation six equation six rewrite j l l z z two zero z z zero z z l l l l l zero z l l l l l easily prove nonzero mean choose thus nonzero whatever transformation matrices lie fix position independent angular scale function relatively sparse j zero six five conclusion propose new operation spherical harmonics basis efficiently scale spherical function represent sh spherical harmonics scale amenable implementation use extrapolate visibility radiance function sample point point closer farther light source future work plan examine reduce extrapolation visibility radiance function one source error occur sample point bound sphere lie surface object result visibility function half occlude regardless object shape direct extrapolation visibility function lead circular silhouette although problem partly mitigate visibility function nearby sample point lie object surface plan examine different sample scheme reduce error example error may potentially decrease sample different radial distance different accord certain geometric criteria extrapolation error may also arise geometric approximation describe sec address issue plan investigate possible solution partition object light source small number handle separately one another would like thank yang helpful discussion spherical harmonics anonymous helpful comment support part natural science foundation china national basic research project china reference one j f seidel spherical harmonic midrange illumination render two r r p triple product sig wavelet graph four three r p efficient irradiance environment map one four z wang r j k x sun b sloan h q b soft shadow dynamic use spherical harmonic exponentiation five sloan p j j radiance transfer render dynamic light two six sloan luna b j local deformable radiance transfer graph three seven sh j predict reflectance function complex surface six spherical harmonics scale seven fig eight shadow field deformable object fly dragon fig nine shadow field deformable object transform egg deform light source fig ten shadow field deformable object deform sponge block fig eleven midrange environment light position teapot relative environment light show corner eight wang al wang second year student institute compute technology academy graduate school academy receive degree university take internship research since research interest include appearance model hardware accelerate render first year student university receive degree university research interest include render appearance model lead graphics group research receive computer science university respectively current research focus geometry process texture process real time render hold ten grant pending us patent many integrate vista lin join research june currently researcher graphics group research interest include computer vision reflectance model computer graphics obtain electrical engineer university computer science engineer university michigan currently professor computer science department university research interest include digital geometry process render computer animation geometric design receive university editorial board computer aid design research manager graphics group research join senior staff researcher research corporation work graphics architecture receive university university associate editor visualization computer graphics hold thirty grant pending us patent