Author manuscript, published in "Computer Graphics Forum 27, 1 (2008) 13--23"

0
1
0
2

 
l

u
J
 

9

 
-
 

i

 

1
n
o
s
r
e
v
 
,

1
8
2
5
4
3
0
0
-
a
i
r
n

i

OcclusionTexturesforPlausibleSoftShadowsElmarEisemannandXavierDécoretARTIS-GRAVIR/IMAG-INRIA†AbstractAuthors’version:Thispaperpresentsanovelapproachtoobtainplausiblesoftshadowsforcomplexdynamicscenesandarectangularlightsource.Weestimatethelightsocclusionateachpointofthesceneusingpre-ﬁlteredocclusiontextures,whichdynamicallyapproximatethescenegeometry.Thealgorithmisfastanditsperformanceindependentofthelight’ssize.Beingimagebased,itismostlyindependentofthescene.Noaprioriinformationisneeded,inparticularthereisnocasterandreceiverseparation,makingthemethodappealingandeasytouse.1.IntroductionShadowsareveryimportanttoestimatethespatialrelation-shipsofobjectsandtoconveyasenseofrealism.Formanyyears,computergraphicsconcentratedmostlyonpointlightswhichcreatehardshadows,surfacesbeingeitherlitornot.Intherealworld,mostlightsourcesarenotpunctualandcreatesoftshadowsmadeofumbraandpenumbraregions.Intheumbranodirectlightarrives,whereasinthepenum-brathelightsourceisonlypartiallyoccluded.Theincom-inglight,orirradiance,atasmallsurfaceisgivenbyadou-bleintegraloverthesurfaceandthelightsource,ofafunc-tioninvolvingenergy,visibilityandorientation.Severalap-proaches[AAM02,AAM03,ADMAM03]haveshownthattheimportantinformationforconvincingshadowsliesinthevisibilitycontribution.Orientationcanbefactoredoutoftheintegral.Theproblemthussimpliﬁestothecalculationofthelight’svisibleportion,whichyetrepresentsachalleng-ingtask.Thispaperpresentsanovelwaytoestimatethisvisibilityfunctionwiththefollowingproperties:•shadowsareplausible,continuous,smooth,andaccountforrealpenumbrae(notjustextendedumbrae);•thequalityandspeedofthemethodisindependentofthesizeofthelightsourceandthepenumbrae;•thealgorithmisalmostindependentofscenecomplex-ity,doesnotrequireinformationaboutthesceneandin-tegrateswellwithvariousrenderingparadigms(vertexshaders,pointandimagebasedrendering,...);•thereisnoneedtodistinguishshadowcastersfromre-ceivers.Ourapproachisinspiredbypreviouswork[KM99,SS98]andexploitscurrentgraphicshardwaretoobtainreal-time†ARTISisateamoftheGRAVIR/IMAGlaboratory,ajointeffortofCNRS,INRIA,INPGandUJFperformanceforhighlycomplexscenes.Ingeneralourmethoddoesnotleadtophysicallycorrectsoftshadows,asdoesnocurrentreal-timemethod.Neverthelessweshowthatourapproximationbehaveswellinseveraltestcasesandcomparethequalitytoreferencesolutions.Alsowegiveashorterroranalysisthatcouldbeappliedinpracticetoac-celeratethealgorithm.Thebasicmethoddescribedinthispaperwasoriginallypublishedin[ED06b]atSIBGRAPI2006.Thisextendedversionpresentsimportantimplementationdetails,asolutionforsunlightshadows,notpreviouslydescribedoptimizations(Sec.3.6),additionalcomparisonswithpreviousworkandadeeperanalysis(Sec.4.2and4.1).2.PreviousworkLotsofresearchfocusedonshadowsandanexhaustivepresentationisnotpossiblehere.Wereferthereaderto[WPF90,HLHS03]forsurveys.Pointlightsourcesdonotcreatepenumbraeandamountstopoint-point-visibility.Imagebasedtechniquessuchasshadowmapping[Wil78]exploitthis,yieldingperformancequasiindependentoftheactualscenecomplexity.Thisisinterestingforcomplicatedobjects,butthediscretena-tureofimagesleadstoaliasing.Percentagecloserﬁlter-ing[RSC87,BS01,Ura05]usesseveralshadowmapsamplestosmooththejaggyboundaryofhardshadows.In[DL06],statisticsareusedtosmooththealiasing,butcanintroducelightleaks.Notethattheseartefact-smoothingmethodsaresometimesusetoproducesmoothshadowsthatshouldnotbemistakenwithsoftshadows.Alternatively,shadowvol-umes[Cro77]givehigherqualityastheyusetherealob-jectsgeometry,butpotentiallysufferfromcomputationover-headforcostlyforcomplexscenes(forvegetation,almostalledgesareasilhouette,yieldingshadowquadsoverdrawandexpensivesilhouettedetection.0
1
0
2

 
l

u
J
 

9

 
-
 

i

 

1
n
o
s
r
e
v
 
,

1
8
2
5
4
3
0
0
-
a
i
r
n

i

2E.Eisemann&X.Décoret/OcclusionTexturesforPlausibleSoftShadowsInprinciplesoftshadowscouldbecreatedbyevaluatingseveralpointlights.Ifsamplingistoocoarse,bandingoc-curs.Usingtoomanysamplesyieldsexpensivecreationandevaluation[Ura05],therefore,approximatemethodshavebeenproposed.BrabecandSeidelcalculatemaximumun-occludedradiionadepthmaptoapproximatesoftshad-ows[BS02].In[KD03],appropriatewidthvaluesarepre-calculatedinaspecialmap.Shadowmapshavebeenusedin[SAPP05]tocalculate,inapreprocess,aspecialdeepshadowmapforastaticlightsource,encodingocclusionforeachpointofastaticscene.Dynamicobjectscanbein-sertedbutcannotcastsoftshadows.ThesomewhatoppositestrategywaspresentedbyZhouetal.[ZHL∗05];shadowin-formationisfaithfullyprecalculatedperobject.Thesestaticelementscanthenbeuseddynamically.Duetohugestor-agenecessities,theresultiscompressedonbasisfunctionswhichareevaluatedatrun-timeateachscenevertex,involv-ingsorting.Agrawalaetal.[ARHM00]warpseveraldepthimagestoobtainlayeredattenuationmapswhichcanbeevaluatedquicklyatrun-time.Asthepreprocessisquitein-volving,lightsourceandscenehavetobeconsideredstatic.ApurelyimagebasedapproachhasbeenpresentedbyArvoetal.[AHT04].Thecameraviewisﬁlteredtodetecthardshadowboundaries.Floodﬁllisusedtocreatepenumbraebasedondepthmapinformation.Thisisnotwellsupportedbythecurrentgraphicshardware.Thecostdependsheavilyonthesizeofthepenumbraonthescreen,whichcanbelargedependingonviewpointandlightsource.Asinnerpenum-bracreationisanerosion,overlappingumbrasleadtoacom-pletedisappearanceandtemporalincoherence.Althoughnotphysicallycorrect,theirgoalwastocreateplausibleshad-ows.WeworkinthesamecontextbutshowinSection4.1.RecentlyAttyetal.[AHL∗06]presentedanapproachbasedonasingledepthmap.Separatingoccluderandreceiver,depthmappixelsreplacetheactualoccluderandarepro-jectedonthereceivingground.Thealgorithmgivesconvinc-ingresultsathighframeratesbutinvolvesCPUusagewhichlimitstextureresolution.Relatedtechniqueswerepresentedin[GBP06,BS06,ASK06],thatreplacetheCPUinterac-tionbyaslightlymoreexpensivefragmentshaderanddon’tneedtheoccluderreceiverseparationanymore.Therun-timecomplexityislinearwithrespecttothesource’ssizeandal-lowsonlytouserathersmallsources.Largesourcesalsoin-ducevisibletemporalincoherences(compareSection4.1).Shadow-volumeextensionsforsoftshadowshavebeenpresentedin[AAM02,AAM03,ADMAM03].Thesegeometry-basedwedgesgivehighqualityshadowsbutrelyonasilhouettedeterminationfromthecenterofthesource.Samplingartifactsareavoidedandlightsourcescanbetex-tured[AAM03],buttheapproachesareunsuitableforhighlycomplexmodels.Thecombinationofthecontributionsofdifferentoccludersisdonebyadditiveaccumulation.Hy-bridapproacheslike[CD03]encountersuchproblemstoo.Heresupplementaryprimitivesareattachedtosilhouettestodescribetheblockinginﬂuenceoftheedge.Itiscloselyre-latedto[PSS98]andresultsinaliasfree,notsoftshadows,justlike[WH03].In[KM99],thesceneisreplacedbyanMDI(Multipledepthimage)obtainedontheCPU,andray-tracingisperformedagainstthisalternativerepresentation.ThereareseveralsimilaritiestoourmethodandwewillhaveamoreprecisediscussioninSection4.Preciseshadowsandaccurateoccluderfusion[ED07,SS07]haveonlybeenre-centlyintroduced,butsuchapproachesaremorecostlythanthehere-presentedsolution.3.OurapproachWeapproximatetheshadowintensityatapointPforarect-angularlightsourceSinthepresenceofanoccluderObytheintegral:I(P):=(cid:2)SvP(S)dS(1)wherevPisthevisibilityfunctiondeﬁnedby:vP:S∈S→1if[P,S]∩O=∅else0(2)Inotherwords,wecountthenumberofraysfromPtoSthatarenotblockedbyO.Theshadowintensityfunctionisthreedimensionalandgenerallyverycomplex.Insubsequentsec-tions,wepresentaGPUfriendlyapproximation.3.1.SingleplanaroccluderFirstweconsiderasingleplanaroccluderparalleltothelightsource.ItisfullydescribedbyitsupportingplaneΠOanditscharacteristicfunctioninthatplane:δ:ΠO(cid:6)→{0,1},Q→1ifQ∈Oelse0(3)ConsiderthefrustumdeﬁnedbyapointPandthelight,andtheregionwhereitintersectstheoccluderplane.ThereisabijectionbetweenthatregionandlightrayspassingthroughP.Therefore,theshadowintensityatPistheintegralof1−δoverthisregion,normalizedbytheregions’ssize(Fig.1).Becausethelightisrectangularandparalleltotheoccluder,filterPLight sourceOccluderFigure1:Shadowintensityasaﬁlter.thisregionisarectanglewhosesizedependssolelyonthedistancesofPtothelightandoccluderplanes:s(P):=d(P,ΠO)d(P,ΠS)×size(S)(4)submittedtoCOMPUTERGRAPHICSForum(7/2010).0
1
0
2

 
l

u
J
 

9

 
-
 

i

 

1
n
o
s
r
e
v
 
,

1
8
2
5
4
3
0
0
-
a
i
r
n

i

E.Eisemann&X.Décoret/OcclusionTexturesforPlausibleSoftShadows3Theintegralcanbecomputedbyﬁltering1−δwithaboxﬁlterofsizes(P).Ourapproachistoencode1−δasaanocclusiontextureandtoprocessit,asdescribedinnextsec-tion,suchthatapointPcanbeshadedbysimplycomputings(P)usingeq.(4)andperformingalookupoftheappropri-atelyﬁlteredresult.3.2.FastboxﬁlteringToﬁlteranocclusiontexturewitharectangularkernel,weinvestigatedthreeapproaches:Mipmapping,NBuffersandSummedAreaTables.Mipmappingwasintroducedtoreducealiasingofmini-ﬁedtextures[Wil83].Itlinearlyinterpolatesbetweendyad-icallydownsampledversionsofthetexture.ItisiswidelysupportedbyGPUsandwasanaturalcandidatetoﬁlteroc-cludertextures.Inparticular,rectangularkernelsaresup-portedwithanisotropicﬁltering.Thankstolinearinterpo-lationmipmappinggivessmoothlyvaryingshadows(Fi.2,top).However,itsuffersfromblockyartefactsthatbecomeparticularlynoticeablewhenthesceneisanimated.Thisre-sultsfromthedyadicdownsamplingthatmaycombineadja-centtexelsonlyatveryhighlevelsinthemipmappyramid.Therefore,aslightshiftoftheocclusiontexturecanleadtolargevariationsoftheﬁlteredfunction.Toalleviatethisproblem,DécoretintroducedtheNBuffers[D´05]toallowpreﬁlteringwithcontinuouslyplacedkernels.Originallythistechniquewasusedwithamaxﬁlterandappliedforcullingofgeometry.Weusethemtocomputethemeanvalueofneighboringpixels.Eachlevellholds,foreachtexel,thenormalizedresponseofaboxﬁlterwithakernelsizeof2l×2l.Vialinearinterpolation,intermediatekernelsizescanbeapproximated.Itstilldoesnotcomputetheexactﬁlteredfunction,butitsigniﬁcantlyreducestheblockyartifacts(Fig.2bottom)inparticularfordynamicscenes.TheconstructionofNBuffersisextremelyfast.Fora256×256texture,8levelsneedtobecreated,eachofresolution256×256.Approximately500Mpixelsareprocessed,eachrequiringexactly4texturelookups.Moderngraphiccardscanperformmorethan50timesthisamountofworkat30fps.Interestingly,theﬁlteringbyarectangularkernelcanbeexactlycomputedusingSummedAreaTables(SAT)[Cro84].Unfortunately,althoughanefﬁcientGPUimple-mentationhasbeenrecentlyproposed[HSC∗05],thisap-proachstillsuffersfromseverallimitations.First,32bittex-turesarerequiredorsevereprecisionartifactswillappear†.Currently,linearinterpolationforsuchtexturesisnotna-tivelysupported(thisiswhytexelsarenoticeableontheclose-upofFig.2).Moreover,creationandtransferofsuchtexturesincreasethebandwidth,slowingdowntheprocess.†Shiftingthevalues,assuggestedbytheauthors,isnotusefulinourcase,duetothebitmasknatureofoccludertexturesSpeedisalsoimpededbythe4texturelookupsrequiredtogettheﬁlter’sresponse,whenNBuffersrequireonlyone.Fi-nally,contrarytoNBuffers,thenormalisationbythekernelsizecannotbeembeddedandthusrequiresextracomputa-tions.However,asexpectable,theresultingqualityishigher,buttheimprovementdoesnotcompensatetheperformancepenalty.Weimplementedthethreeapproaches(Fig.2).Inouropinion,NBuffersarecurrentlythebesttradeoffbetweenperformanceandquality.Onfuturehardwarethough,SATmayprovefastenoughtobecomethepreferredsolution.Inparticular,itusesasingletexturewhichismorecachefriendlythanthemultipletexturesrequiredbyNBuffers.Tobeabletoperformafaircomparisonweusedthesamehard-wareusedin[HSC∗05].Ourimplementationleadstoap-proximatelythesametimings(itdiffersby1.5msexceptforthecaseofaresolutionof512×512whereourimplementa-tionis30%faster).resolutionMipmapSATNBuffers(top)(middle)(bottom)256×256<1ms5.1ms<1ms512×512<1ms21.9ms1.7ms1024×1024<1ms96.8ms7.3msFigure2:Comparisonofﬁlteringmethods.3.3.MultipleplanaroccludersWenowconsiderseveralplanaroccluders.Theshadowscausedbyeachoccluderindependentlycanbecomputedasbefore.However,combiningtheseshadowsisanotablydifﬁ-cultproblem.Aspointedoutin[SS98],thecorrectsolutionliesbetweenthesumandthemaximumoftheoccluders’contributions.Intuitively,twooccluderscancoverdisjointoroverlappingpartsofthelightsource.Previousapproachesmoreorlessaddressthisproblem.In[SS98],themeanvaluebetweenthesetwocasesissug-gestedasanadhocsolution.Assarsonetal.usewedgestoaddorsubtractlight,andarethusinherentlyboundtocom-binethemadditively[AAM02,AAM03,ADMAM03].Touseadifferentcombinationmethod(stillnotexact)acostlysubmittedtoCOMPUTERGRAPHICSForum(7/2010).0
1
0
2

 
l

u
J
 

9

 
-
 

i

 

1
n
o
s
r
e
v
 
,

1
8
2
5
4
3
0
0
-
a
i
r
n

i

4E.Eisemann&X.Décoret/OcclusionTexturesforPlausibleSoftShadowsclearingstepbecomesnecessaryaftereachsilhouetteloop(see[ADMAM03]).DetectingsilhouetteloopsalsoimpliesalotmoreworkontheCPU.Duringtheirﬂoodﬁll,Arvoetal.[AHT04]needtokeeptrackofthetexelinashadowmapresponsibleforocclusion.Whencombiningtheocclu-sionfortwosuchtexels,ithastomakeachoiceandthereforeselectstheonewithmaximumocclusion.Additiveapproachesquicklysaturate(itproducesocclu-sionvaluesgreaterthan100%thatmustbeclamped)andoverestimatetheumbra:shadowslooktoodarkandcre-ateunrealisticshadowgradients.Takingthemaximumvaluegivesvisuallymoreappealingresults,buttendstocreatetoobrightshadows,inparticulariftheoccludersareratherun-structured,likethefoliageofatree.Alsogradientreversalshappeneasilyinthissituation.Takingtheaveragedoesnotmakethatmuchsenseeither,becausethemaximumonlytakesasingleoccluderintoaccount,whereasthesumin-volvesalloccluders.Thustherangesofthesetwovaluesaretoodifferenttobemeaningfullycombined.Weproposeanovelwaytocombinethecontributions.OurkeyobservationisthattheprobabilitythatarayfromPtoSisnotblockedbytheconsideredplanaroccluderisexactly1−V(P),whereVistheshadowintensityfunctiongivenbyeq.(1).Ifweconsiderseveraloccluderswithauni-formdistributionofocclusion,theprobabilitythatarayisnotblockedbytheunionoftheoccludersistheproductoftheprobabilities.Thusweproposetocombinetheshadowintensitiesofseveraloccludersusing:I1,...,n(P):=n∏k=1(1−Ik(P))(5)Thisformulahasthesameadvantagesasthesum.Ifanoc-cluderdoesnotblockanyray(Ik(P)=0),itdoesnotinﬂu-encetheresult.Ifitblocksallrays(Ik(P)=1),theresultingintensityiszero.Comparedtothemaximum(Fig.3),itdoescombinealloccludersinsteadofselectingonlyone.3.4.GeneralsceneTotreatgeneralscenes,weapproximatetheocclusiontheycancausewithseveralocclusiontextures.Wecutthesceneinslicesparalleltothelightsource,andprojecteverythinginsideasliceonitsbottomplane(theonefurthestfromthelightsource).Thispositionalinformationisbinaryandthusapproacheslike[DCB∗04,ED06a]couldbeusedtorecovermanylayersatthecostofasinglerenderingstep.However,themoresliceswehave,themoretexturelookupsweneedtocomputethecombinedshadow(notethatthecostofpre-ﬁlteringismostlyneglectable(seeta-ble2).Currentlyweuse4to16sliceswhichseemstobeagoodtradeoffbetweenspeedandaccuracy.Tocalcu-latetheoccludertexturerepresentation,eachslicehastoberepresentedinonecolorchannel.Multiplerendertargets(MRT)givethepossibilitytowriteinto4buffersatthesametime,thuswecandirectlyassociatetheslicestothecorrectcolorchannel.Thisisrelatedtolightweightmethodssuchas[ND05].The4to16colorchannelseachrepresentoneoccludertexture.ThispassisveryfastanddoesnotinterferewithanyCPUorGPUbasedvertexanimation.Furthermoreitiscom-patiblewithanykindofrepresentationthatproducesadepth,suchaspoint-basedrendering,impostors,ray-tracingonGPU.Packingincolorchannelsallowstocomputemipmap-ping,NBuffersorSATforfourslicesinparallel.Thin occluderOpaque occlusion texelLight sourceLight leakFigure4:Orthogonalprojection(left)causesmorelightleaksthanperspectiveone(right).Thecamerausedduringthisrenderingpassisveryim-portantasitcontrolshowthesceneissliced.Itisdisad-vantageoustouseanorthogonalprojection.First,averylargetextureresolutionisrequiredforthecamera’sfrustumtoencompassthescene.Second,theprojectionontoocclu-siontexturesbreakscontinuoussurfacesintopatchesalonglinesnotfollowingthefrustumcenter.Theconsequenceisthatlightcanshinethrough,whereitisactuallyblockedbytherealsurface,causinglightleaks(Fig.4).Withperspec-tiveprojection,theprobabilitytohavelightleaksismuchlower.Figure(4)showsthedifference.Onthisﬁgure,youcanseethatthecenterofprojection(COP)isnotplacedonthelightsource.Thereasonistwofold.First,itwouldre-quirealargeﬁeldofviewtoencompassthescene,increasingtexturedistorsion.Second,duringtheshadowcomputations,thiswouldinvolvekernelsthatarelargeandthatcanjutoutfromtheocclusiontextures(Fig.5).Thiswouldriseinterpo-lationaswellasprecisionissues.OurchoiceistoplacetheCOPslightlybehindthelightsource,atadistanced,andtoﬁtthefrustumtothelightsource,choosingdsothatthefrus-tumcontainsthescene.WewanttoemphasizethatusingaprojectionfromaparticularCOPonlyaffectsonlythewaywe“x-ray”thescenetoapproximateocclusion,nottheareaswhereshadowsarecomputed.Itdoesnotrelatetotheap-proximationofsilhouetteedgesfromthecenterofthelightsourceasinothermethods,nortotherecoveryofadepthmap,whichwouldonlycontaintheﬁrstsurfacesofascene.submittedtoCOMPUTERGRAPHICSForum(7/2010).0
1
0
2

 
l

u
J
 

9

 
-
 

i

 

1
n
o
s
r
e
v
 
,

1
8
2
5
4
3
0
0
-
a
i
r
n

i

E.Eisemann&X.Décoret/OcclusionTexturesforPlausibleSoftShadows5Figure3:Comparisonofmaximum(left),sum(middle)andourcombiningapproach(right).Kernel is almost of the size of the occlusion texture and even juts out on the rightKernel are much smaller and never jut out with our offset projectionkernel size comparedto occlusion texture sizeFigure5:COPwithoffset:FilteringissimplerFigure6:Fixinglightleaksforthinoccluders.Lightleaks.Aswehaveseen,ourchoiceofperspectiveprojectional-readylimitslightleaks,butsomemaystilloccur.Itwillbe-comeparticularlyvisibleinthecaseofthingeometry,suchasabutterﬂywings(Fig.6).Forsuchgeometry,weprojecteachocclusiontextureonitssuccessorfartherawayfromthesourceinorderto“close”thediscontinuities.Notethattheprojectioncanbeperformedvirtually.Duringtheslicecre-ation,whenconvertingdistanceintoacolor,itissufﬁcienttoﬁllthesucceedingchanneltoo.Thisintroducesnoextracosts.Figure6showshowitdrasticallyreducestheleaks.Thismethoddoesprobablynothandleallsituationsbutinpractice,wedidnotencounteranyleaks.Projectingocclusiontexturesinthiswayaffectsthere-sultingshadowsbutonlyslightly.Umbraearealittleover-estimatedandtheshadowgradientslightlydiffers.Conse-SliceOcclusion Texture...would indicate that point P is in shadow!P Using the occlusion texture of the slice containing P...Figure7:Auto-shadowinginsideaslice.quently,onecandecidetoenablethiscorrectionuniquelyforthinobjects,asforothers,lightleakswillbeunlikely.Selfshadowing.Ourmethoddoesnotdistinguishshadowcastersandre-ceivers.Everypointinthesceneisshadowed,usingonlytheoccludertexturesbetweenitandthelightsource.Theocclu-siontexturecorrespondingtotheslicecontainingthepointisnotused,becauseanypointintheslicewouldbeshadowedbyitsownprojectionintheocclusiontexture(Fig.7).Sim-plyignoringthecontainingslicewouldcausediscontinuitieswherethegeometrycrossestheclippingplanes.Instead,welinearlyfadeoutthecontributionofaslicedependingonthedistanceoftheshadedpointtotheslice’slowerclippingplane.Usingslicesforselfocclusionisacoarseapproximation,butitoftenworkswellinpracticeforthefollowingreasons.Foraslicefarawayfromapoint,theocclusiontextureactu-allyprovidesagoodapproximationoftheocclusioncausedbywhatisintheslice.Foraslicenearbyapoint,itistheo-reticallymoreproblematicbutisoftenconcealedbydiffuseillumination.Indeed,forawatertightobject,thefront-facingfacesblocklightfromtheback-facingones.Whentheyfallinthesameslice,thiseffectismissed.However,thedif-fuseilluminationforback-facingfacesiszeroanddominatestheincorrectshadowing.Theyappeardarkastheyshould(Fig.8).Fornon-watertightchaoticobjectsliketrees,thedif-fuseilluminationcontainshighfrequencieswhichhidepo-tentiallyincorrectshadowing.WeinsistthatthisconcernssubmittedtoCOMPUTERGRAPHICSForum(7/2010).0
1
0
2

 
l

u
J
 

9

 
-
 

i

 

1
n
o
s
r
e
v
 
,

1
8
2
5
4
3
0
0
-
a
i
r
n

i

6E.Eisemann&X.Décoret/OcclusionTexturesforPlausibleSoftShadowsonlynearbyslices.Fordistantslices,self-shadowingbe-havescorrectly.Figure8:Ourshadowing(left)maymisscloseself-occlusions.Fortunatelydiffuseilluminationoftencompen-sates(right).3.5.PuttingeverythingtogetherFigure9summarizesthealgorithm.Thesceneisslicedandprojectedontoocclusiontextures,whichinvolvesoneren-deringofthescenefromthelight’spointofview(Sec.3.4).Theseocclusiontexturesarepre-ﬁlteredwithdifferentker-nelsizes(Sec.3.2).Asecondrenderpassisperformedfromtheobserver’spointofview.ForeachpointPofthescene,allslicesbetweenitandthelightsourcearevisited.TheshadowcausedbyeachsliceisdeterminedbyperformingatexturelookupwithaﬁltersizecorrespondingtotheprojectionoflightonthesliceasseenfromP.Theshadowcontributionsarecombinedusingtheformula(5)whichperformsbetterthanthemaximumortheadditiveapproach(Sec.3.3).ThecontributionofthesliceclosesttoPisweightedaccordingtothedistanceofPtotheslice,inordertoobtainsmoothinter-slicevariationoftheshadowintensity.Theresultisthencombinedwithper-pixelPhongshadingandtextures.3.6.ImplementationdetailsConceptually,thealgorithmissimple(seealg.1).Toshadeafragment,weretrievethecorrespondingworldpointW.Then,foreachocclusiontexture,weﬁndthekernelpositionpandsizesimpliedbyWandthelight,deducethesurround-ingNBufferlevelslandl+1,lookupﬁlteredocclusionintheselevels,linearlyinterpolatethevalues,andaccumulatetheocclusion.Theproblemisthatthisapproachisnotim-plementablefortworeasons.First,shaderscurrentlydonotallowdynamicaccessofanarrayoftextures.Line6and7thuscannotbetranslatedtoshaderinstructions.Thesecondproblemisthatcurrently,shaderscanonlyaccessaﬁxedAlgorithm1idealcomputationofvisibilityVforfragmentfandlightL1:V=02:W=world_coordinate(f)3:foriinocclusion_texturesdo4:p,s=kernel_pos_and_level_for(W,L,i)5:l=(cid:7)s(cid:8)6:vlo=lookup(p,nbuffers[l])7:vhi=lookup(p,nbuffers[l+1])8:v=(1−(s−l))vlo+(s−l)vhi9:V=accumulate(v,V)10:endfornumberoftextures,typically16.Ifweuse4occlusiontex-turesof256×256(thusencoding16slicesintheRGBAchannels),weneed8=log2(256)levelsofNBuffers.Evenonasimpleconﬁgurationlikethis,4∗8=24differenttex-turesareused.Wegetaroundthesetwoproblemsbyusingtexturepacking,andsequencingthealgorithminawaythattexturearraysareaccessedstatically.Let’sstartwithpacking.Our16slicesareencodedin4oc-clusiontextures.Insteadofgenerating8NBuffersforeach,wegenerate8texturesandpackintextureitheNBufferleveliforeachocclusiontexture(resultingin8texturesof4×256×256).Wenowuseonly8texturesinsteadof24.Witharesolutionof2048×2048,wewouldonlyneedthreemoreNBufferlevels,thusstillﬁttingthe16textureslimita-tion(andinparticularleaving5texturesusableforconven-tionalshading)..Let’snowseehowwere-orderthealgorithm.Thekeyob-servationisthateachsliceishouldbeﬁlteredwithakernelofsizesi,andthatsiisstrictlyincreasingfromthesliceclos-esttotheshadedpointtothesliceclosesttothelight.Thus,wecanloopovertheNBufferlevelslinorderofincreas-ingkernelsizesl,andincrementacurrentsliceindexi.Thisindexisinitializedwiththesliceclosesttothepointandisincreasedeverytimesi<sl.Becauseofpacking,thisindexisashiftofthehorizontaltexturecoordinateusedtoaccessthecurrentNBufferlevel.Thissecondversion(seealg.2)worksbecausetheloopatline5isastaticone,completelydeterminedbytheresolutionoftheocclusiontextures.Line8requiresacomment.BecauseweencodefourslicesintheRGBAchannelsofeachocclusiontexture,increas-ingthecurrentsliceindexisabitmoretrickythanusingi=i+1.Luckily,thiscanbedoneefﬁcientlyusingtheswiz-zleoperatorofshadinglanguages,andclevertricks.Weuseafloat4forsliceindexandimplementline8and9withi=i.yzwxanddelta+=i.w*packing_offset.Then,inline12and13,whenwedothelookup,wegetbackfourslicesasoneRGBAcolor,andweextracttherelevantonebydoingadotproductwithi.Notethatthisapproachispurelyarithmicandnobranchingisused(alsoconceptu-submittedtoCOMPUTERGRAPHICSForum(7/2010).0
1
0
2

 
l

u
J
 

9

 
-
 

i

 

1
n
o
s
r
e
v
 
,

1
8
2
5
4
3
0
0
-
a
i
r
n

i

E.Eisemann&X.Décoret/OcclusionTexturesforPlausibleSoftShadows7Prefilter occlusion textures -several slices are treated at onceRendering from eye - accumulate shadow contributions (this image uses 4 slices)1243Rendering from light: get occlusion texturesFor each slice between point and ligh,  lookup filtered response in occlusion texture at the needed level Figure9:Summaryofouralgorithm.Algorithm2practicalcomputationofvisibilityVforfrag-mentfandlightL1:V=02:W=world_coordinate(f)3:i=index_slice_closest_to(W)4:p,s=kernel_pos_and_level_for(W,L,i)5:δ=i*packing_offset6:forlinnbuffers_levelsdo7:whiles<kernel_size_for_level(l)do8:i=i+19:δ+=packing_offset10:p,s=kernel_pos_and_level_for(W,L,i)11:endwhile12:vlo=lookup(p+δ,nbuffers[l])13:vhi=lookup(p+δ,nbuffers[l+1])14:v=(1−(s−l))vlo+(s−l)vhi15:V=accumulate(v,V)16:endforally,itamountstotests,andcanalsobeimplementedusingif/thenconstructs).Acoupleofotheroptimizationcanbedone,butarenotpresentedhereforconciseness.Inparticular,packingoffsetandkernelsposition/sizeactuallyonlydependonthedis-tancefromtheshadedpointtotheCOP.Thissimpliﬁesandfactorsseveralcomputations.Deferredshadingisalsousedtoavoiddoingcomputationsonhiddenfragments.Webe-lievethereadercanﬁgureoutthesedetailsbyhimself,andonlyfocusedondescribingtheniftypartofthealgorithm.Adetailedimplementationwillbeavailableonthepaperweb-site.3.7.FutureHardwareExtensionsInDirectX10texturestackswillbeintroduced,thatwouldmakethepresentedwork-aroundunnecessaryandwillim-proveourperformanceevenfurther.OnepossibilitynowadaysistoarrangeNBufferlevelsina3Dtexturemakingthelinearinterpolationautomaticallyavailablewithoutextracost.Currently,eventhoughthefunc-tiontorenderinto3Dtextureslicesisdocumenteditisnotyetimplementedinthedrivers.Havingthisoptionthetex-turepackingwouldalsobecomeunnecessary,makingtheal-gorithmevenmoreefﬁcient.Alsotheamountoftextureunitsisincreasedmakingitpossibletokeepthetexturesseparatewithoutperformingpacking.Currentlyinourimplemena-tion,16slicesimposeamaximalresolutionof20962.Thisisveryacceptable,buttexturestackswillevenliftthisre-strictioncompletely.Asmentionedbeforemorethan16slicescouldbegen-eratedfromthesceneusingtechniquesasin[DCB∗04,ED06a].Redistributingtheslicesintocolorchannelscanbedoneindependentlyofthescenegeometry.Thiswouldalsoallowtodoaﬁrstsceneanalysistobetterﬁtslicestotheobjects.Currentlywesimplyuseauniformdistribution.An-otherinterestingaspectisthefactthat32bittextureswillbecomeavailable.Thusinonecolorchannelseveralocclu-sionlayerscouldbepacked.Thiswouldmakethelookupsmorecachefriendlyandacceleratethealgorithmevenfur-ther.Newhardwarewillbebasedonscalarratherthanvec-torprocessors,whichisperfectforourpurposes,becausethecolorchannelsaretreatedseparatelyinouralgorithmandcolorisnotuseinitsstandardmeaning.4.ResultsanddiscussionOurworkissimilarinspirittothatofKeatingandMax[KM99]buttheﬁeldofapplicationiscompletelydif-ferent.Theirapproachdoesnotaimatrealtimeandtargetsray-tracing.Evenwithoutaveragingseveralrays,itisstillpresentedinaformthatwouldnotallowreal-timeperfor-mance.Itusessmallkernelsmostlytoavoidnoiseandap-pliesitsimilarlytopercentagecloserﬁltering[RSC87].In-stead,weuseconvolutionforaccelerationpurposes.Wepre-sentedseveralsolutionstoapproximateﬁlteringefﬁciently,ratherthanperformingit.Ourmethodthustreatslargelightsourceswithoutpenalty.OcclusiontexturesareefﬁcientlycreatedontheGPUandweavoidanyCPUinteraction.WesubmittedtoCOMPUTERGRAPHICSForum(7/2010).0
1
0
2

 
l

u
J
 

9

 
-
 

i

 

1
n
o
s
r
e
v
 
,

1
8
2
5
4
3
0
0
-
a
i
r
n

i

8E.Eisemann&X.Décoret/OcclusionTexturesforPlausibleSoftShadowscombinecontributionsdifferently,basedonprobability,andobtainconvincingresultswithoutevaluatingseveralsamplerays.Ofcourse,ray-tracingproducesmorerealisticimages.WeimplementedourmethodusingCg1.5shadinglan-guageandOpenGL.Tomakeitpossibletocompareouralgorithmtoothersweusedthesametestsystemasin[AHL∗06](a2,4GhzPentium4withaGeForce6800Ul-tra).Boththerenderpasstoslicethesceneandthecomputa-tionsofNBuffersareveryfast,thustherenderingcostofourmethodisdominatedbytheﬁnalrenderpassandisalmostthesameinallourtests.Mostoftheimagesweshowarelev-elsofgray.Thisistoemphasizetheshadows.Ourmethodworksseamlesslywithtexturesandwouldevenbeneﬁtfromtheirpresence,sincetexturemapswouldmaskminorshad-owingartifacts.Similarly,mostofourexamplesshowcastshadowsonaﬂatgroundtoeasetheperception.Anarbi-trarygroundispossible.Inpracticeitcouldbeadvantageoustoknowthatsomeelementsofthesceneareaﬂooranditcouldbesimplyexcludedfromtheslicingandafterwardstakeallslicesintoaccount.Inpracticewedidnotrelyonaspecialtreatmentandwewanttoemphasizeagainthatthereisnocaster/receiverdistinctioninourmethods.Grazingan-glesonalmostplanargeometrycanleadtoproblems4.1.QualityComparisonOurshadowsareplausibleandsmoothevenforextremelowresolutionofocclusiontextures.Separately,eachsingleoc-clusiontextureispiecewiselinearandhasablockyappear-anceforalowresolution.Combiningnon-alignedtexturesleadstoanartiﬁcialincreaseofresolution.Thiscanbeinter-pretedintermsoffrequencies[DHS∗05].Slicescanbeseenasadecompositionoftheshadowonbasisfunctions.Eachsliceislooked-upwithdistinctﬁltersizeandthusrepresentsaseparatefrequencyrange.Acombinationisawealthofinformation,thatisnotequivalenttoasingletexture.Nev-ertheless,toolowresolutionswouldstillintroduceartifactsduringanimation.Thesmallestentityisapixel,thustheblockingcontributionofveryﬁneobjectscanbeoveresti-matedormissed.Thisisaproblemthatwesharewithallimagebasedmethods.Webelievethattheintroductionofocclusiontexturestoshadowsisveryimportant.Depthmapbasedapproachescansufferfromvisibletemporalincoherencesforlargesourcesinevensimplesituations.Imagineasmalloccluderclosetothelight.Itmightnotevencreateanumbraregion,butallobjects,thatarehiddeninthedepthmapwillnotcastanyshadowatall.Thereforewheneveranobjectpassesoveran-otheronethereisaﬂickeringinthepenumbraregion.Attyetal.[AHL∗06]reliedontwoshadowmapstoovercomethisproblem.Guennebaudetal.[GBP06]donothavethisop-tion,becausetheywouldneedtoseparateoccluderandre-ceiver.Thustheyarerestrictedtosmallsourcesnotonlybyperformancebutalsoqualityissues.Forsmalllightsources,duetoasmalleroverheadthetechniqueispreferable,al-thoughinthiscasepercentagecloserﬁlteringapproachesworkwell.Ourmethodhaslessproblemswithocclusionbe-causewerelyonaslicing.Nevertheless,slicingmightmissnearbyocclusions,thusaslightﬂickeringmaystillappearforverticalmovementsandgrazinganglesasshownintheaccompanyingvideo.Interestinglyalthoughourapproachisbasedonaverycoarseassumption,theresultsareveryconvincing.Wetriedseveralverydifferenttestscenariosandcomparedourtech-niquetoareferencesolutionbasedonsampling.Theﬁrstsceneisshowninﬁgure??.Even4slicesgiveagoodapproximationforthetreesbranches.Realizethattheoverlappingofthebrancheswouldcausesevereproblemsfordepthmapbasedmethods.Thefactthattheshadowsofthebigtreeareveryaccurateonthegroundisnotacoincidence.Infactifyoutakeaplanaroccluderandyoumoveitbyadis-tanceεithasmoreinﬂuenceiftheoccluderwasclosetothereceivingpoint.Basicallythisinﬂuenceisrelativetothedis-tance.Nowinourcasethismovementisaprojection,thatisalmostvertical.whichisevenbetter,becausetheerrorisalsorelativetotheangle.Inotherwords,thefurtherawayobjectsare,themoreaggressivelytheycouldbesimpliﬁed.Thisisdirectlyexploitableinouralgorithmasbyrecoveringthere-sultfromoneNBuffertextureweactuallygettheresponsefor4slicesfoundatthesamedistance.Alsoifthegroundofthesceneisknownonecouldusemoreplanesclosetotheground,lessclosetothelight.Neverthelessinthecur-rentimplementationwedidnotmakeuseofthis.Becausewewanttocaptureselfocclusionandthussupposethatateachheightthereisthesamedensityofgeometry(castingandreceiving).Inthisparticularsceneitwouldhavebeenagoodideatouselessslicesforthetree(inparticularbe-causetheselfocclusionisvisible,butratherrestricted)andtheshadowsonthegroundaremoreimportant.Thesecondsceneisaframefromananimationwithamovinglight.Wedidnotevenrelyonboundingboxesanddidnotplaceallslicesonthebunny(Inparticularyouseethelastslicebeingevenunusable).Wethenstoppedthean-imationatarandompoint.Againdistantshadowsarewellapproximatedwithalittlenumberofslices.Whereasselfshadowingoftheearsislostusing4slices.Thenextsceneshowsthedragoncastingashadowonanunevenground.Stillweremainclosetotheoriginalsolution.Thegroundisnottreatedanydifferentthanthedragoninthisscene,thereisnoseparation.Asusualthehighesterroroccursatdetailedgeometrylevel.Thecomplicatedboxscenefromﬁgure3isinterestingasitshowsthatourprobabilisticcombinationisaverygoodtrade-offbetweenthetwoextremities.Finallyﬁgure3showstheinﬂuenceoftextureresolution.Forbiglightsseveralimagebasedapproachesarguedthatitissufﬁcienttotakelowresolutiontextures.Thisisnotgen-erallytrue.Thetreedetailswouldbemissed,makingthesubmittedtoCOMPUTERGRAPHICSForum(7/2010).0
1
0
2

 
l

u
J
 

9

 
-
 

i

 

1
n
o
s
r
e
v
 
,

1
8
2
5
4
3
0
0
-
a
i
r
n

i

E.Eisemann&X.Décoret/OcclusionTexturesforPlausibleSoftShadows9shadowsﬂickerslightlywhenthetextureresolutionisverylow.Eventhoughthestilllooksappealing.Thequalityishighevenforlowerresolutions,whenzoominginwecanseetheartifactsfromsamplingwithalmost1000samples.Thelightsourceishuge(thesizeofthewholescene)andthebranchesaddanalmostrandomnoise,whereasourap-proachsmoothestheseartifactsoutduetotheﬁltering.4.2.TimingsInthissectionwecomparethespeedofouralgorithmwiththecurrentstate-of-the-artsolutionsbyAssarsonetal.[ADMAM03]andAttyetal.[AHL∗06].Weusedthejeepscenefrom[AHL∗06]withavaryingnumberofjeeps.Itisobviousthatgeometrybasedalgo-rithmsarequicklyoutperformedbyimagebasedtechniques.Softshadowvolumesdonotscaletoausableamountofge-ometry.Atty’salgorithmbehaveslinear,justlikeours,butthefactthatlotsoffragmentshavetobeprojectedonthesource,justlikeinGuennebaud’sapproach,thealgorithmslowsdownrapidlywiththenumberofoccludingfragments.Wedonothavetoreproject,becausethiscalculationisal-readyinherentintheﬁltering,oursolutiondependssolelyonarenderstepofthegeometrynotthesceneconﬁguration.Wewanttounderlinethatwecomparedwithoursolutionusing16slicesandamorethanfourtimeshighertextureres-olution,eventhough4slicesand1282wouldalreadyhavegivenasatisfactoryresult.Notonlycanwedealwithbigtexturesizes,wealsooutperformthecurrentstate-of-the-artimagebasedsoft-shadowalgorithmthatevenbeneﬁtsfromanoccluder/receiverseparationandcannottreatselfshad-owing.Finallyﬁgure??depictsamorechallengingscene,andourresultingframerate.Eachbunnyhasapproximately70.000polygons,thusleadingtoaﬁnalcomplexityofalmost500.000polygonsandwestillhaveareal-timeperformance.5.ConclusionandFutureWorkWepresentedanovelimage-basedsoftshadowalgorithm,thatisfastandespeciallywell-adaptedtoGPU.Itdoesnotrelyonprecalculationandintegratessmoothlywithanimatedscenes.Theresultingshadowsareplausibleal-thoughnotphysicallycorrect.Inparticular,innerandouterpenumbraearehandled.Althoughthemethodisimagebased,shadowsaresmooth,evenatlowtextureresolution.Someartifactscanoccur,duetothelimitednumberofslices/resolutionandapproximatedﬁltering;self-occlusionmightfaillocallyandaslightﬂickeringcanoccurforverti-calmovementsastheweightingfortheclosestslicechanges.However,thecomplextaskofinter-objectshadingisseam-lesslyhandled,throughtheintroductionofanovelwayofcombiningshadowcontributionsbasedonprobabilities.Nodistinctionbetweencastersandreceiversisrequired.Themethodisoutputsensitivedependingonlyontheamountofshadedpointsratherthanonthenatureorsizeoftheshadow.Toourbestknowledge,itistheonlyapproachthatpossessesalltheseproperties.Itoutperformscurrentstate-of-theartalgorithmsanddeliversveryconvincingshadowsrelativelyclosetothegroundtruth.Animportantareaoffutureinvestigationconcernsthesliceplacement.Litmapsintroducedin[D´05],orCCShadowvolumes[LWGM04]couldservetodeterminethereceiversinascene,thuswecanbasedonthisinformationplacelessslicesintheremainingpartbasedonthemen-tionederrormeasure.Itispossibletocreateperobjectrep-resentations,relatingtotheideathattheslicesshouldevolveina“continuous”waywithobjectsandviewpoint.Finally,hierarchicalbranchingcouldbeinteresting,asonelookupgivesusinformationaboutfourslices.Onourtesthardware,itiscurrentlynotadvantageous,showingthatshaderoptimizationbecomesdifﬁcult.Acknowledgements:Wethankthereviewersfortheircommentsandremarks.SpecialthanksgotoS.Lefebvreforhissuggestionsandveryearlyinput.WealsothankespeciallyC.SolerandH.deAlmeidaBezerraforseveraldiscussions.WewanttothankU.As-sarson,L.Atty,N.Holzschuch,M.Lapierre,J.-M.Hasenfratz,C.HansenandF.Sillionforthecomparisonwithouralgorithm.Stan-ford,DeEsponaforthemodels.References[AAM02]ASSARSONU.,AKENINE-MÖLLERT.:Ap-proximatesoftshadowsonarbitrarysurfacesusingpenumbrawedges.InProc.ofWorkshoponRendering’02(2002),SpringerComputerScience,Eurographics,Euro-graphics.1,2,4[AAM03]ASSARSONU.,AKENINE-MÖLLERT.:Ageometry-basedsoftshadowvolumealgorithmusinggraphicshardware.InProc.ofSiggraph’03(2003).1,2,4[ADMAM03]ASSARSONU.,DOUGHERTYM.,MOUNIERM.,AKENINE-MÖLLERT.:Anopti-mizedsoftshadowvolumealgorithmwithreal-timeperformance.InProc.ofWorkshoponGraphicsHardware’03(2003).1,2,4,9[AHL∗06]ATTYL.,HOLZSCHUCHN.,LAPIERREM.,HASENFRATZJ.-M.,HANSENC.,SILLIONF.:Softshadowmaps:Efﬁcientsamplingoflightsourcevisibil-ity.ComputerGraphicsForum(2006).2,8,9[AHT04]ARVOJ.,HIKORPIM.,TYYSTJÄRVIJ.:Ap-proximatesoftshadowswithanimag-spaceﬂood-ﬁll-algorithm.InProc.ofEurographics’04(2004).2,4[ARHM00]AGRAWALAM.,RAMAMOORTHIR.,HEIRICHA.,MOLLL.:Efﬁcientimage-basedmethodsforrenderingsoftshadows.InProc.ofSiggraph’00(2000).2submittedtoCOMPUTERGRAPHICSForum(7/2010).0
1
0
2

 
l

u
J
 

9

 
-
 

i

 

1
n
o
s
r
e
v
 
,

1
8
2
5
4
3
0
0
-
a
i
r
n

i

10E.Eisemann&X.Décoret/OcclusionTexturesforPlausibleSoftShadows[ASK06]ASZODIB.,SZIRMAY-KALOSL.:Real-timesoftshadowswithshadowaccumulation.InShortPaperEurographics(2006).2[BS01]BRABECS.,SEIDELH.P.:Hardware-acceleratedrenderingofantialiasedshadowswithshadowmaps.InProceedingsofCGI’01(2001).1[BS02]BRABECS.,SEIDELH.:Singlesamplesoftshad-owsusingdepthmaps.InProc.ofGraphicsInterface’02(2002).2[BS06]BAVOILL.,SILVAC.T.:Real-timesoftshad-owswithconeculling.InTechnicalSketchatSIGGRAPH(2006).2[CD03]CHANE.,DURANDF.:Renderingfakesoftshad-owswithsmoothies.InProc.ofSymposiumonRender-ing’03(2003).2[Cro77]CROWF.:Shadowalgorithmsforcomputergraphics.incomputergraphics.InProc.ofSiggraph’77(1977).1[Cro84]CROWF.C.:Summed-areatablesfortexturemapping.InProc.ofSiggraph’84(1984).3[D´05]DÉCORETX.:N-buffersforefﬁcientdepthmapquery.InProc.ofEurographics’05(2005).3,9[DCB∗04]DONGZ.,CHENW.,BAOH.,ZHANGH.,PENGQ.:Real-timevoxelizationforcomplexpolygo-nalmodels.InProc.ofPaciﬁcGraphics’04(2004).4,7[DHS∗05]DURANDF.,HOLZSCHUCHN.,SOLERC.,CHANE.,SILLIONF.:Afrequencyanalysisoflighttransport.ACMTransactionsonGraphics(ProceedingsofSIGGRAPH2005)24,3(aug2005).8[DL06]DONNELLYW.,LAURITZENA.:Varianceshadowmaps.InProc.ofI3D’06(2006).1[ED06a]EISEMANNE.,DÉCORETX.:Fastscenevox-elizationandapplications.InProc.ofI3D’06(2006).4,7[ED06b]EISEMANNE.,DÉCORETX.:Plausibleimagebasedsoftshadowsusingocclusiontextures.InProceed-ingsofSIBGRAPI2006(Oct.2006),pp.155–162.1[ED07]EISEMANNE.,DÉCORETX.:VisibilitysamplingonGPUandapplications.ComputerGraphicsForum(ProceedingsofEurographics2007)26,3(Sept.2007),535–544.2[GBP06]GUENNEBAUDG.,BARTHEL.,PAULINM.:Real-timesoftshadowmappingbybackprojection.InEu-rographicsSymposiumonRendering(2006).2,8[HLHS03]HASENFRATZJ.-M.,LAPIERREM.,HOLZSCHUCHN.,SILLIONF.:Asurveyofreal-timesoftshadowsalgorithms.ComputerGraphicsForum22,4(Dec.2003).1[HSC∗05]HENSLEYJ.,SCHEUERMANNT.,COOMBEG.,LASTRAA.,SINGHM.:Fastsummed-areatablegen-erationanditsapplications.InProc.ofEurographics’05(2005).3[KD03]KIRSCHF.,DOELLNERJ.:Real-timesoftshad-owsusingasinglelightsample.JournalofWSCG(2003).2[KM99]KEATINGB.,MAXN.:Shadowpenumbrasforcomplexobjectsbydepth-dependentﬁlteringofmulti-layerdepthimages.InProc.ofWorkshoponRender-ing’99(1999).1,2,7[LWGM04]LLOYDB.,WENDTJ.,GOVINDARAJUN.K.,MANOCHAD.:Ccshadowvolumes.InProc.ofEGSymposiumonRendering’04(2004),SpringerCom-puterScience,Eurographics,EurographicsAssociation.9[ND05]NGUYENH.,DONNELLYW.:HairAnimationandRenderingintheNaluDemo.AddisonWesley,2005.4[PSS98]PARKERS.,SHIRLEYP.,SMITSB.:Singlesam-plesoftshadows.Tech.Rep.UUCS-98-019,UniversityofUtah,1998.2[RSC87]REEVESW.T.,SALESIND.H.,COOKR.L.:Renderingantialiasedshadowswithdepthmaps.InProc.ofSiggraph’87(1987).1,8[SAPP05]ST-AMOURJ.-F.,PAQUETTEE.,POULINP.:Softshadowsfromextendedlightsourceswithpenum-bradeepshadowmaps.InProc.ofGraphicsInterface’05(2005).2[SS98]SOLERC.,SILLIONF.:Fastcalculationofsoftshadowtexturesusingconvolution.InProc.ofSiggraph’98(1998).1,3,4[SS07]SCHWARZM.,STAMMINGERM.:Bitmasksoftshadows.ComputerGraphicsForum(ProceedingsofEu-rographics2007)26,3(Sept.2007),515–524.2[Ura05]URALSKYY.:Efﬁcientsoft-edgedshadowsusingpixelshaderbranching.InGPUGems2(2005),AddisonWesley.1,2[WH03]WYMANC.,HANSENC.:Penumbramaps:Ap-proximatesoftshadowsinreal-time.InProc.ofSympo-siumonRendering’03(2003).2[Wil78]WILLIAMSL.:Castingcurvedshadowsoncurvedsurfaces.InProc.ofSiggraph’78(1978).1[Wil83]WILLIAMSL.:Pyramidalparametrics.InProc.ofSiggraph’83(1983).3[WPF90]WOOA.,POULINP.,FOURNIERA.:Asurveyofshadowalgorithms.IEEEComput.Graph.Appl.10,6(1990).1[ZHL∗05]ZHOUK.,HUY.,LINS.,GUOB.,SHUMH.-Y.:Precomputedshadowﬁeldsfordynamicscenes.InProc.ofSiggraph’05(2005).2submittedtoCOMPUTERGRAPHICSForum(7/2010).